<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LernTrainer ‚Äì Interaktiv lernen f√ºr Klasse 7-10</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #1a365d;
            --primary-light: #2c5282;
            --secondary: #2b6cb0;
            --accent: #ed8936;
            --success: #38a169;
            --error: #e53e3e;
            --warning: #d69e2e;
            --bg: #f7fafc;
            --card: #ffffff;
            --text: #2d3748;
            --text-light: #718096;
            --border: #e2e8f0;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Outfit', sans-serif;
            background: var(--bg);
            min-height: 100vh;
            color: var(--text);
        }

        /* ==================== LOGIN SCREEN ==================== */
        .login-screen {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            padding: 20px;
        }

        .login-box {
            background: white;
            border-radius: 24px;
            padding: 50px 40px;
            max-width: 420px;
            width: 100%;
            box-shadow: 0 25px 50px rgba(0,0,0,0.25);
            text-align: center;
        }

        .login-logo { font-size: 4rem; margin-bottom: 10px; }
        .login-title { font-size: 2rem; font-weight: 700; color: var(--primary); margin-bottom: 8px; }
        .login-subtitle { color: var(--text-light); margin-bottom: 30px; font-size: 1.05rem; }

        .login-input {
            width: 100%;
            padding: 16px 20px;
            font-size: 1.1rem;
            font-family: inherit;
            border: 3px solid var(--border);
            border-radius: 12px;
            margin-bottom: 20px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .login-input:focus {
            outline: none;
            border-color: var(--secondary);
            box-shadow: 0 0 0 4px rgba(43, 108, 176, 0.15);
        }

        .login-input.error {
            border-color: var(--error);
            animation: shake 0.5s ease;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .login-btn {
            width: 100%;
            padding: 16px;
            font-size: 1.1rem;
            font-weight: 600;
            font-family: inherit;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(26, 54, 93, 0.3);
        }

        .login-error { color: var(--error); font-size: 0.9rem; margin-top: 15px; display: none; }
        .login-error.show { display: block; }
        .login-hint { margin-top: 25px; padding-top: 20px; border-top: 1px solid var(--border); color: var(--text-light); font-size: 0.85rem; }

        /* ==================== MAIN APP ==================== */
        .app-container { display: none; max-width: 1100px; margin: 0 auto; padding: 20px; }
        .app-container.show { display: block; }

        .app-header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            border-radius: 20px;
            padding: 25px 30px;
            margin-bottom: 25px;
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .app-header-left { display: flex; align-items: center; gap: 15px; }
        .app-header-logo { font-size: 2.5rem; }
        .app-header h1 { font-size: 1.6rem; font-weight: 700; }
        .app-header p { opacity: 0.9; font-size: 0.95rem; }

        .logout-btn {
            background: rgba(255,255,255,0.2);
            border: 2px solid rgba(255,255,255,0.5);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-family: inherit;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .logout-btn:hover { background: rgba(255,255,255,0.3); }

        /* Progress */
        .progress-section {
            background: var(--card);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.06);
        }

        .progress-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
        .progress-title { font-weight: 600; color: var(--primary); }
        .progress-stats { font-size: 0.9rem; color: var(--text-light); }
        .progress-bar { height: 12px; background: var(--border); border-radius: 6px; overflow: hidden; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, var(--success), #48bb78); border-radius: 6px; transition: width 0.5s ease; }

        /* Selection */
        .selection-section {
            background: var(--card);
            border-radius: 16px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.06);
        }

        .selection-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .selection-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 12px;
        }

        .selection-btn {
            padding: 20px 15px;
            border: 3px solid var(--border);
            background: white;
            border-radius: 12px;
            cursor: pointer;
            font-family: inherit;
            transition: all 0.3s ease;
            text-align: center;
        }

        .selection-btn:hover:not(.disabled) {
            border-color: var(--secondary);
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.1);
        }

        .selection-btn.active {
            border-color: var(--primary);
            background: linear-gradient(135deg, #ebf8ff, #e6fffa);
        }

        .selection-btn .icon { font-size: 2rem; margin-bottom: 8px; display: block; }
        .selection-btn .label { font-weight: 600; color: var(--text); font-size: 0.95rem; }

        /* Topic Cards */
        .topic-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 15px;
        }

        .topic-card {
            padding: 20px;
            border: 3px solid var(--border);
            background: white;
            border-radius: 12px;
            cursor: pointer;
            font-family: inherit;
            transition: all 0.3s ease;
            text-align: left;
            position: relative;
            overflow: hidden;
        }

        .topic-card:hover:not(.disabled):not(.coming-soon) {
            border-color: var(--secondary);
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.1);
        }

        .topic-card.coming-soon { opacity: 0.6; cursor: not-allowed; }

        .topic-card.coming-soon::after {
            content: "Bald verf√ºgbar";
            position: absolute;
            top: 10px;
            right: -30px;
            background: var(--warning);
            color: white;
            font-size: 0.7rem;
            font-weight: 600;
            padding: 4px 35px;
            transform: rotate(45deg);
        }

        .topic-card .topic-icon { font-size: 1.5rem; margin-bottom: 10px; }
        .topic-card .topic-name { font-weight: 600; color: var(--primary); font-size: 1.05rem; margin-bottom: 5px; }
        .topic-card .topic-desc { font-size: 0.85rem; color: var(--text-light); line-height: 1.4; }
        .topic-card .topic-meta { display: flex; gap: 10px; margin-top: 12px; flex-wrap: wrap; }

        .topic-tag { font-size: 0.75rem; padding: 4px 10px; border-radius: 15px; font-weight: 600; }
        .topic-tag.questions { background: #ebf8ff; color: var(--secondary); }
        .topic-tag.audio { background: #f0fff4; color: var(--success); }
        .topic-tag.completed { background: #c6f6d5; color: #276749; }

        /* Breadcrumb */
        .breadcrumb { display: flex; align-items: center; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; }

        .breadcrumb-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: var(--card);
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 500;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }

        .breadcrumb-item.clickable { cursor: pointer; transition: all 0.3s ease; }
        .breadcrumb-item.clickable:hover { background: var(--border); }
        .breadcrumb-arrow { color: var(--text-light); }

        /* AI Quiz Generator Section */
        .generator-section {
            background: linear-gradient(135deg, #ebf8ff, #f0fff4);
            border: 2px solid var(--secondary);
            border-radius: 16px;
            padding: 25px;
            margin-bottom: 20px;
        }

        .generator-section h3 {
            color: var(--primary);
            margin-bottom: 8px;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .generator-section .subtitle {
            color: var(--text-light);
            font-size: 0.9rem;
            margin-bottom: 20px;
        }

        .api-key-section {
            background: white;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            border: 1px solid var(--border);
        }

        .api-key-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .api-key-label { font-weight: 600; font-size: 0.9rem; color: var(--primary); }
        .api-key-status { font-size: 0.8rem; padding: 4px 10px; border-radius: 12px; }
        .api-key-status.connected { background: #c6f6d5; color: #276749; }
        .api-key-status.missing { background: #fed7d7; color: #c53030; }

        .api-key-input-row { display: flex; gap: 10px; }

        .api-key-input {
            flex: 1;
            padding: 10px 14px;
            font-family: 'Space Mono', monospace;
            font-size: 0.85rem;
            border: 2px solid var(--border);
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .api-key-input:focus { outline: none; border-color: var(--secondary); }

        .api-key-btn {
            padding: 10px 16px;
            background: var(--secondary);
            color: white;
            border: none;
            border-radius: 8px;
            font-family: inherit;
            font-weight: 600;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .api-key-btn:hover { background: var(--primary); }
        .api-key-btn.danger { background: var(--error); }

        .api-key-help {
            font-size: 0.8rem;
            color: var(--text-light);
            margin-top: 10px;
            line-height: 1.5;
        }

        .api-key-help a { color: var(--secondary); }

        .generator-form { margin-top: 15px; }

        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; font-weight: 600; margin-bottom: 6px; font-size: 0.9rem; color: var(--primary); }

        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }

        .form-select, .form-input {
            width: 100%;
            padding: 12px 14px;
            font-family: inherit;
            font-size: 0.95rem;
            border: 2px solid var(--border);
            border-radius: 10px;
            background: white;
            transition: all 0.3s ease;
        }

        .form-select:focus, .form-input:focus { outline: none; border-color: var(--secondary); }

        .form-textarea {
            width: 100%;
            min-height: 150px;
            padding: 14px;
            font-family: inherit;
            font-size: 0.95rem;
            border: 2px solid var(--border);
            border-radius: 10px;
            resize: vertical;
            transition: all 0.3s ease;
        }

        .form-textarea:focus { outline: none; border-color: var(--secondary); }
        .form-textarea::placeholder { color: var(--text-light); }

        .char-count { font-size: 0.8rem; color: var(--text-light); text-align: right; margin-top: 5px; }

        .generate-btn {
            width: 100%;
            padding: 16px;
            font-size: 1.1rem;
            font-weight: 600;
            font-family: inherit;
            background: linear-gradient(135deg, var(--success), #2f855a);
            color: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .generate-btn:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(56, 161, 105, 0.3); }
        .generate-btn:disabled { opacity: 0.6; cursor: not-allowed; }
        .generate-btn.loading { animation: pulse 1.5s infinite; }

        .generator-status {
            margin-top: 15px;
            padding: 15px;
            border-radius: 10px;
            display: none;
        }

        .generator-status.show { display: block; }
        .generator-status.loading { background: #ebf8ff; border: 1px solid var(--secondary); }
        .generator-status.success { background: #f0fff4; border: 1px solid var(--success); }
        .generator-status.error { background: #fff5f5; border: 1px solid var(--error); }

        .status-header { display: flex; align-items: center; gap: 10px; font-weight: 600; margin-bottom: 8px; }
        .status-text { font-size: 0.9rem; line-height: 1.5; }

        .loading-spinner {
            width: 20px;
            height: 20px;
            border: 3px solid var(--border);
            border-top-color: var(--secondary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin { to { transform: rotate(360deg); } }

        .generated-preview {
            margin-top: 15px;
            background: white;
            border-radius: 12px;
            padding: 15px;
            border: 1px solid var(--border);
            max-height: 300px;
            overflow-y: auto;
        }

        .generated-preview h4 { color: var(--primary); margin-bottom: 10px; font-size: 0.95rem; }

        .preview-question {
            background: var(--bg);
            padding: 10px 12px;
            border-radius: 8px;
            margin-bottom: 8px;
            font-size: 0.85rem;
        }

        .preview-question .q-type {
            display: inline-block;
            background: var(--secondary);
            color: white;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.7rem;
            font-weight: 600;
            margin-right: 8px;
        }

        .save-module-btn {
            margin-top: 15px;
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            border-radius: 10px;
            font-family: inherit;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .save-module-btn:hover { transform: translateY(-2px); }

        /* Quiz Container */
        .quiz-container {
            background: var(--card);
            border-radius: 16px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.06);
            display: none;
        }

        .quiz-container.show { display: block; }

        .back-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            background: var(--card);
            border: 2px solid var(--border);
            border-radius: 25px;
            font-family: inherit;
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text);
            cursor: pointer;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        .back-btn:hover { border-color: var(--secondary); color: var(--secondary); }

        /* Quiz Stats */
        .quiz-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }

        .quiz-stat {
            background: var(--bg);
            border-radius: 10px;
            padding: 12px;
            text-align: center;
        }

        .quiz-stat-value { font-size: 1.4rem; font-weight: 700; font-family: 'Space Mono', monospace; }
        .quiz-stat-label { font-size: 0.75rem; color: var(--text-light); }
        .quiz-stat.correct .quiz-stat-value { color: var(--success); }
        .quiz-stat.wrong .quiz-stat-value { color: var(--error); }
        .quiz-stat.percent .quiz-stat-value { color: var(--accent); }

        /* Audio Toggle */
        .mode-toggle {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: linear-gradient(135deg, #ebf8ff, #e6fffa);
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .mode-toggle-label { font-weight: 600; color: var(--primary); }

        .toggle-switch {
            position: relative;
            width: 60px;
            height: 32px;
            background: var(--border);
            border-radius: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .toggle-switch.active { background: var(--success); }

        .toggle-switch::after {
            content: "";
            position: absolute;
            top: 4px;
            left: 4px;
            width: 24px;
            height: 24px;
            background: white;
            border-radius: 50%;
            transition: all 0.3s ease;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .toggle-switch.active::after { left: 32px; }
        .mode-toggle-desc { font-size: 0.85rem; color: var(--text-light); }

        /* Question Area */
        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .question-type-badge {
            background: linear-gradient(135deg, var(--secondary), var(--primary));
            color: white;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .question-tense-badge {
            background: var(--accent);
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .question-number { font-family: 'Space Mono', monospace; color: var(--text-light); font-size: 0.85rem; }
        .question-text { font-size: 1.1rem; line-height: 1.6; margin-bottom: 20px; }

        .sentence-box {
            font-family: 'Space Mono', monospace;
            background: linear-gradient(135deg, #edf2f7, #e2e8f0);
            padding: 18px;
            border-radius: 12px;
            margin: 15px 0;
            font-size: 1rem;
            line-height: 1.8;
            border-left: 4px solid var(--secondary);
        }

        /* Audio Controls */
        .audio-controls { display: flex; gap: 12px; margin-bottom: 20px; flex-wrap: wrap; }

        .audio-btn {
            padding: 12px 20px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-family: inherit;
            font-size: 0.95rem;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .audio-btn.speak { background: linear-gradient(135deg, #4299e1, #3182ce); color: white; }
        .audio-btn.listen { background: linear-gradient(135deg, var(--success), #2f855a); color: white; }
        .audio-btn:hover { transform: scale(1.05); }
        .audio-btn.speaking, .audio-btn.listening { animation: pulse 1s infinite; }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* Voice Visualizer */
        .voice-visualizer {
            display: none;
            align-items: center;
            justify-content: center;
            gap: 4px;
            padding: 20px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .voice-visualizer.active { display: flex; }

        .voice-bar {
            width: 6px;
            height: 30px;
            background: white;
            border-radius: 3px;
            animation: voiceBar 0.5s ease-in-out infinite;
        }

        .voice-bar:nth-child(1) { animation-delay: 0s; }
        .voice-bar:nth-child(2) { animation-delay: 0.1s; }
        .voice-bar:nth-child(3) { animation-delay: 0.2s; }
        .voice-bar:nth-child(4) { animation-delay: 0.3s; }
        .voice-bar:nth-child(5) { animation-delay: 0.4s; }

        @keyframes voiceBar {
            0%, 100% { height: 10px; opacity: 0.5; }
            50% { height: 40px; opacity: 1; }
        }

        .voice-status { color: white; font-weight: 600; margin-left: 15px; }

        .recognized-text {
            background: #ebf8ff;
            border: 2px solid var(--secondary);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            font-family: 'Space Mono', monospace;
            min-height: 50px;
            display: none;
        }

        .recognized-text.show { display: block; }
        .recognized-text .label { font-size: 0.8rem; color: var(--text-light); margin-bottom: 5px; font-family: 'Outfit', sans-serif; }

        /* Answer Input */
        .answer-input {
            width: 100%;
            padding: 16px 18px;
            font-size: 1rem;
            font-family: 'Space Mono', monospace;
            border: 3px solid var(--border);
            border-radius: 12px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
            background: var(--bg);
        }

        .answer-input:focus {
            outline: none;
            border-color: var(--secondary);
            background: white;
            box-shadow: 0 0 0 4px rgba(43, 108, 176, 0.15);
        }

        .answer-input.correct { border-color: var(--success); background: #f0fff4; }
        .answer-input.incorrect { border-color: var(--error); background: #fff5f5; }

        /* Options */
        .options-grid { display: grid; gap: 10px; margin-bottom: 15px; }

        .option-btn {
            padding: 15px 18px;
            border: 3px solid var(--border);
            background: var(--bg);
            border-radius: 12px;
            cursor: pointer;
            font-family: inherit;
            font-size: 1rem;
            text-align: left;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .option-btn:hover:not(.disabled) {
            border-color: var(--secondary);
            background: white;
            transform: translateX(5px);
        }

        .option-btn.selected { border-color: var(--primary); background: #ebf8ff; }
        .option-btn.correct { border-color: var(--success); background: #f0fff4; }
        .option-btn.incorrect { border-color: var(--error); background: #fff5f5; }
        .option-btn.disabled { cursor: default; }

        .option-letter {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.85rem;
            flex-shrink: 0;
        }

        /* Buttons */
        .btn-row { display: flex; gap: 12px; flex-wrap: wrap; }

        .btn {
            padding: 14px 28px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-family: inherit;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(26, 54, 93, 0.3);
        }

        .btn-secondary { background: var(--border); color: var(--text); }
        .btn-secondary:hover { background: #cbd5e0; }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; }

        /* Feedback */
        .feedback { padding: 18px; border-radius: 12px; margin-top: 15px; display: none; }
        .feedback.show { display: block; animation: slideIn 0.4s ease; }
        .feedback.correct { background: linear-gradient(135deg, #c6f6d5, #9ae6b4); border-left: 5px solid var(--success); }
        .feedback.incorrect { background: linear-gradient(135deg, #fed7d7, #feb2b2); border-left: 5px solid var(--error); }
        .feedback-title { font-weight: 700; font-size: 1.05rem; margin-bottom: 8px; }
        .feedback-text { line-height: 1.6; }
        .correct-answer { font-family: 'Space Mono', monospace; background: rgba(255,255,255,0.8); padding: 4px 10px; border-radius: 6px; font-weight: 600; }

        /* Result */
        .result-screen { text-align: center; padding: 40px 20px; display: none; }
        .result-screen.show { display: block; }
        .result-emoji { font-size: 70px; margin-bottom: 15px; }
        .result-title { font-size: 1.8rem; color: var(--primary); margin-bottom: 12px; }
        .result-score { font-size: 2.8rem; font-weight: 700; color: var(--success); font-family: 'Space Mono', monospace; }
        .result-text { color: var(--text-light); margin-bottom: 25px; }

        /* Theory */
        .theory-toggle {
            background: none;
            border: 2px solid var(--secondary);
            color: var(--secondary);
            padding: 10px 18px;
            border-radius: 25px;
            cursor: pointer;
            font-family: inherit;
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }

        .theory-toggle:hover { background: var(--secondary); color: white; }

        .theory-section {
            background: var(--bg);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            display: none;
            max-height: 400px;
            overflow-y: auto;
        }

        .theory-section.show { display: block; }
        .theory-section h3 { color: var(--primary); margin-bottom: 12px; }
        .theory-section h4 { color: var(--secondary); margin: 15px 0 8px; }

        .theory-section table { width: 100%; border-collapse: collapse; margin: 12px 0; font-size: 0.9rem; }
        .theory-section th, .theory-section td { padding: 10px; border: 1px solid var(--border); text-align: left; }
        .theory-section th { background: var(--primary); color: white; }
        .theory-section code { background: #edf2f7; padding: 2px 6px; border-radius: 4px; font-family: 'Space Mono', monospace; }
        .rule-box { background: #ebf8ff; border: 2px solid var(--secondary); padding: 12px; border-radius: 8px; margin: 12px 0; }
        .example-box { background: #fffbeb; border-left: 4px solid var(--accent); padding: 12px; margin: 12px 0; border-radius: 0 8px 8px 0; }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .app-header { flex-direction: column; text-align: center; }
            .app-header-left { flex-direction: column; }
            .selection-grid { grid-template-columns: repeat(2, 1fr); }
            .quiz-stats { grid-template-columns: repeat(2, 1fr); }
        }

        @media (max-width: 480px) {
            .login-box { padding: 30px 20px; }
            .selection-grid { grid-template-columns: 1fr 1fr; }
            .topic-grid { grid-template-columns: 1fr; }
            .btn { width: 100%; justify-content: center; }
            .audio-btn { flex: 1; justify-content: center; }
        }
    </style>
</head>
<body>
    <!-- LOGIN -->
    <div class="login-screen" id="loginScreen">
        <div class="login-box">
            <div class="login-logo">üéì</div>
            <h1 class="login-title">LernTrainer</h1>
            <p class="login-subtitle">Interaktiv lernen f√ºr Klasse 7-10</p>
            <input type="password" class="login-input" id="passwordInput" placeholder="Passwort eingeben" autocomplete="off">
            <button class="login-btn" id="loginBtn">üîì Anmelden</button>
            <p class="login-error" id="loginError">‚ùå Falsches Passwort.</p>
            <p class="login-hint">üí° Das Passwort erh√§ltst du von deiner Lehrkraft.</p>
        </div>
    </div>

    <!-- APP -->
    <div class="app-container" id="appContainer">
        <header class="app-header">
            <div class="app-header-left">
                <span class="app-header-logo">üéì</span>
                <div>
                    <h1>LernTrainer</h1>
                    <p>Willkommen zur√ºck!</p>
                </div>
            </div>
            <button class="logout-btn" id="logoutBtn">üö™ Abmelden</button>
        </header>

        <div class="progress-section" id="progressSection">
            <div class="progress-header">
                <span class="progress-title">üìä Dein Gesamtfortschritt</span>
                <span class="progress-stats" id="progressStats">0 Module abgeschlossen</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 0%"></div>
            </div>
        </div>

        <div class="breadcrumb" id="breadcrumb"></div>

        <!-- Grade Selection -->
        <div class="selection-section" id="gradeSelection">
            <h2 class="selection-title">üìö W√§hle deine Klassenstufe</h2>
            <div class="selection-grid" id="gradeGrid"></div>
        </div>

        <!-- Subject Selection -->
        <div class="selection-section" id="subjectSelection" style="display: none;">
            <h2 class="selection-title">üìñ W√§hle ein Fach</h2>
            <div class="selection-grid" id="subjectGrid"></div>
        </div>

        <!-- Topic Selection -->
        <div class="selection-section" id="topicSelection" style="display: none;">
            <h2 class="selection-title">üéØ W√§hle ein Thema</h2>
            <div class="topic-grid" id="topicGrid"></div>
        </div>

        <!-- Upload Section -->
        <!-- AI Quiz Generator -->
        <div class="generator-section" id="generatorSection" style="display: none;">
            <h3>ü§ñ KI-Modul-Generator</h3>
            <p class="subtitle">Erstelle automatisch √úbungsaufgaben aus deinem Lernmaterial</p>
            
            <div class="api-key-section">
                <div class="api-key-header">
                    <span class="api-key-label">üîë Anthropic API-Key</span>
                    <span class="api-key-status missing" id="apiKeyStatus">Nicht verbunden</span>
                </div>
                <div class="api-key-input-row" id="apiKeyInputRow">
                    <input type="password" class="api-key-input" id="apiKeyInput" placeholder="sk-ant-api...">
                    <button class="api-key-btn" id="saveApiKeyBtn">Speichern</button>
                </div>
                <div class="api-key-input-row" id="apiKeyConnectedRow" style="display: none;">
                    <input type="text" class="api-key-input" value="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" disabled>
                    <button class="api-key-btn danger" id="removeApiKeyBtn">Entfernen</button>
                </div>
                <div class="api-key-help">
                    üí° Hole dir deinen API-Key unter <a href="https://console.anthropic.com/settings/keys" target="_blank">console.anthropic.com</a><br>
                    Der Key wird nur lokal in deinem Browser gespeichert.
                </div>
            </div>

            <div class="generator-form" id="generatorForm">
                <div class="form-row">
                    <div class="form-group">
                        <label>üìö Fach</label>
                        <select class="form-select" id="genSubject">
                            <option value="englisch">Englisch</option>
                            <option value="deutsch">Deutsch</option>
                            <option value="mathe">Mathematik</option>
                            <option value="franzoesisch">Franz√∂sisch</option>
                            <option value="geschichte">Geschichte</option>
                            <option value="biologie">Biologie</option>
                            <option value="physik">Physik</option>
                            <option value="chemie">Chemie</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>üéì Klassenstufe</label>
                        <select class="form-select" id="genGrade">
                            <option value="7">Klasse 7</option>
                            <option value="8">Klasse 8</option>
                            <option value="9">Klasse 9</option>
                            <option value="10">Klasse 10</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>üìù Thema / Modultitel</label>
                    <input type="text" class="form-input" id="genTitle" placeholder="z.B. 'If-Clauses Type 2' oder 'Fotosynthese'">
                </div>

                <div class="form-group">
                    <label>üìÑ Lernmaterial (Text, Notizen, Lehrbuchauszug)</label>
                    <textarea class="form-textarea" id="genMaterial" placeholder="F√ºge hier dein Lernmaterial ein. Je mehr Kontext, desto besser die generierten Fragen.

Beispiel:
'Das Passiv wird gebildet mit einer Form von 'be' + Past Participle. 
Simple Present: am/is/are + PP
Simple Past: was/were + PP
Beispiel: The letter is written. The car was stolen.'"></textarea>
                    <div class="char-count"><span id="charCount">0</span> Zeichen</div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>üî¢ Anzahl Fragen</label>
                        <select class="form-select" id="genCount">
                            <option value="10">10 Fragen</option>
                            <option value="15" selected>15 Fragen</option>
                            <option value="20">20 Fragen</option>
                            <option value="25">25 Fragen</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>üéØ Aufgabentypen</label>
                        <select class="form-select" id="genTypes">
                            <option value="mixed">Gemischt (empfohlen)</option>
                            <option value="fillblank">Nur L√ºckentext</option>
                            <option value="choice">Nur Multiple Choice</option>
                            <option value="transform">Nur Umwandlung</option>
                        </select>
                    </div>
                </div>

                <button class="generate-btn" id="generateBtn" disabled>
                    <span>üöÄ Modul generieren</span>
                </button>

                <div class="generator-status" id="generatorStatus">
                    <div class="status-header">
                        <div class="loading-spinner" id="statusSpinner"></div>
                        <span id="statusTitle">Generiere Fragen...</span>
                    </div>
                    <div class="status-text" id="statusText">Claude analysiert dein Material und erstellt passende √úbungsaufgaben.</div>
                </div>

                <div class="generated-preview" id="generatedPreview" style="display: none;">
                    <h4>‚úÖ Generierte Fragen (<span id="previewCount">0</span>)</h4>
                    <div id="previewList"></div>
                    <button class="save-module-btn" id="saveModuleBtn">üíæ Modul speichern und aktivieren</button>
                </div>
            </div>
        </div>

        <!-- Quiz -->
        <div class="quiz-container" id="quizContainer">
            <button class="back-btn" id="backToTopics">‚Üê Zur√ºck zur Themenauswahl</button>
            
            <div class="mode-toggle" id="modeToggle">
                <span class="mode-toggle-label">üé§ Audio-Modus</span>
                <div class="toggle-switch" id="audioToggle"></div>
                <span class="mode-toggle-desc">Fragen h√∂ren, Antworten sprechen</span>
            </div>

            <button class="theory-toggle" id="theoryToggle">üìñ Theorie anzeigen</button>
            <div class="theory-section" id="theorySection"></div>

            <div class="quiz-stats" id="quizStats">
                <div class="quiz-stat"><div class="quiz-stat-value" id="statTotal">0</div><div class="quiz-stat-label">Fragen</div></div>
                <div class="quiz-stat correct"><div class="quiz-stat-value" id="statCorrect">0</div><div class="quiz-stat-label">Richtig</div></div>
                <div class="quiz-stat wrong"><div class="quiz-stat-value" id="statWrong">0</div><div class="quiz-stat-label">Falsch</div></div>
                <div class="quiz-stat percent"><div class="quiz-stat-value" id="statPercent">0%</div><div class="quiz-stat-label">Quote</div></div>
            </div>

            <div id="questionArea">
                <div class="question-header">
                    <span class="question-type-badge" id="questionType">L√ºckentext</span>
                    <span class="question-tense-badge" id="questionTense">Thema</span>
                    <span class="question-number" id="questionNumber">Frage 1/12</span>
                </div>

                <div class="audio-controls" id="audioControls" style="display: none;">
                    <button class="audio-btn speak" id="speakBtn">üîä Vorlesen</button>
                    <button class="audio-btn listen" id="listenBtn">üé§ Sprechen</button>
                </div>

                <div class="voice-visualizer" id="voiceVisualizer">
                    <div class="voice-bar"></div><div class="voice-bar"></div><div class="voice-bar"></div><div class="voice-bar"></div><div class="voice-bar"></div>
                    <span class="voice-status" id="voiceStatus">Ich h√∂re zu...</span>
                </div>

                <div class="recognized-text" id="recognizedText">
                    <div class="label">Erkannt:</div>
                    <div id="recognizedContent"></div>
                </div>

                <div class="question-text" id="questionText"></div>
                <div id="answerArea"></div>

                <div class="feedback" id="feedback">
                    <div class="feedback-title" id="feedbackTitle"></div>
                    <div class="feedback-text" id="feedbackText"></div>
                </div>

                <div class="btn-row">
                    <button class="btn btn-primary" id="checkBtn">‚úì √úberpr√ºfen</button>
                    <button class="btn btn-secondary" id="nextBtn" style="display: none;">N√§chste Frage ‚Üí</button>
                </div>
            </div>

            <div class="result-screen" id="resultScreen">
                <div class="result-emoji" id="resultEmoji">üéâ</div>
                <h2 class="result-title" id="resultTitle">Super gemacht!</h2>
                <div class="result-score" id="resultScore">80%</div>
                <p class="result-text" id="resultText">Du hast 8 von 10 Fragen richtig.</p>
                <div class="btn-row" style="justify-content: center;">
                    <button class="btn btn-primary" id="restartBtn">üîÑ Nochmal √ºben</button>
                    <button class="btn btn-secondary" id="backToTopicsResult">üìö Andere Themen</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // =====================================================
        // CONFIGURATION
        // =====================================================
        const CONFIG = {
            password: "lernen2024",
            questionsPerQuiz: 12
        };

        // =====================================================
        // DATA
        // =====================================================
        const GRADES = [
            { id: 7, name: "Klasse 7", icon: "7Ô∏è‚É£" },
            { id: 8, name: "Klasse 8", icon: "8Ô∏è‚É£" },
            { id: 9, name: "Klasse 9", icon: "9Ô∏è‚É£" },
            { id: 10, name: "Klasse 10", icon: "üîü" }
        ];

        const SUBJECTS = [
            { id: "englisch", name: "Englisch", icon: "üá¨üáß" },
            { id: "deutsch", name: "Deutsch", icon: "üìù" },
            { id: "mathe", name: "Mathematik", icon: "üìê" },
            { id: "franzoesisch", name: "Franz√∂sisch", icon: "üá´üá∑" },
            { id: "geschichte", name: "Geschichte", icon: "üèõÔ∏è" },
            { id: "biologie", name: "Biologie", icon: "üß¨" },
            { id: "physik", name: "Physik", icon: "‚ö°" },
            { id: "chemie", name: "Chemie", icon: "üß™" }
        ];

        const TOPICS = {
            // ==================== KLASSE 7 ====================
            "7-englisch": [
                {
                    id: "passive-voice",
                    name: "Passive Voice",
                    desc: "Das Passiv in verschiedenen Zeitformen",
                    icon: "üîÑ",
                    questions: 15,
                    hasAudio: true,
                    audioLang: "en-GB",
                    theory: `<h3>üìö Das Passive Voice</h3>
                        <div class="rule-box"><strong>Grundregel:</strong> Passiv = Form von <code>be</code> + <code>past participle</code></div>
                        <table><tr><th>Zeitform</th><th>Form</th><th>Beispiel</th></tr>
                        <tr><td>Simple Present</td><td>am/is/are + pp</td><td>English <strong>is spoken</strong> here.</td></tr>
                        <tr><td>Simple Past</td><td>was/were + pp</td><td>The house <strong>was built</strong> in 1950.</td></tr>
                        <tr><td>Present Perfect</td><td>have/has been + pp</td><td>The letter <strong>has been sent</strong>.</td></tr></table>`,
                    questionData: [
                        { type: "fillblank", instruction: "Setze die richtige Passivform ein:", sentence: "English _____ (speak) in many countries.", answer: "is spoken", alternativeAnswers: ["English is spoken in many countries"], tense: "Simple Present" },
                        { type: "fillblank", instruction: "Setze die richtige Passivform ein:", sentence: "The house _____ (build) in 1950.", answer: "was built", alternativeAnswers: ["The house was built in 1950"], tense: "Simple Past" },
                        { type: "fillblank", instruction: "Setze die richtige Passivform ein:", sentence: "The letter _____ already _____ (send).", answer: "has already been sent", alternativeAnswers: ["has been sent"], tense: "Present Perfect" },
                        { type: "transform", instruction: "Wandle ins Passive um:", sentence: "They speak English here.", answer: "English is spoken here.", alternativeAnswers: [], tense: "Simple Present" },
                        { type: "transform", instruction: "Wandle ins Passive um:", sentence: "Someone stole my bike.", answer: "My bike was stolen.", alternativeAnswers: [], tense: "Simple Past" },
                        { type: "fillblank", instruction: "Setze die richtige Passivform ein:", sentence: "Haggis _____ (make) from sheep's stomach.", answer: "is made", alternativeAnswers: [], tense: "Simple Present" },
                        { type: "fillblank", instruction: "Setze die richtige Passivform ein:", sentence: "Penicillin _____ (discover) by Alexander Fleming.", answer: "was discovered", alternativeAnswers: [], tense: "Simple Past" },
                        { type: "fillblank", instruction: "Setze die richtige Passivform ein:", sentence: "Whisky _____ (produce) in Scotland for centuries.", answer: "has been produced", alternativeAnswers: [], tense: "Present Perfect" },
                        { type: "choice", instruction: "W√§hle die richtige Passivform:", sentence: "The windows _____ every week.", options: ["is cleaned", "are cleaned", "was cleaned", "were cleaned"], correctIndex: 1, tense: "Simple Present" },
                        { type: "choice", instruction: "W√§hle die richtige Passivform:", sentence: "The car _____ yesterday.", options: ["is repaired", "are repaired", "was repaired", "were repaired"], correctIndex: 2, tense: "Simple Past" },
                        { type: "transform", instruction: "Wandle ins Passive um:", sentence: "People have read this book many times.", answer: "This book has been read many times.", alternativeAnswers: [], tense: "Present Perfect" },
                        { type: "fillblank", instruction: "Setze die richtige Passivform ein:", sentence: "Ships _____ (build) in Glasgow.", answer: "are built", alternativeAnswers: [], tense: "Simple Present" },
                        { type: "choice", instruction: "Welcher Satz ist Passive?", sentence: "", options: ["She writes letters.", "Letters are written.", "They build houses.", "He reads books."], correctIndex: 1, tense: "Erkennung" },
                        { type: "transform", instruction: "Wandle ins Passive um:", sentence: "They clean the rooms every day.", answer: "The rooms are cleaned every day.", alternativeAnswers: [], tense: "Simple Present" },
                        { type: "fillblank", instruction: "Setze die richtige Passivform ein:", sentence: "The Sherlock Holmes stories _____ (write) by Conan Doyle.", answer: "were written", alternativeAnswers: [], tense: "Simple Past" }
                    ]
                },
                {
                    id: "active-to-passive",
                    name: "Active ‚Üí Passive",
                    desc: "Aktivs√§tze ins Passiv umwandeln",
                    icon: "üîÑ",
                    questions: 25,
                    hasAudio: true,
                    audioLang: "en-GB",
                    theory: `<h3>üîÑ Active to Passive Transformation</h3>
                        
                        <h4>Die Umwandlung Schritt f√ºr Schritt</h4>
                        <div class="rule-box">
                        <strong>Active:</strong> Subject + Verb + Object<br>
                        <strong>Passive:</strong> Object + be + Past Participle (+ by Subject)<br><br>
                        <strong>Beispiel:</strong><br>
                        Active: <code>The dog bites the man.</code><br>
                        Passive: <code>The man is bitten by the dog.</code>
                        </div>
                        
                        <h4>Zeitformen im √úberblick</h4>
                        <table><tr><th>Tense</th><th>Active</th><th>Passive</th></tr>
                        <tr><td>Simple Present</td><td>makes</td><td>is made</td></tr>
                        <tr><td>Simple Past</td><td>made</td><td>was made</td></tr>
                        <tr><td>Present Perfect</td><td>has made</td><td>has been made</td></tr>
                        <tr><td>Past Perfect</td><td>had made</td><td>had been made</td></tr>
                        <tr><td>Will Future</td><td>will make</td><td>will be made</td></tr>
                        <tr><td>Present Progressive</td><td>is making</td><td>is being made</td></tr>
                        <tr><td>Modal Verbs</td><td>can make</td><td>can be made</td></tr></table>
                        
                        <h4>Wann l√§sst man "by..." weg?</h4>
                        <div class="example-box">
                        Wenn der Handelnde unwichtig, unbekannt oder offensichtlich ist:<br>
                        ‚Ä¢ "English <strong>is spoken</strong> here." (by people - offensichtlich)<br>
                        ‚Ä¢ "My bike <strong>was stolen</strong>." (by someone - unbekannt)<br>
                        ‚Ä¢ "The letter <strong>has been sent</strong>." (by us - unwichtig)
                        </div>
                        
                        <h4>Wichtige unregelm√§√üige Past Participles</h4>
                        <table><tr><th>Infinitive</th><th>Past</th><th>Past Participle</th></tr>
                        <tr><td>write</td><td>wrote</td><td>written</td></tr>
                        <tr><td>speak</td><td>spoke</td><td>spoken</td></tr>
                        <tr><td>take</td><td>took</td><td>taken</td></tr>
                        <tr><td>give</td><td>gave</td><td>given</td></tr>
                        <tr><td>see</td><td>saw</td><td>seen</td></tr>
                        <tr><td>steal</td><td>stole</td><td>stolen</td></tr>
                        <tr><td>break</td><td>broke</td><td>broken</td></tr>
                        <tr><td>eat</td><td>ate</td><td>eaten</td></tr></table>`,
                    questionData: [
                        // === SIMPLE PRESENT ===
                        { type: "transform", instruction: "Transform into passive:", sentence: "She writes a letter.", answer: "A letter is written by her.", alternativeAnswers: ["A letter is written."], tense: "Simple Present" },
                        { type: "transform", instruction: "Transform into passive:", sentence: "They make cars in Germany.", answer: "Cars are made in Germany.", alternativeAnswers: [], tense: "Simple Present" },
                        { type: "transform", instruction: "Transform into passive:", sentence: "The teacher explains the grammar.", answer: "The grammar is explained by the teacher.", alternativeAnswers: ["The grammar is explained."], tense: "Simple Present" },
                        { type: "transform", instruction: "Transform into passive:", sentence: "Millions of people speak English.", answer: "English is spoken by millions of people.", alternativeAnswers: ["English is spoken."], tense: "Simple Present" },
                        { type: "transform", instruction: "Transform into passive:", sentence: "The company produces smartphones.", answer: "Smartphones are produced by the company.", alternativeAnswers: ["Smartphones are produced."], tense: "Simple Present" },
                        
                        // === SIMPLE PAST ===
                        { type: "transform", instruction: "Transform into passive:", sentence: "Shakespeare wrote Hamlet.", answer: "Hamlet was written by Shakespeare.", alternativeAnswers: [], tense: "Simple Past" },
                        { type: "transform", instruction: "Transform into passive:", sentence: "Someone stole my bicycle.", answer: "My bicycle was stolen.", alternativeAnswers: ["My bicycle was stolen by someone."], tense: "Simple Past" },
                        { type: "transform", instruction: "Transform into passive:", sentence: "The Romans built this road.", answer: "This road was built by the Romans.", alternativeAnswers: [], tense: "Simple Past" },
                        { type: "transform", instruction: "Transform into passive:", sentence: "Edison invented the light bulb.", answer: "The light bulb was invented by Edison.", alternativeAnswers: [], tense: "Simple Past" },
                        { type: "transform", instruction: "Transform into passive:", sentence: "The police arrested the thief.", answer: "The thief was arrested by the police.", alternativeAnswers: ["The thief was arrested."], tense: "Simple Past" },
                        
                        // === PRESENT PERFECT ===
                        { type: "transform", instruction: "Transform into passive:", sentence: "They have cleaned the windows.", answer: "The windows have been cleaned.", alternativeAnswers: ["The windows have been cleaned by them."], tense: "Present Perfect" },
                        { type: "transform", instruction: "Transform into passive:", sentence: "Someone has eaten my sandwich.", answer: "My sandwich has been eaten.", alternativeAnswers: ["My sandwich has been eaten by someone."], tense: "Present Perfect" },
                        { type: "transform", instruction: "Transform into passive:", sentence: "The students have finished the project.", answer: "The project has been finished by the students.", alternativeAnswers: ["The project has been finished."], tense: "Present Perfect" },
                        { type: "transform", instruction: "Transform into passive:", sentence: "Nobody has opened this door for years.", answer: "This door has not been opened for years.", alternativeAnswers: ["This door hasn't been opened for years."], tense: "Present Perfect" },
                        
                        // === WILL FUTURE ===
                        { type: "transform", instruction: "Transform into passive:", sentence: "They will announce the winner tomorrow.", answer: "The winner will be announced tomorrow.", alternativeAnswers: [], tense: "Will Future" },
                        { type: "transform", instruction: "Transform into passive:", sentence: "The company will build a new factory.", answer: "A new factory will be built by the company.", alternativeAnswers: ["A new factory will be built."], tense: "Will Future" },
                        { type: "transform", instruction: "Transform into passive:", sentence: "Someone will deliver the package.", answer: "The package will be delivered.", alternativeAnswers: ["The package will be delivered by someone."], tense: "Will Future" },
                        
                        // === MODAL VERBS ===
                        { type: "transform", instruction: "Transform into passive:", sentence: "You can see the mountains from here.", answer: "The mountains can be seen from here.", alternativeAnswers: [], tense: "Modal Verbs" },
                        { type: "transform", instruction: "Transform into passive:", sentence: "We must finish this work today.", answer: "This work must be finished today.", alternativeAnswers: [], tense: "Modal Verbs" },
                        { type: "transform", instruction: "Transform into passive:", sentence: "They should inform the parents.", answer: "The parents should be informed.", alternativeAnswers: ["The parents should be informed by them."], tense: "Modal Verbs" },
                        
                        // === PRESENT PROGRESSIVE ===
                        { type: "transform", instruction: "Transform into passive:", sentence: "They are building a new bridge.", answer: "A new bridge is being built.", alternativeAnswers: ["A new bridge is being built by them."], tense: "Present Progressive" },
                        { type: "transform", instruction: "Transform into passive:", sentence: "The mechanic is repairing my car.", answer: "My car is being repaired by the mechanic.", alternativeAnswers: ["My car is being repaired."], tense: "Present Progressive" },
                        
                        // === MIXED / CHALLENGING ===
                        { type: "transform", instruction: "Transform into passive:", sentence: "People grow rice in Asia.", answer: "Rice is grown in Asia.", alternativeAnswers: [], tense: "Simple Present" },
                        { type: "transform", instruction: "Transform into passive:", sentence: "Alexander Fleming discovered penicillin in 1928.", answer: "Penicillin was discovered by Alexander Fleming in 1928.", alternativeAnswers: ["Penicillin was discovered in 1928 by Alexander Fleming.", "Penicillin was discovered in 1928."], tense: "Simple Past" },
                        { type: "transform", instruction: "Transform into passive:", sentence: "Nobody has solved this problem yet.", answer: "This problem has not been solved yet.", alternativeAnswers: ["This problem hasn't been solved yet."], tense: "Present Perfect" }
                    ]
                },
                {
                    id: "scotland",
                    name: "Scotland",
                    desc: "Landeskunde, Geschichte und Kultur Schottlands",
                    icon: "üè¥Û†ÅßÛ†Å¢Û†Å≥Û†Å£Û†Å¥Û†Åø",
                    questions: 41,
                    hasAudio: true,
                    audioLang: "en-GB",
                    theory: `<h3>üè¥Û†ÅßÛ†Å¢Û†Å≥Û†Å£Û†Å¥Û†Åø Scotland ‚Äì Land of Highlands and History</h3>
                        
                        <h4>Geography</h4>
                        <div class="rule-box">
                        <strong>Capital:</strong> Edinburgh (administrative) / Glasgow (largest city)<br>
                        <strong>Location:</strong> Northern part of Great Britain<br>
                        <strong>Famous regions:</strong> Highlands, Lowlands, Scottish Islands<br>
                        <strong>Famous lakes (Lochs):</strong> Loch Ness, Loch Lomond
                        </div>
                        
                        <h4>Politics & Independence</h4>
                        <div class="example-box">
                        ‚Ä¢ Scotland is part of the <strong>United Kingdom</strong><br>
                        ‚Ä¢ <strong>2014:</strong> Independence referendum ‚Äì Scotland voted to stay in the UK (55% No)<br>
                        ‚Ä¢ Scotland has its own <strong>Parliament</strong> in Edinburgh (since 1999)<br>
                        ‚Ä¢ The Scottish flag is called the <strong>Saltire</strong> (white X on blue)
                        </div>
                        
                        <h4>History</h4>
                        <div class="example-box">
                        ‚Ä¢ <strong>William Wallace</strong> ‚Äì Scottish knight who fought for independence (13th century)<br>
                        ‚Ä¢ <strong>Robert the Bruce</strong> ‚Äì King who won independence at Bannockburn (1314)<br>
                        ‚Ä¢ <strong>Mary Queen of Scots</strong> ‚Äì Tragic queen, executed in 1587<br>
                        ‚Ä¢ <strong>1707</strong> ‚Äì Act of Union joined Scotland and England
                        </div>
                        
                        <h4>Culture & Symbols</h4>
                        <table><tr><th>Symbol</th><th>Meaning</th></tr>
                        <tr><td>üè¥Û†ÅßÛ†Å¢Û†Å≥Û†Å£Û†Å¥Û†Åø Saltire</td><td>White X on blue ‚Äì St. Andrew's Cross</td></tr>
                        <tr><td>üå∏ Thistle</td><td>National flower of Scotland</td></tr>
                        <tr><td>üéµ Bagpipes</td><td>Traditional musical instrument</td></tr>
                        <tr><td>üëò Kilt & Tartan</td><td>Traditional dress with clan patterns</td></tr>
                        <tr><td>ü¶Ñ Unicorn</td><td>National animal of Scotland</td></tr>
                        <tr><td>üèîÔ∏è Highland Games</td><td>Traditional sports including caber toss</td></tr></table>
                        
                        <h4>Famous Scottish Inventors</h4>
                        <div class="example-box">
                        ‚Ä¢ <strong>Alexander Graham Bell</strong> ‚Äì Invented the telephone<br>
                        ‚Ä¢ <strong>Alexander Fleming</strong> ‚Äì Discovered penicillin<br>
                        ‚Ä¢ <strong>James Watt</strong> ‚Äì Improved the steam engine<br>
                        ‚Ä¢ <strong>John Logie Baird</strong> ‚Äì Invented the television
                        </div>
                        
                        <h4>Food & Drink</h4>
                        <div class="rule-box">
                        ‚Ä¢ <strong>Haggis</strong> ‚Äì Traditional dish (sheep's organs), served with neeps and tatties<br>
                        ‚Ä¢ <strong>Shortbread</strong> ‚Äì Famous Scottish biscuit<br>
                        ‚Ä¢ <strong>Whisky</strong> ‚Äì Scotland is famous for Scotch whisky<br>
                        ‚Ä¢ <strong>Porridge</strong> ‚Äì Traditional oat breakfast
                        </div>
                        
                        <h4>Landmarks</h4>
                        <div class="example-box">
                        ‚Ä¢ <strong>Edinburgh Castle</strong> ‚Äì Famous castle on a rock in Edinburgh<br>
                        ‚Ä¢ <strong>Royal Mile</strong> ‚Äì Historic street in Edinburgh<br>
                        ‚Ä¢ <strong>Loch Ness</strong> ‚Äì Home of the legendary monster "Nessie"
                        </div>`,
                    questionData: [
                        // === GRUNDLAGEN (einfache Einstiegsfragen) ===
                        { type: "choice", instruction: "What is the capital of Scotland?", sentence: "", options: ["Glasgow", "Edinburgh", "Aberdeen", "Dundee"], correctIndex: 1, tense: "Grundlagen" },
                        { type: "choice", instruction: "What is the largest city in Scotland?", sentence: "", options: ["Edinburgh", "Aberdeen", "Glasgow", "Inverness"], correctIndex: 2, tense: "Grundlagen" },
                        { type: "choice", instruction: "Where is Scotland located?", sentence: "", options: ["South of England", "West of Wales", "North of England", "East of Ireland"], correctIndex: 2, tense: "Grundlagen" },
                        { type: "choice", instruction: "What does the Scottish flag look like?", sentence: "", options: ["Red cross on white", "White X on blue", "Green with harp", "Red dragon on white-green"], correctIndex: 1, tense: "Grundlagen" },
                        { type: "choice", instruction: "What is the Scottish flag called?", sentence: "", options: ["Union Jack", "St. George's Cross", "Saltire", "Tricolour"], correctIndex: 2, tense: "Grundlagen" },
                        { type: "choice", instruction: "Which famous castle sits on a rock in the centre of Edinburgh?", sentence: "", options: ["Windsor Castle", "Edinburgh Castle", "Tower of London", "Stirling Castle"], correctIndex: 1, tense: "Grundlagen" },
                        { type: "choice", instruction: "What is the traditional Scottish skirt called?", sentence: "", options: ["Toga", "Sarong", "Kilt", "Tunic"], correctIndex: 2, tense: "Grundlagen" },
                        { type: "choice", instruction: "What is tartan?", sentence: "", options: ["A Scottish dance", "A pattern on fabric showing clan identity", "A type of whisky", "A musical instrument"], correctIndex: 1, tense: "Grundlagen" },
                        { type: "choice", instruction: "What musical instrument is Scotland famous for?", sentence: "", options: ["Violin", "Bagpipes", "Accordion", "Harp"], correctIndex: 1, tense: "Grundlagen" },
                        { type: "choice", instruction: "What is the national flower of Scotland?", sentence: "", options: ["Rose", "Shamrock", "Thistle", "Daffodil"], correctIndex: 2, tense: "Grundlagen" },
                        { type: "choice", instruction: "What is haggis?", sentence: "", options: ["A Scottish dance", "A traditional Scottish dish", "A type of whisky", "A musical instrument"], correctIndex: 1, tense: "Grundlagen" },
                        { type: "choice", instruction: "Which Scottish scientist discovered penicillin?", sentence: "", options: ["Alexander Graham Bell", "James Watt", "Alexander Fleming", "John Logie Baird"], correctIndex: 2, tense: "Grundlagen" },
                        { type: "choice", instruction: "Which Scottish inventor created the telephone?", sentence: "", options: ["Alexander Fleming", "Alexander Graham Bell", "James Watt", "John Logie Baird"], correctIndex: 1, tense: "Grundlagen" },
                        
                        // === REFERENDUM & POLITIK ===
                        { type: "choice", instruction: "In which year did Scotland hold a referendum on independence?", sentence: "", options: ["2010", "2014", "2016", "2020"], correctIndex: 1, tense: "Politik" },
                        { type: "choice", instruction: "What was the result of the 2014 Scottish independence referendum?", sentence: "", options: ["Scotland became independent", "Scotland voted to stay in the UK", "The vote was cancelled", "It was a tie"], correctIndex: 1, tense: "Politik" },
                        { type: "choice", instruction: "Scotland is part of which country?", sentence: "", options: ["Ireland", "The United Kingdom", "France", "It is independent"], correctIndex: 1, tense: "Politik" },
                        { type: "choice", instruction: "What is the Scottish Parliament building located in?", sentence: "", options: ["Glasgow", "Edinburgh", "Aberdeen", "Inverness"], correctIndex: 1, tense: "Politik" },
                        
                        // === GEOGRAPHIE (vertiefend) ===
                        { type: "choice", instruction: "What are the Scottish mountains called?", sentence: "", options: ["The Alps", "The Pennines", "The Highlands", "The Rockies"], correctIndex: 2, tense: "Geographie" },
                        { type: "choice", instruction: "What is the famous lake where a monster is said to live?", sentence: "", options: ["Loch Lomond", "Loch Ness", "Loch Tay", "Loch Katrine"], correctIndex: 1, tense: "Geographie" },
                        { type: "choice", instruction: "What is the nickname of the Loch Ness Monster?", sentence: "", options: ["Nelly", "Nessie", "Scottie", "Lockie"], correctIndex: 1, tense: "Geographie" },
                        { type: "choice", instruction: "Which body of water lies to the east of Scotland?", sentence: "", options: ["Atlantic Ocean", "Irish Sea", "North Sea", "English Channel"], correctIndex: 2, tense: "Geographie" },
                        { type: "choice", instruction: "What is the Royal Mile?", sentence: "", options: ["A Scottish race", "A famous street in Edinburgh", "A unit of measurement", "A river in Glasgow"], correctIndex: 1, tense: "Geographie" },
                        { type: "choice", instruction: "What is the Scottish word for 'lake'?", sentence: "", options: ["Loch", "Lough", "Lake", "Mere"], correctIndex: 0, tense: "Geographie" },
                        
                        // === KULTUR (vertiefend) ===
                        { type: "choice", instruction: "What are the Highland Games?", sentence: "", options: ["Video games from Scotland", "Traditional Scottish sports events", "A TV quiz show", "Children's playground activities"], correctIndex: 1, tense: "Kultur" },
                        { type: "choice", instruction: "What is caber tossing?", sentence: "", options: ["Throwing a heavy log", "A type of dance", "Cooking haggis", "Playing bagpipes"], correctIndex: 0, tense: "Kultur" },
                        { type: "choice", instruction: "Burns Night celebrates which famous Scot?", sentence: "", options: ["William Wallace", "Robert Burns", "Sean Connery", "Alexander Fleming"], correctIndex: 1, tense: "Kultur" },
                        { type: "choice", instruction: "The Saltire represents which saint?", sentence: "", options: ["St. George", "St. Patrick", "St. David", "St. Andrew"], correctIndex: 3, tense: "Kultur" },
                        { type: "choice", instruction: "What is Scotland's national animal?", sentence: "", options: ["Lion", "Unicorn", "Dragon", "Eagle"], correctIndex: 1, tense: "Kultur" },
                        { type: "choice", instruction: "Scotland is famous for producing which drink?", sentence: "", options: ["Wine", "Beer", "Whisky", "Cider"], correctIndex: 2, tense: "Kultur" },
                        { type: "choice", instruction: "What traditional dish is often eaten with haggis?", sentence: "", options: ["Fish and chips", "Neeps and tatties (turnips and potatoes)", "Roast beef", "Chicken curry"], correctIndex: 1, tense: "Kultur" },
                        { type: "choice", instruction: "What is shortbread?", sentence: "", options: ["A type of bread", "A famous Scottish biscuit", "A whisky brand", "A cheese"], correctIndex: 1, tense: "Kultur" },
                        
                        // === BER√úHMTE SCHOTTEN ===
                        { type: "choice", instruction: "Who wrote the famous song 'Auld Lang Syne'?", sentence: "", options: ["Walter Scott", "Robert Burns", "William Shakespeare", "Charles Dickens"], correctIndex: 1, tense: "Ber√ºhmte Schotten" },
                        { type: "choice", instruction: "Which Scottish actor played James Bond?", sentence: "", options: ["Ewan McGregor", "Gerard Butler", "Sean Connery", "James McAvoy"], correctIndex: 2, tense: "Ber√ºhmte Schotten" },
                        { type: "choice", instruction: "Sir Walter Scott wrote which famous novel?", sentence: "", options: ["Harry Potter", "Ivanhoe", "Pride and Prejudice", "Oliver Twist"], correctIndex: 1, tense: "Ber√ºhmte Schotten" },
                        { type: "choice", instruction: "Which Scottish engineer improved the steam engine?", sentence: "", options: ["Alexander Fleming", "Alexander Graham Bell", "James Watt", "John Logie Baird"], correctIndex: 2, tense: "Ber√ºhmte Schotten" },
                        { type: "choice", instruction: "Which Scot invented the television?", sentence: "", options: ["Alexander Fleming", "Alexander Graham Bell", "James Watt", "John Logie Baird"], correctIndex: 3, tense: "Ber√ºhmte Schotten" },
                        
                        // === GESCHICHTE (fortgeschritten) ===
                        { type: "choice", instruction: "Who was the Scottish knight who fought for independence in the 13th century?", sentence: "", options: ["Robert the Bruce", "William Wallace", "Macbeth", "James Stuart"], correctIndex: 1, tense: "Geschichte" },
                        { type: "choice", instruction: "Which Scottish king won the Battle of Bannockburn in 1314?", sentence: "", options: ["William Wallace", "James I", "Robert the Bruce", "Malcolm III"], correctIndex: 2, tense: "Geschichte" },
                        { type: "choice", instruction: "In which year did Scotland and England unite through the Act of Union?", sentence: "", options: ["1603", "1707", "1776", "1066"], correctIndex: 1, tense: "Geschichte" },
                        { type: "choice", instruction: "Who was Mary Queen of Scots?", sentence: "", options: ["A famous painter", "A Scottish queen who was executed", "The wife of William Wallace", "A legendary princess"], correctIndex: 1, tense: "Geschichte" },
                        { type: "choice", instruction: "The Battle of Bannockburn was fought for Scottish...", sentence: "", options: ["trade rights", "religious freedom", "independence", "land ownership"], correctIndex: 2, tense: "Geschichte" }
                    ]
                }
            ],
            "7-mathe": [
                {
                    id: "kommutativgesetz",
                    name: "Kommutativgesetz",
                    desc: "Vertauschungsgesetz bei Addition und Multiplikation",
                    icon: "üîÄ",
                    questions: 15,
                    hasAudio: false,
                    theory: `<h3>üìö Das Kommutativgesetz</h3>
                        <div class="rule-box"><strong>Definition:</strong> Bei Addition und Multiplikation darf man die Reihenfolge der Zahlen vertauschen, ohne dass sich das Ergebnis √§ndert.</div>
                        <h4>Addition</h4>
                        <div class="example-box"><code>a + b = b + a</code><br>Beispiel: <code>3 + 5 = 5 + 3 = 8</code></div>
                        <h4>Multiplikation</h4>
                        <div class="example-box"><code>a ¬∑ b = b ¬∑ a</code><br>Beispiel: <code>4 ¬∑ 7 = 7 ¬∑ 4 = 28</code></div>
                        <h4>‚ö†Ô∏è Achtung!</h4>
                        <div class="rule-box">Das Kommutativgesetz gilt <strong>NICHT</strong> f√ºr Subtraktion und Division!<br>
                        <code>5 - 3 ‚â† 3 - 5</code> und <code>8 : 2 ‚â† 2 : 8</code></div>`,
                    questionData: [
                        { type: "choice", instruction: "Bei welcher Rechenart gilt das Kommutativgesetz?", sentence: "", options: ["Nur Addition", "Nur Multiplikation", "Addition und Multiplikation", "Alle vier Grundrechenarten"], correctIndex: 2, tense: "Grundlagen" },
                        { type: "fillblank", instruction: "Wende das Kommutativgesetz an:", sentence: "7 + 12 = 12 + _____", answer: "7", alternativeAnswers: [], tense: "Addition" },
                        { type: "fillblank", instruction: "Wende das Kommutativgesetz an:", sentence: "9 ¬∑ 4 = _____ ¬∑ 9", answer: "4", alternativeAnswers: [], tense: "Multiplikation" },
                        { type: "choice", instruction: "Welche Gleichung ist korrekt?", sentence: "", options: ["15 - 8 = 8 - 15", "6 ¬∑ 11 = 11 ¬∑ 6", "20 : 4 = 4 : 20", "Keine davon"], correctIndex: 1, tense: "Anwendung" },
                        { type: "fillblank", instruction: "Berechne geschickt mit dem Kommutativgesetz:", sentence: "17 + 45 + 3 = 17 + 3 + 45 = _____ + 45 = _____", answer: "65", alternativeAnswers: ["20 + 45 = 65"], tense: "Rechentrick" },
                        { type: "choice", instruction: "Warum gilt 8 - 3 ‚â† 3 - 8?", sentence: "", options: ["Weil das Ergebnis negativ wird", "Weil Subtraktion nicht kommutativ ist", "Beides ist richtig", "Weil 3 kleiner als 8 ist"], correctIndex: 2, tense: "Verst√§ndnis" },
                        { type: "fillblank", instruction: "Setze ein:", sentence: "a + b = _____ + a", answer: "b", alternativeAnswers: [], tense: "Formel" },
                        { type: "fillblank", instruction: "Setze ein:", sentence: "x ¬∑ y = y ¬∑ _____", answer: "x", alternativeAnswers: [], tense: "Formel" },
                        { type: "choice", instruction: "Berechne geschickt: 25 ¬∑ 7 ¬∑ 4", sentence: "", options: ["175 ¬∑ 4 = 700", "25 ¬∑ 4 ¬∑ 7 = 100 ¬∑ 7 = 700", "Beides f√ºhrt zum gleichen Ergebnis", "Das geht nicht"], correctIndex: 2, tense: "Rechentrick" },
                        { type: "fillblank", instruction: "Erg√§nze:", sentence: "13 + 27 + 7 = 13 + 7 + 27 = _____ + 27 = 47", answer: "20", alternativeAnswers: [], tense: "Rechentrick" },
                        { type: "choice", instruction: "Welche Aussage ist FALSCH?", sentence: "", options: ["3 + 5 = 5 + 3", "6 ¬∑ 2 = 2 ¬∑ 6", "10 - 4 = 4 - 10", "100 ¬∑ 1 = 1 ¬∑ 100"], correctIndex: 2, tense: "Erkennung" },
                        { type: "fillblank", instruction: "Berechne mit Kommutativgesetz:", sentence: "4 ¬∑ 17 ¬∑ 25 = 4 ¬∑ 25 ¬∑ 17 = _____ ¬∑ 17 = _____", answer: "1700", alternativeAnswers: ["100 ¬∑ 17 = 1700"], tense: "Rechentrick" },
                        { type: "choice", instruction: "Das Kommutativgesetz hei√üt auch:", sentence: "", options: ["Vertauschungsgesetz", "Verbindungsgesetz", "Verteilungsgesetz", "Umkehrgesetz"], correctIndex: 0, tense: "Begriff" },
                        { type: "fillblank", instruction: "F√ºlle aus:", sentence: "F√ºr die _____ und _____ gilt das Kommutativgesetz.", answer: "Addition und Multiplikation", alternativeAnswers: ["Addition, Multiplikation", "Multiplikation und Addition"], tense: "Definition" },
                        { type: "choice", instruction: "Welche Rechnung nutzt das Kommutativgesetz clever?", sentence: "", options: ["99 + 47 = 100 + 46", "8 ¬∑ 125 = 125 ¬∑ 8 = 1000", "50 - 25 = 25", "144 : 12 = 12"], correctIndex: 1, tense: "Anwendung" }
                    ]
                }
            ],
            "7-deutsch": [
                {
                    id: "argumentieren",
                    name: "Argumentieren",
                    desc: "Stellung beziehen, Argumente anf√ºhren, Beispiele geben",
                    icon: "üí¨",
                    questions: 25,
                    hasAudio: false,
                    theory: `<h3>üìö Richtig Argumentieren</h3>
                        <div class="rule-box"><strong>Die drei Schritte einer guten Argumentation:</strong><br><br>
                        <strong>1. Stellung beziehen (These)</strong><br>
                        ‚Üí Deine Meinung klar und deutlich formulieren<br><br>
                        <strong>2. Argument anf√ºhren (Begr√ºndung)</strong><br>
                        ‚Üí Erkl√§ren, WARUM du so denkst<br><br>
                        <strong>3. Beispiel anf√ºgen (Beleg)</strong><br>
                        ‚Üí Mit einem konkreten Beispiel untermauern</div>
                        
                        <h4>Beispiel einer vollst√§ndigen Argumentation:</h4>
                        <div class="example-box">
                        <strong>These:</strong> "Ich bin der Meinung, dass der Schulbeginn auf 9 Uhr verschoben werden sollte."<br><br>
                        <strong>Argument:</strong> "Jugendliche brauchen mehr Schlaf als Erwachsene, und Schlafmangel f√ºhrt zu Konzentrationsproblemen."<br><br>
                        <strong>Beispiel:</strong> "Studien zeigen, dass Sch√ºler an Schulen mit sp√§terem Beginn bessere Noten haben. In meiner Klasse sind morgens viele m√ºde und unkonzentriert."</div>
                        
                        <h4>Wichtige Formulierungshilfen:</h4>
                        <table><tr><th>F√ºr...</th><th>Formulierungen</th></tr>
                        <tr><td>These</td><td>Ich bin der Meinung, dass... / Meiner Ansicht nach... / Ich finde, dass...</td></tr>
                        <tr><td>Argument</td><td>...weil / ...denn / Ein wichtiger Grund ist... / Das liegt daran, dass...</td></tr>
                        <tr><td>Beispiel</td><td>Zum Beispiel... / Das zeigt sich daran, dass... / Ein Beleg daf√ºr ist...</td></tr></table>
                        
                        <h4>Tipps f√ºr starke Argumente:</h4>
                        <ul style="margin-left: 20px; line-height: 1.8;">
                        <li>Sachlich bleiben, nicht beleidigend werden</li>
                        <li>Fakten und Beispiele nutzen</li>
                        <li>Auch die Gegenseite bedenken</li>
                        <li>Vom st√§rksten zum schw√§chsten Argument ordnen</li>
                        </ul>`,
                    questionData: [
                        // === GRUNDLAGEN: Was ist was? ===
                        { type: "choice", instruction: "Was ist der ERSTE Schritt beim Argumentieren?", sentence: "", options: ["Ein Beispiel nennen", "Stellung beziehen (These)", "Ein Argument anf√ºhren", "Die Gegenmeinung nennen"], correctIndex: 1, tense: "Grundlagen" },
                        { type: "choice", instruction: "Was ist eine THESE?", sentence: "", options: ["Ein Beweis f√ºr etwas", "Eine Frage", "Eine Behauptung/Meinung", "Ein Beispiel"], correctIndex: 2, tense: "Grundlagen" },
                        { type: "choice", instruction: "Wozu dient ein ARGUMENT?", sentence: "", options: ["Um die These zu begr√ºnden", "Um ein Beispiel zu geben", "Um die Gegenseite zu beleidigen", "Um das Thema zu wechseln"], correctIndex: 0, tense: "Grundlagen" },
                        { type: "choice", instruction: "Wozu dient ein BEISPIEL in der Argumentation?", sentence: "", options: ["Um vom Thema abzulenken", "Um das Argument zu belegen und anschaulich zu machen", "Um die Meinung zu √§ndern", "Um lustig zu sein"], correctIndex: 1, tense: "Grundlagen" },
                        { type: "fillblank", instruction: "Erg√§nze die richtige Reihenfolge:", sentence: "1. These ‚Üí 2. _____ ‚Üí 3. Beispiel", answer: "Argument", alternativeAnswers: ["Begr√ºndung", "Argumente"], tense: "Grundlagen" },
                        
                        // === ERKENNUNG: Was ist das? ===
                        { type: "choice", instruction: "Um welchen Teil einer Argumentation handelt es sich?", sentence: "\"Ich bin der Meinung, dass Hausaufgaben abgeschafft werden sollten.\"", options: ["Beispiel", "Argument", "These", "Gegenargument"], correctIndex: 2, tense: "Erkennung" },
                        { type: "choice", instruction: "Um welchen Teil einer Argumentation handelt es sich?", sentence: "\"...denn Sch√ºler haben nach der Schule kaum noch Freizeit f√ºr Hobbys und Erholung.\"", options: ["These", "Argument", "Beispiel", "Einleitung"], correctIndex: 1, tense: "Erkennung" },
                        { type: "choice", instruction: "Um welchen Teil einer Argumentation handelt es sich?", sentence: "\"Mein Freund Max muss jeden Tag zwei Stunden Hausaufgaben machen und kann deshalb nicht mehr zum Fu√üballtraining.\"", options: ["These", "Argument", "Beispiel", "Schluss"], correctIndex: 2, tense: "Erkennung" },
                        { type: "choice", instruction: "Um welchen Teil einer Argumentation handelt es sich?", sentence: "\"Meiner Ansicht nach sollten alle Sch√ºler ein Tablet im Unterricht nutzen d√ºrfen.\"", options: ["Argument", "Beispiel", "Gegenargument", "These"], correctIndex: 3, tense: "Erkennung" },
                        { type: "choice", instruction: "Um welchen Teil einer Argumentation handelt es sich?", sentence: "\"In Finnland haben Schulen den Tablet-Einsatz getestet und die Sch√ºler waren motivierter.\"", options: ["These", "Argument", "Beispiel", "Meinung"], correctIndex: 2, tense: "Erkennung" },
                        
                        // === FORMULIERUNGSHILFEN ===
                        { type: "fillblank", instruction: "Welches Wort leitet ein ARGUMENT ein?", sentence: "Handys sollten in der Schule erlaubt sein, _____ man sie f√ºr Recherchen nutzen kann.", answer: "weil", alternativeAnswers: ["denn", "da"], tense: "Formulierung" },
                        { type: "fillblank", instruction: "Welche Formulierung leitet eine THESE ein?", sentence: "_____ bin ich davon √ºberzeugt, dass Sport wichtig f√ºr die Gesundheit ist.", answer: "Deshalb", alternativeAnswers: ["Daher", "Darum", "Aus diesem Grund"], tense: "Formulierung" },
                        { type: "fillblank", instruction: "Welche Formulierung leitet ein BEISPIEL ein?", sentence: "_____ zeigt die Studie der Universit√§t Hamburg, dass Bewegung die Konzentration f√∂rdert.", answer: "Zum Beispiel", alternativeAnswers: ["Beispielsweise", "So", "Das zeigt sich daran"], tense: "Formulierung" },
                        { type: "choice", instruction: "Welche Formulierung eignet sich f√ºr eine THESE?", sentence: "", options: ["Zum Beispiel...", "Ich bin der Meinung, dass...", "Das liegt daran, dass...", "Au√üerdem..."], correctIndex: 1, tense: "Formulierung" },
                        { type: "choice", instruction: "Welches Wort verbindet These und Argument?", sentence: "", options: ["obwohl", "trotzdem", "weil/denn", "aber"], correctIndex: 2, tense: "Formulierung" },
                        
                        // === ZUORDNUNG: Was passt zusammen? ===
                        { type: "choice", instruction: "Welches Beispiel passt zum Argument \"Haustiere f√∂rdern das Verantwortungsbewusstsein\"?", sentence: "", options: ["Hunde sind s√º√ü.", "Meine Schwester f√ºttert t√§glich ihren Hamster und k√ºmmert sich um sein Gehege.", "Katzen schlafen viel.", "Haustiere kosten Geld."], correctIndex: 1, tense: "Zuordnung" },
                        { type: "choice", instruction: "Welches Argument passt zur These \"Schuluniformen sollten eingef√ºhrt werden\"?", sentence: "", options: ["Uniformen sind teuer.", "Dadurch gibt es weniger Mobbing wegen Kleidung.", "Ich mag keine Uniformen.", "Meine Freunde finden das auch doof."], correctIndex: 1, tense: "Zuordnung" },
                        { type: "choice", instruction: "Welches Beispiel passt NICHT zum Thema \"Handyverbot in der Schule\"?", sentence: "", options: ["In Frankreich sind Handys an Schulen verboten.", "Mein Bruder isst gerne Pizza.", "Eine Studie zeigt, dass Sch√ºler ohne Handy konzentrierter sind.", "In unserer Schule gab es schon Streit wegen Handy-Videos."], correctIndex: 1, tense: "Zuordnung" },
                        
                        // === BEWERTUNG: Stark oder schwach? ===
                        { type: "choice", instruction: "Welches ist das ST√ÑRKERE Argument f√ºr Schuluniformen?", sentence: "", options: ["Uniformen sind praktisch.", "Niemand wird wegen seiner Kleidung geh√§nselt, was Mobbing reduziert.", "Mein Onkel findet Uniformen gut.", "In England gibt es auch Uniformen."], correctIndex: 1, tense: "Bewertung" },
                        { type: "choice", instruction: "Welches Argument ist SCHWACH, weil es nur eine pers√∂nliche Meinung ohne Begr√ºndung ist?", sentence: "", options: ["Hausaufgaben helfen, den Stoff zu wiederholen.", "Ich finde Hausaufgaben einfach doof.", "Studien zeigen, dass moderates √úben den Lernerfolg steigert.", "Viele Sch√ºler haben durch Hausaufgaben wenig Freizeit."], correctIndex: 1, tense: "Bewertung" },
                        { type: "choice", instruction: "Was macht ein Argument STARK?", sentence: "", options: ["Es ist sehr lang.", "Es enth√§lt Schimpfw√∂rter.", "Es ist sachlich und enth√§lt Fakten oder nachvollziehbare Gr√ºnde.", "Es wiederholt nur die These."], correctIndex: 2, tense: "Bewertung" },
                        
                        // === STRUKTUR ERKENNEN ===
                        { type: "choice", instruction: "Welche Argumentation ist VOLLST√ÑNDIG (These + Argument + Beispiel)?", sentence: "", options: [
                            "Ich finde Hunde toll. Mein Nachbar hat einen Hund.",
                            "Haustiere sind gut f√ºr Kinder, weil sie Verantwortung lernen. Meine Schwester k√ºmmert sich t√§glich um ihren Hamster.",
                            "Katzen sind s√º√ü. Katzen schnurren. Katzen schlafen viel.",
                            "Meiner Meinung nach sollte man Sport machen."
                        ], correctIndex: 1, tense: "Struktur" },
                        { type: "choice", instruction: "Was FEHLT in dieser Argumentation: \"Ich finde, Sch√ºler sollten sp√§ter zur Schule kommen. In Seattle wurde der Schulbeginn auf 8:45 Uhr verschoben und die Noten wurden besser.\"", sentence: "", options: ["Die These", "Das Argument (Begr√ºndung)", "Das Beispiel", "Nichts, sie ist vollst√§ndig"], correctIndex: 1, tense: "Struktur" },
                        { type: "choice", instruction: "Was FEHLT hier: \"Vegetarische Ern√§hrung ist ges√ºnder, weil sie weniger ges√§ttigte Fette enth√§lt und das Herzinfarkt-Risiko senkt.\"", sentence: "", options: ["Die These", "Das Argument", "Ein konkretes Beispiel", "Alles ist vorhanden"], correctIndex: 2, tense: "Struktur" },
                        
                        // === ANWENDUNG: Themen durchdenken ===
                        { type: "choice", instruction: "Du sollst F√úR ein Handyverbot in der Schule argumentieren. Welches Argument passt?", sentence: "", options: [
                            "Handys sind teuer.",
                            "Ohne Handys konzentrieren sich Sch√ºler besser auf den Unterricht.",
                            "Meine Eltern haben mir ein neues Handy gekauft.",
                            "In anderen L√§ndern gibt es auch Handys."
                        ], correctIndex: 1, tense: "Anwendung" },
                        { type: "choice", instruction: "Du sollst GEGEN Hausaufgaben argumentieren. Welches ist das beste Argument?", sentence: "", options: [
                            "Hausaufgaben sind langweilig.",
                            "Mein Freund macht auch keine Hausaufgaben.",
                            "Nach 6 Stunden Schule brauchen Sch√ºler Erholung, um am n√§chsten Tag wieder konzentriert zu sein.",
                            "Lehrer geben zu viele Hausaufgaben."
                        ], correctIndex: 2, tense: "Anwendung" }
                    ]
                },
                {
                    id: "argumentieren-aufbau",
                    name: "Argumentieren Aufbau",
                    desc: "Gegenargumente, Entkr√§ftung, Argumentationsstrategien",
                    icon: "üéØ",
                    questions: 30,
                    hasAudio: false,
                    theory: `<h3>üéØ Argumentieren f√ºr Fortgeschrittene</h3>
                        
                        <h4>1. Das Sanduhr-Prinzip</h4>
                        <div class="rule-box">
                        <strong>Aufbau einer √ºberzeugenden Argumentation:</strong><br><br>
                        1. <strong>Einleitung:</strong> Thema vorstellen, Interesse wecken<br>
                        2. <strong>These:</strong> Eigene Position klar formulieren<br>
                        3. <strong>Argumente:</strong> Vom st√§rksten zum schw√§chsten ODER umgekehrt<br>
                        4. <strong>Gegenargument:</strong> Die andere Seite anerkennen<br>
                        5. <strong>Entkr√§ftung:</strong> Das Gegenargument widerlegen<br>
                        6. <strong>Schluss:</strong> These bekr√§ftigen, Appell
                        </div>
                        
                        <h4>2. Argumenttypen</h4>
                        <table><tr><th>Typ</th><th>Beschreibung</th><th>Beispiel</th></tr>
                        <tr><td>Faktenargument</td><td>Beruft sich auf Tatsachen, Statistiken</td><td>"Studien belegen, dass..."</td></tr>
                        <tr><td>Autorit√§tsargument</td><td>Beruft sich auf Experten</td><td>"Laut Professor M√ºller..."</td></tr>
                        <tr><td>Erfahrungsargument</td><td>Beruft sich auf eigene Erlebnisse</td><td>"Ich selbst habe erlebt..."</td></tr>
                        <tr><td>Normatives Argument</td><td>Beruft sich auf Werte/Regeln</td><td>"Es geh√∂rt zur Fairness..."</td></tr>
                        <tr><td>Analogie-Argument</td><td>Vergleich mit √§hnlicher Situation</td><td>"Genauso wie bei... ist es auch hier..."</td></tr></table>
                        
                        <h4>3. Gegenargumente entkr√§ften</h4>
                        <div class="example-box">
                        <strong>Gegenargument:</strong> "Schuluniformen sind teuer."<br><br>
                        <strong>Entkr√§ftung:</strong> "Es stimmt, dass die Anschaffung zun√§chst kostet. Allerdings spart man langfristig Geld, weil man keine teuren Markenkleidung kaufen muss, um 'dazuzugeh√∂ren'. Au√üerdem k√∂nnten Schulen Unterst√ºtzung f√ºr einkommensschwache Familien anbieten."
                        </div>
                        
                        <h4>4. Formulierungshilfen f√ºr Fortgeschrittene</h4>
                        <table><tr><th>Funktion</th><th>Formulierungen</th></tr>
                        <tr><td>Gegenargument einleiten</td><td>Kritiker wenden ein... / Man k√∂nnte einwenden... / Gegner behaupten...</td></tr>
                        <tr><td>Zugestehen</td><td>Zwar stimmt es, dass... / Es ist richtig, dass... / Nat√ºrlich...</td></tr>
                        <tr><td>Entkr√§ften</td><td>Allerdings... / Jedoch... / Dennoch muss man bedenken...</td></tr>
                        <tr><td>Verst√§rken</td><td>Hinzu kommt... / Dar√ºber hinaus... / Au√üerdem...</td></tr>
                        <tr><td>Schluss</td><td>Zusammenfassend... / Abschlie√üend... / Daher pl√§diere ich f√ºr...</td></tr></table>
                        
                        <h4>5. Typische Argumentationsfehler</h4>
                        <ul style="margin-left: 20px; line-height: 1.8;">
                        <li><strong>Ad hominem:</strong> Die Person angreifen statt das Argument</li>
                        <li><strong>Strohmann:</strong> Das Argument des Gegners verzerren</li>
                        <li><strong>Falsche Verallgemeinerung:</strong> Von Einzelf√§llen auf alle schlie√üen</li>
                        <li><strong>Scheinkausalit√§t:</strong> Zusammenhang ohne echten Beweis behaupten</li>
                        <li><strong>Emotionalisierung:</strong> Nur auf Gef√ºhle setzen statt Fakten</li>
                        </ul>`,
                    questionData: [
                        // === ARGUMENTTYPEN ERKENNEN ===
                        { type: "choice", instruction: "Um welchen Argumenttyp handelt es sich?", sentence: "\"Laut einer Studie der TU M√ºnchen lernen Sch√ºler mit digitalen Medien 20% schneller.\"", options: ["Erfahrungsargument", "Faktenargument", "Normatives Argument", "Analogie-Argument"], correctIndex: 1, tense: "Argumenttypen" },
                        { type: "choice", instruction: "Um welchen Argumenttyp handelt es sich?", sentence: "\"Professor Dr. Schmidt, Bildungsexperte, empfiehlt k√ºrzere Schultage.\"", options: ["Faktenargument", "Autorit√§tsargument", "Erfahrungsargument", "Analogie-Argument"], correctIndex: 1, tense: "Argumenttypen" },
                        { type: "choice", instruction: "Um welchen Argumenttyp handelt es sich?", sentence: "\"Als ich selbst ein Praktikum gemacht habe, habe ich mehr gelernt als in der Schule.\"", options: ["Faktenargument", "Autorit√§tsargument", "Erfahrungsargument", "Normatives Argument"], correctIndex: 2, tense: "Argumenttypen" },
                        { type: "choice", instruction: "Um welchen Argumenttyp handelt es sich?", sentence: "\"So wie ein Sportler regelm√§√üig trainieren muss, brauchen auch Sch√ºler √úbung durch Hausaufgaben.\"", options: ["Faktenargument", "Normatives Argument", "Erfahrungsargument", "Analogie-Argument"], correctIndex: 3, tense: "Argumenttypen" },
                        { type: "choice", instruction: "Um welchen Argumenttyp handelt es sich?", sentence: "\"Es geh√∂rt zur Chancengleichheit, dass alle Sch√ºler dieselben M√∂glichkeiten bekommen.\"", options: ["Faktenargument", "Analogie-Argument", "Erfahrungsargument", "Normatives Argument"], correctIndex: 3, tense: "Argumenttypen" },
                        
                        // === GEGENARGUMENTE ERKENNEN ===
                        { type: "choice", instruction: "Welches ist ein GEGENARGUMENT zur These \"Handys sollten in der Schule erlaubt sein\"?", sentence: "", options: [
                            "Mit Handys kann man schnell recherchieren.",
                            "Handys lenken vom Unterricht ab und f√∂rdern Cybermobbing.",
                            "Viele Sch√ºler haben ein Handy.",
                            "Handys sind n√ºtzlich."
                        ], correctIndex: 1, tense: "Gegenargumente" },
                        { type: "choice", instruction: "Welches ist ein GEGENARGUMENT zur These \"Schuluniformen sollten eingef√ºhrt werden\"?", sentence: "", options: [
                            "Uniformen verhindern Mobbing wegen Kleidung.",
                            "Alle sehen gleich aus.",
                            "Uniformen schr√§nken die individuelle Entfaltung und freie Pers√∂nlichkeitsentwicklung ein.",
                            "Uniformen sind praktisch."
                        ], correctIndex: 2, tense: "Gegenargumente" },
                        { type: "choice", instruction: "Was macht ein Gegenargument in deiner eigenen Argumentation?", sentence: "", options: [
                            "Es schw√§cht deine Position.",
                            "Es zeigt, dass du auch die andere Seite kennst und ernst nimmst.",
                            "Es verwirrt den Leser.",
                            "Es ist √ºberfl√ºssig."
                        ], correctIndex: 1, tense: "Gegenargumente" },
                        
                        // === ENTKR√ÑFTUNG ===
                        { type: "choice", instruction: "Welche Formulierung leitet eine ENTKR√ÑFTUNG ein?", sentence: "", options: ["Erstens...", "Zum Beispiel...", "Zwar stimmt es, dass... jedoch...", "Ich finde..."], correctIndex: 2, tense: "Entkr√§ftung" },
                        { type: "choice", instruction: "Wie entkr√§ftet man das Gegenargument \"Schuluniformen sind teuer\" am besten?", sentence: "", options: [
                            "Das stimmt nicht.",
                            "Zwar kosten Uniformen Geld, jedoch spart man langfristig, weil keine teure Markenkleidung n√∂tig ist.",
                            "Geld ist nicht wichtig.",
                            "Andere L√§nder haben auch Uniformen."
                        ], correctIndex: 1, tense: "Entkr√§ftung" },
                        { type: "choice", instruction: "Welche Entkr√§ftung ist am √ºberzeugendsten?", sentence: "Gegenargument: \"Vegetarische Ern√§hrung f√ºhrt zu N√§hrstoffmangel.\"", options: [
                            "Das ist falsch.",
                            "Fleisch ist auch nicht gesund.",
                            "Es stimmt, dass man auf die N√§hrstoffe achten muss. Allerdings zeigen Studien, dass eine ausgewogene vegetarische Ern√§hrung alle N√§hrstoffe liefern kann.",
                            "Vegetarier leben l√§nger."
                        ], correctIndex: 2, tense: "Entkr√§ftung" },
                        
                        // === ARGUMENTATIONSFEHLER ===
                        { type: "choice", instruction: "Welcher Argumentationsfehler liegt vor?", sentence: "\"Deine Meinung zu Hausaufgaben ist falsch, weil du sowieso immer schlechte Noten hast.\"", options: ["Strohmann-Argument", "Ad-hominem-Angriff", "Falsche Verallgemeinerung", "Scheinkausalit√§t"], correctIndex: 1, tense: "Fehler" },
                        { type: "choice", instruction: "Welcher Argumentationsfehler liegt vor?", sentence: "\"Mein Cousin hat geraucht und ist 90 geworden. Also ist Rauchen nicht sch√§dlich.\"", options: ["Ad-hominem-Angriff", "Strohmann-Argument", "Falsche Verallgemeinerung", "Emotionalisierung"], correctIndex: 2, tense: "Fehler" },
                        { type: "choice", instruction: "Welcher Argumentationsfehler liegt vor?", sentence: "\"Seitdem wir einen neuen Schulleiter haben, sind die Noten schlechter. Der Schulleiter ist schuld.\"", options: ["Ad-hominem-Angriff", "Scheinkausalit√§t", "Strohmann-Argument", "Falsche Verallgemeinerung"], correctIndex: 1, tense: "Fehler" },
                        { type: "choice", instruction: "Welcher Argumentationsfehler liegt vor?", sentence: "\"Du willst also, dass Kinder den ganzen Tag nur am Handy h√§ngen!\" (Antwort auf: Handys im Unterricht erlauben)", options: ["Scheinkausalit√§t", "Falsche Verallgemeinerung", "Strohmann-Argument", "Emotionalisierung"], correctIndex: 2, tense: "Fehler" },
                        { type: "choice", instruction: "Was ist ein Ad-hominem-Angriff?", sentence: "", options: [
                            "Man greift die Person an statt das Argument.",
                            "Man √ºbertreibt das gegnerische Argument.",
                            "Man behauptet einen falschen Zusammenhang.",
                            "Man verallgemeinert zu stark."
                        ], correctIndex: 0, tense: "Fehler" },
                        
                        // === ARGUMENTST√ÑRKE BEWERTEN ===
                        { type: "choice", instruction: "Welches Argument ist am ST√ÑRKSTEN?", sentence: "Thema: Mehr Sportunterricht", options: [
                            "Sport macht Spa√ü.",
                            "Laut WHO bewegen sich 80% der Jugendlichen zu wenig, was zu Gesundheitsproblemen f√ºhrt.",
                            "Mein Sportlehrer findet das auch gut.",
                            "In anderen L√§ndern gibt es mehr Sport."
                        ], correctIndex: 1, tense: "Bewertung" },
                        { type: "choice", instruction: "Warum ist ein Faktenargument oft st√§rker als ein Erfahrungsargument?", sentence: "", options: [
                            "Weil es l√§nger ist.",
                            "Weil pers√∂nliche Erfahrungen immer falsch sind.",
                            "Weil Fakten objektiv √ºberpr√ºfbar sind und f√ºr viele gelten.",
                            "Weil Fakten immer stimmen."
                        ], correctIndex: 2, tense: "Bewertung" },
                        { type: "choice", instruction: "In welcher Reihenfolge sollte man Argumente anordnen?", sentence: "", options: [
                            "Zuf√§llig",
                            "Vom schw√§chsten zum st√§rksten (Steigerung) oder umgekehrt",
                            "Alphabetisch",
                            "Die Reihenfolge ist egal"
                        ], correctIndex: 1, tense: "Bewertung" },
                        
                        // === AUFBAU / SANDUHR-PRINZIP ===
                        { type: "fillblank", instruction: "Erg√§nze das Sanduhr-Prinzip:", sentence: "Einleitung ‚Üí These ‚Üí Argumente ‚Üí _____ ‚Üí Entkr√§ftung ‚Üí Schluss", answer: "Gegenargument", alternativeAnswers: ["Gegenargumente", "Einwand"], tense: "Aufbau" },
                        { type: "choice", instruction: "Warum sollte man Gegenargumente in seiner eigenen Argumentation erw√§hnen?", sentence: "", options: [
                            "Um den Text l√§nger zu machen.",
                            "Um zu zeigen, dass man beide Seiten kennt und trotzdem √ºberzeugt ist.",
                            "Weil es Pflicht ist.",
                            "Um den Leser zu verwirren."
                        ], correctIndex: 1, tense: "Aufbau" },
                        { type: "choice", instruction: "Was geh√∂rt in den SCHLUSS einer Argumentation?", sentence: "", options: [
                            "Neue Argumente",
                            "Ein Witz",
                            "Zusammenfassung und/oder Appell",
                            "Das Gegenargument"
                        ], correctIndex: 2, tense: "Aufbau" },
                        
                        // === FORMULIERUNGEN ===
                        { type: "fillblank", instruction: "Welches Wort fehlt?", sentence: "_____ wenden Kritiker ein, dass Hausaufgaben wichtig f√ºr die √úbung sind.", answer: "Zwar", alternativeAnswers: ["Nat√ºrlich", "Sicherlich"], tense: "Formulierung" },
                        { type: "fillblank", instruction: "Welches Wort fehlt?", sentence: "Zwar gibt es Gegenargumente, _____ √ºberwiegen die Vorteile deutlich.", answer: "jedoch", alternativeAnswers: ["allerdings", "dennoch", "aber"], tense: "Formulierung" },
                        { type: "fillblank", instruction: "Welches Wort fehlt?", sentence: "_____ kommt noch hinzu, dass auch die Eltern entlastet werden.", answer: "Au√üerdem", alternativeAnswers: ["Dar√ºber hinaus", "Hinzu", "Zus√§tzlich"], tense: "Formulierung" },
                        { type: "choice", instruction: "Welche Formulierung eignet sich f√ºr den SCHLUSS?", sentence: "", options: ["Erstens...", "Zusammenfassend l√§sst sich sagen...", "Ein Beispiel w√§re...", "Kritiker meinen..."], correctIndex: 1, tense: "Formulierung" },
                        
                        // === KOMPLEXE ANWENDUNG ===
                        { type: "choice", instruction: "Welche Argumentation ist am √ºberzeugendsten aufgebaut?", sentence: "Thema: L√§ngere Pausen in der Schule", options: [
                            "Pausen sind toll. Ich mag Pausen. Mehr Pausen w√§ren gut.",
                            "Ich bin f√ºr l√§ngere Pausen, weil Sch√ºler sich erholen m√ºssen. Mein Freund ist immer m√ºde.",
                            "L√§ngere Pausen f√∂rdern die Konzentration, da das Gehirn Erholung braucht. Studien zeigen: Nach 45 Min. sinkt die Aufmerksamkeit. Zwar k√∂nnte man einwenden, dass dann Unterrichtszeit fehlt, jedoch ist konzentriertes Lernen effektiver als ersch√∂pftes Sitzen.",
                            "Alle Sch√ºler wollen l√§ngere Pausen. Das muss reichen."
                        ], correctIndex: 2, tense: "Anwendung" },
                        { type: "choice", instruction: "Du schreibst eine Argumentation F√úR Ganztagsschulen. Welches Gegenargument solltest du ansprechen und entkr√§ften?", sentence: "", options: [
                            "Ganztagsschulen gibt es in vielen L√§ndern.",
                            "Manche Sch√ºler m√∂gen die Schule nicht.",
                            "Kinder haben weniger Zeit f√ºr Familie, Hobbys und Freunde.",
                            "Lehrer m√ºssen mehr arbeiten."
                        ], correctIndex: 2, tense: "Anwendung" },
                        { type: "choice", instruction: "Wie w√ºrdest du das Gegenargument \"Ganztagsschule l√§sst keine Zeit f√ºr Hobbys\" entkr√§ften?", sentence: "", options: [
                            "Hobbys sind nicht wichtig.",
                            "Das stimmt nicht.",
                            "Ganztagsschulen k√∂nnen AGs und Sportangebote integrieren, sodass Hobbys in der Schule stattfinden k√∂nnen.",
                            "Andere L√§nder machen das auch so."
                        ], correctIndex: 2, tense: "Anwendung" }
                    ]
                }
            ],
            "7-franzoesisch": [
                {
                    id: "vokabeln-grundlagen",
                    name: "Vokabeln Grundlagen",
                    desc: "Begr√º√üung, Vorstellung, Schule und Alltag",
                    icon: "üìñ",
                    questions: 60,
                    hasAudio: true,
                    audioLang: "fr-FR",
                    theory: `<h3>üìñ Franz√∂sisch Grundwortschatz</h3>
                        
                        <h4>Begr√º√üung & Vorstellung</h4>
                        <table><tr><th>Franz√∂sisch</th><th>Deutsch</th></tr>
                        <tr><td>c'est</td><td>das ist</td></tr>
                        <tr><td>l√†</td><td>da, hier</td></tr>
                        <tr><td>merci</td><td>danke</td></tr>
                        <tr><td>coucou</td><td>hi</td></tr>
                        <tr><td>Tu t'appelles comment?</td><td>Wie hei√üt du?</td></tr>
                        <tr><td>Je m'appelle...</td><td>Ich hei√üe...</td></tr>
                        <tr><td>C'est qui?</td><td>Wer ist das?</td></tr>
                        <tr><td>moi, c'est...</td><td>ich bin...</td></tr>
                        <tr><td>Tu es d'o√π?</td><td>Woher kommst du?</td></tr></table>
                        
                        <h4>Personen</h4>
                        <table><tr><th>Franz√∂sisch</th><th>Deutsch</th></tr>
                        <tr><td>la fille</td><td>das M√§dchen</td></tr>
                        <tr><td>le gar√ßon</td><td>der Junge</td></tr>
                        <tr><td>l'ami (m) / l'amie (f)</td><td>der Freund / die Freundin</td></tr>
                        <tr><td>c'est nous</td><td>das sind wir</td></tr>
                        <tr><td>c'est moi</td><td>das bin ich</td></tr></table>
                        
                        <h4>Schule & AGs</h4>
                        <table><tr><th>Franz√∂sisch</th><th>Deutsch</th></tr>
                        <tr><td>le club</td><td>die AG</td></tr>
                        <tr><td>la sixi√®me</td><td>die sechste Klasse</td></tr>
                        <tr><td>la cinqui√®me</td><td>die siebte Klasse</td></tr>
                        <tr><td>m√™me classe</td><td>dieselbe Klasse</td></tr>
                        <tr><td>le basket</td><td>Basketball</td></tr>
                        <tr><td>la danse</td><td>der Tanz</td></tr>
                        <tr><td>le drone</td><td>die Drohne</td></tr></table>
                        
                        <h4>N√ºtzliche W√∂rter</h4>
                        <table><tr><th>Franz√∂sisch</th><th>Deutsch</th></tr>
                        <tr><td>aussi</td><td>auch</td></tr>
                        <tr><td>ensemble</td><td>zusammen</td></tr>
                        <tr><td>avec</td><td>mit</td></tr>
                        <tr><td>dans</td><td>in</td></tr>
                        <tr><td>de</td><td>aus, von</td></tr>
                        <tr><td>souvent</td><td>oft</td></tr>
                        <tr><td>ici</td><td>hier</td></tr>
                        <tr><td>depuis</td><td>seit</td></tr>
                        <tr><td>alors</td><td>also</td></tr>
                        <tr><td>d'accord</td><td>okay, einverstanden</td></tr></table>
                        
                        <h4>Ausdr√ºcke</h4>
                        <table><tr><th>Franz√∂sisch</th><th>Deutsch</th></tr>
                        <tr><td>Je ne sais pas</td><td>Ich wei√ü es nicht</td></tr>
                        <tr><td>en retard</td><td>zu sp√§t</td></tr>
                        <tr><td>c'est un peu compliqu√©</td><td>das ist etwas kompliziert</td></tr>
                        <tr><td>sympa</td><td>sympathisch, nett</td></tr>
                        <tr><td>cool</td><td>cool</td></tr></table>`,
                    questionData: [
                        // === FRANZ√ñSISCH ‚Üí DEUTSCH ===
                        // Begr√º√üung & Vorstellung
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "c'est", answer: "das ist", alternativeAnswers: [], tense: "FR‚ÜíDE" },
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "l√†", answer: "da", alternativeAnswers: ["hier", "da, hier"], tense: "FR‚ÜíDE" },
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "merci", answer: "danke", alternativeAnswers: [], tense: "FR‚ÜíDE" },
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "coucou", answer: "hi", alternativeAnswers: ["hallo"], tense: "FR‚ÜíDE" },
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "Tu t'appelles comment?", answer: "Wie hei√üt du?", alternativeAnswers: ["Wie hei√üt du"], tense: "FR‚ÜíDE" },
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "Je m'appelle", answer: "Ich hei√üe", alternativeAnswers: [], tense: "FR‚ÜíDE" },
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "C'est qui?", answer: "Wer ist das?", alternativeAnswers: ["Wer ist das"], tense: "FR‚ÜíDE" },
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "Tu es d'o√π?", answer: "Woher kommst du?", alternativeAnswers: ["Woher kommst du"], tense: "FR‚ÜíDE" },
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "voil√†", answer: "hier ist", alternativeAnswers: ["da ist", "voil√†"], tense: "FR‚ÜíDE" },
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "Comment?", answer: "Wie?", alternativeAnswers: ["Wie"], tense: "FR‚ÜíDE" },
                        
                        // Personen
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "la fille", answer: "das M√§dchen", alternativeAnswers: [], tense: "FR‚ÜíDE" },
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "le gar√ßon", answer: "der Junge", alternativeAnswers: [], tense: "FR‚ÜíDE" },
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "l'ami", answer: "der Freund", alternativeAnswers: [], tense: "FR‚ÜíDE" },
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "l'amie", answer: "die Freundin", alternativeAnswers: [], tense: "FR‚ÜíDE" },
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "c'est nous", answer: "das sind wir", alternativeAnswers: [], tense: "FR‚ÜíDE" },
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "c'est moi", answer: "das bin ich", alternativeAnswers: [], tense: "FR‚ÜíDE" },
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "ce sont", answer: "das sind", alternativeAnswers: [], tense: "FR‚ÜíDE" },
                        
                        // Schule
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "le club", answer: "die AG", alternativeAnswers: ["der Club", "der Klub"], tense: "FR‚ÜíDE" },
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "la sixi√®me", answer: "die sechste Klasse", alternativeAnswers: [], tense: "FR‚ÜíDE" },
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "la cinqui√®me", answer: "die siebte Klasse", alternativeAnswers: [], tense: "FR‚ÜíDE" },
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "m√™me classe", answer: "dieselbe Klasse", alternativeAnswers: ["gleiche Klasse"], tense: "FR‚ÜíDE" },
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "le basket", answer: "Basketball", alternativeAnswers: [], tense: "FR‚ÜíDE" },
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "la danse", answer: "der Tanz", alternativeAnswers: ["Tanz"], tense: "FR‚ÜíDE" },
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "le drone", answer: "die Drohne", alternativeAnswers: [], tense: "FR‚ÜíDE" },
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "la s√©rie", answer: "die Serie", alternativeAnswers: [], tense: "FR‚ÜíDE" },
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "le quartier", answer: "das Viertel", alternativeAnswers: [], tense: "FR‚ÜíDE" },
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "la rue", answer: "die Stra√üe", alternativeAnswers: [], tense: "FR‚ÜíDE" },
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "la Tunisie", answer: "Tunesien", alternativeAnswers: [], tense: "FR‚ÜíDE" },
                        
                        // N√ºtzliche W√∂rter
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "aussi", answer: "auch", alternativeAnswers: [], tense: "FR‚ÜíDE" },
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "ensemble", answer: "zusammen", alternativeAnswers: [], tense: "FR‚ÜíDE" },
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "avec", answer: "mit", alternativeAnswers: [], tense: "FR‚ÜíDE" },
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "dans", answer: "in", alternativeAnswers: [], tense: "FR‚ÜíDE" },
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "de", answer: "aus", alternativeAnswers: ["von"], tense: "FR‚ÜíDE" },
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "souvent", answer: "oft", alternativeAnswers: [], tense: "FR‚ÜíDE" },
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "ici", answer: "hier", alternativeAnswers: [], tense: "FR‚ÜíDE" },
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "depuis", answer: "seit", alternativeAnswers: [], tense: "FR‚ÜíDE" },
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "alors", answer: "also", alternativeAnswers: [], tense: "FR‚ÜíDE" },
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "d'accord", answer: "okay", alternativeAnswers: ["einverstanden", "in Ordnung"], tense: "FR‚ÜíDE" },
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "samedi", answer: "Samstag", alternativeAnswers: [], tense: "FR‚ÜíDE" },
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "cool", answer: "cool", alternativeAnswers: [], tense: "FR‚ÜíDE" },
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "sympa", answer: "sympathisch", alternativeAnswers: ["nett"], tense: "FR‚ÜíDE" },
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "√™tre", answer: "sein", alternativeAnswers: [], tense: "FR‚ÜíDE" },
                        
                        // Ausdr√ºcke
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "Je ne sais pas", answer: "Ich wei√ü es nicht", alternativeAnswers: ["Ich wei√ü nicht"], tense: "FR‚ÜíDE" },
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "en retard", answer: "zu sp√§t", alternativeAnswers: [], tense: "FR‚ÜíDE" },
                        { type: "fillblank", instruction: "√úbersetze ins Deutsche:", sentence: "c'est un peu compliqu√©", answer: "das ist etwas kompliziert", alternativeAnswers: [], tense: "FR‚ÜíDE" },
                        
                        // === DEUTSCH ‚Üí FRANZ√ñSISCH ===
                        { type: "fillblank", instruction: "√úbersetze ins Franz√∂sische:", sentence: "das ist", answer: "c'est", alternativeAnswers: [], tense: "DE‚ÜíFR" },
                        { type: "fillblank", instruction: "√úbersetze ins Franz√∂sische:", sentence: "danke", answer: "merci", alternativeAnswers: [], tense: "DE‚ÜíFR" },
                        { type: "fillblank", instruction: "√úbersetze ins Franz√∂sische:", sentence: "Wie hei√üt du?", answer: "Tu t'appelles comment?", alternativeAnswers: ["Comment tu t'appelles?"], tense: "DE‚ÜíFR" },
                        { type: "fillblank", instruction: "√úbersetze ins Franz√∂sische:", sentence: "Ich hei√üe", answer: "Je m'appelle", alternativeAnswers: [], tense: "DE‚ÜíFR" },
                        { type: "fillblank", instruction: "√úbersetze ins Franz√∂sische:", sentence: "Wer ist das?", answer: "C'est qui?", alternativeAnswers: [], tense: "DE‚ÜíFR" },
                        { type: "fillblank", instruction: "√úbersetze ins Franz√∂sische:", sentence: "Woher kommst du?", answer: "Tu es d'o√π?", alternativeAnswers: ["D'o√π tu es?"], tense: "DE‚ÜíFR" },
                        { type: "fillblank", instruction: "√úbersetze ins Franz√∂sische:", sentence: "das M√§dchen", answer: "la fille", alternativeAnswers: [], tense: "DE‚ÜíFR" },
                        { type: "fillblank", instruction: "√úbersetze ins Franz√∂sische:", sentence: "der Junge", answer: "le gar√ßon", alternativeAnswers: [], tense: "DE‚ÜíFR" },
                        { type: "fillblank", instruction: "√úbersetze ins Franz√∂sische:", sentence: "der Freund", answer: "l'ami", alternativeAnswers: [], tense: "DE‚ÜíFR" },
                        { type: "fillblank", instruction: "√úbersetze ins Franz√∂sische:", sentence: "die Freundin", answer: "l'amie", alternativeAnswers: [], tense: "DE‚ÜíFR" },
                        { type: "fillblank", instruction: "√úbersetze ins Franz√∂sische:", sentence: "die AG", answer: "le club", alternativeAnswers: [], tense: "DE‚ÜíFR" },
                        { type: "fillblank", instruction: "√úbersetze ins Franz√∂sische:", sentence: "die Drohne", answer: "le drone", alternativeAnswers: [], tense: "DE‚ÜíFR" },
                        { type: "fillblank", instruction: "√úbersetze ins Franz√∂sische:", sentence: "zusammen", answer: "ensemble", alternativeAnswers: [], tense: "DE‚ÜíFR" },
                        { type: "fillblank", instruction: "√úbersetze ins Franz√∂sische:", sentence: "mit", answer: "avec", alternativeAnswers: [], tense: "DE‚ÜíFR" },
                        { type: "fillblank", instruction: "√úbersetze ins Franz√∂sische:", sentence: "auch", answer: "aussi", alternativeAnswers: [], tense: "DE‚ÜíFR" },
                        { type: "fillblank", instruction: "√úbersetze ins Franz√∂sische:", sentence: "oft", answer: "souvent", alternativeAnswers: [], tense: "DE‚ÜíFR" },
                        { type: "fillblank", instruction: "√úbersetze ins Franz√∂sische:", sentence: "hier", answer: "ici", alternativeAnswers: [], tense: "DE‚ÜíFR" },
                        { type: "fillblank", instruction: "√úbersetze ins Franz√∂sische:", sentence: "seit", answer: "depuis", alternativeAnswers: [], tense: "DE‚ÜíFR" },
                        { type: "fillblank", instruction: "√úbersetze ins Franz√∂sische:", sentence: "okay", answer: "d'accord", alternativeAnswers: [], tense: "DE‚ÜíFR" },
                        { type: "fillblank", instruction: "√úbersetze ins Franz√∂sische:", sentence: "Ich wei√ü es nicht", answer: "Je ne sais pas", alternativeAnswers: [], tense: "DE‚ÜíFR" },
                        { type: "fillblank", instruction: "√úbersetze ins Franz√∂sische:", sentence: "zu sp√§t", answer: "en retard", alternativeAnswers: [], tense: "DE‚ÜíFR" },
                        { type: "fillblank", instruction: "√úbersetze ins Franz√∂sische:", sentence: "die Stra√üe", answer: "la rue", alternativeAnswers: [], tense: "DE‚ÜíFR" },
                        { type: "fillblank", instruction: "√úbersetze ins Franz√∂sische:", sentence: "das Viertel", answer: "le quartier", alternativeAnswers: [], tense: "DE‚ÜíFR" },
                        { type: "fillblank", instruction: "√úbersetze ins Franz√∂sische:", sentence: "sein (Verb)", answer: "√™tre", alternativeAnswers: [], tense: "DE‚ÜíFR" },
                        { type: "fillblank", instruction: "√úbersetze ins Franz√∂sische:", sentence: "hi", answer: "coucou", alternativeAnswers: ["salut"], tense: "DE‚ÜíFR" },
                        { type: "fillblank", instruction: "√úbersetze ins Franz√∂sische:", sentence: "das bin ich", answer: "c'est moi", alternativeAnswers: [], tense: "DE‚ÜíFR" },
                        { type: "fillblank", instruction: "√úbersetze ins Franz√∂sische:", sentence: "das sind wir", answer: "c'est nous", alternativeAnswers: [], tense: "DE‚ÜíFR" }
                    ]
                }
            ],
            "7-geschichte": [{ id: "coming-soon", name: "In Arbeit...", desc: "Neue Themen werden bald hinzugef√ºgt", icon: "üöß", questions: 0, comingSoon: true }],
            "7-biologie": [{ id: "coming-soon", name: "In Arbeit...", desc: "Neue Themen werden bald hinzugef√ºgt", icon: "üöß", questions: 0, comingSoon: true }],
            "7-physik": [{ id: "coming-soon", name: "In Arbeit...", desc: "Neue Themen werden bald hinzugef√ºgt", icon: "üöß", questions: 0, comingSoon: true }],
            "7-chemie": [{ id: "coming-soon", name: "In Arbeit...", desc: "Neue Themen werden bald hinzugef√ºgt", icon: "üöß", questions: 0, comingSoon: true }],

            // ==================== KLASSE 9 ====================
            "9-englisch": [
                {
                    id: "australia",
                    name: "Australia",
                    desc: "Landeskunde, Geschichte und Kultur Australiens",
                    icon: "ü¶ò",
                    questions: 18,
                    hasAudio: true,
                    audioLang: "en-AU",
                    theory: `<h3>üá¶üá∫ Australia - Facts & Figures</h3>
                        <div class="rule-box"><strong>Basic Facts:</strong><br>
                        ‚Ä¢ Capital: Canberra<br>‚Ä¢ Largest city: Sydney<br>‚Ä¢ Population: ~26 million<br>‚Ä¢ Area: 7.7 million km¬≤ (6th largest country)</div>
                        <h4>Geography</h4>
                        <p>Australia is both a country and a continent. It's surrounded by the Pacific and Indian Oceans. The interior (Outback) is mostly desert.</p>
                        <h4>Indigenous Culture</h4>
                        <p>Aboriginal Australians have lived there for over 65,000 years - one of the oldest continuous cultures on Earth.</p>
                        <h4>Famous Landmarks</h4>
                        <p>Sydney Opera House, Uluru (Ayers Rock), Great Barrier Reef, Harbour Bridge</p>
                        <h4>Wildlife</h4>
                        <p>Unique animals: Kangaroo, Koala, Platypus, Wombat, Emu, many dangerous snakes and spiders</p>`,
                    questionData: [
                        { type: "choice", instruction: "What is the capital of Australia?", sentence: "", options: ["Sydney", "Melbourne", "Canberra", "Brisbane"], correctIndex: 2, tense: "Geography" },
                        { type: "choice", instruction: "What is the largest city in Australia?", sentence: "", options: ["Melbourne", "Sydney", "Perth", "Adelaide"], correctIndex: 1, tense: "Geography" },
                        { type: "fillblank", instruction: "Complete the sentence:", sentence: "Australia is both a country and a _____.", answer: "continent", alternativeAnswers: [], tense: "Geography" },
                        { type: "choice", instruction: "How long have Aboriginal Australians lived in Australia?", sentence: "", options: ["About 10,000 years", "About 25,000 years", "Over 65,000 years", "About 5,000 years"], correctIndex: 2, tense: "History" },
                        { type: "fillblank", instruction: "Complete:", sentence: "The famous rock in central Australia is called _____ or Ayers Rock.", answer: "Uluru", alternativeAnswers: [], tense: "Landmarks" },
                        { type: "choice", instruction: "Which ocean is NOT next to Australia?", sentence: "", options: ["Pacific Ocean", "Indian Ocean", "Atlantic Ocean", "Southern Ocean"], correctIndex: 2, tense: "Geography" },
                        { type: "fillblank", instruction: "Complete:", sentence: "The _____ Barrier Reef is the world's largest coral reef system.", answer: "Great", alternativeAnswers: [], tense: "Nature" },
                        { type: "choice", instruction: "Which animal is NOT native to Australia?", sentence: "", options: ["Kangaroo", "Koala", "Tiger", "Platypus"], correctIndex: 2, tense: "Wildlife" },
                        { type: "fillblank", instruction: "Complete:", sentence: "The dry interior of Australia is called the _____.", answer: "Outback", alternativeAnswers: [], tense: "Geography" },
                        { type: "choice", instruction: "Which famous building is in Sydney?", sentence: "", options: ["Big Ben", "Eiffel Tower", "Opera House", "Colosseum"], correctIndex: 2, tense: "Landmarks" },
                        { type: "fillblank", instruction: "Complete:", sentence: "Australia's population is approximately _____ million people.", answer: "26", alternativeAnswers: ["25", "27"], tense: "Facts" },
                        { type: "choice", instruction: "What is a 'koala'?", sentence: "", options: ["A type of bear", "A marsupial", "A reptile", "A bird"], correctIndex: 1, tense: "Wildlife" },
                        { type: "fillblank", instruction: "Complete:", sentence: "The Sydney Harbour _____ is a famous steel arch bridge.", answer: "Bridge", alternativeAnswers: [], tense: "Landmarks" },
                        { type: "choice", instruction: "When is summer in Australia?", sentence: "", options: ["June to August", "March to May", "December to February", "September to November"], correctIndex: 2, tense: "Climate" },
                        { type: "fillblank", instruction: "Complete:", sentence: "A baby kangaroo is called a _____.", answer: "joey", alternativeAnswers: [], tense: "Wildlife" },
                        { type: "choice", instruction: "What language is spoken in Australia?", sentence: "", options: ["Australian", "British", "English", "American"], correctIndex: 2, tense: "Culture" },
                        { type: "fillblank", instruction: "Complete:", sentence: "Australia is the _____ largest country in the world by area.", answer: "sixth", alternativeAnswers: ["6th"], tense: "Facts" },
                        { type: "choice", instruction: "What is the 'Outback'?", sentence: "", options: ["A city", "The coastal area", "The remote interior", "A mountain range"], correctIndex: 2, tense: "Geography" }
                    ]
                }
            ],
            "9-mathe": [
                {
                    id: "gleichungen-variablen",
                    name: "Gleichungen mit Variablen",
                    desc: "Lineare Gleichungen l√∂sen und umformen",
                    icon: "üî¢",
                    questions: 18,
                    hasAudio: false,
                    theory: `<h3>üìö Gleichungen mit Variablen</h3>
                        <div class="rule-box"><strong>Grundprinzip:</strong> Eine Gleichung ist wie eine Waage - was du auf einer Seite tust, musst du auch auf der anderen tun!</div>
                        <h4>√Ñquivalenzumformungen</h4>
                        <table><tr><th>Umformung</th><th>Beispiel</th></tr>
                        <tr><td>Beide Seiten + Zahl</td><td>x - 5 = 3 ‚Üí x = 8</td></tr>
                        <tr><td>Beide Seiten - Zahl</td><td>x + 7 = 12 ‚Üí x = 5</td></tr>
                        <tr><td>Beide Seiten ¬∑ Zahl</td><td>x/4 = 3 ‚Üí x = 12</td></tr>
                        <tr><td>Beide Seiten : Zahl</td><td>3x = 15 ‚Üí x = 5</td></tr></table>
                        <h4>Gleichungen mit Klammern</h4>
                        <div class="example-box">2(x + 3) = 14<br>2x + 6 = 14<br>2x = 8<br>x = 4</div>
                        <h4>Gleichungen mit x auf beiden Seiten</h4>
                        <div class="example-box">5x + 2 = 3x + 10<br>2x + 2 = 10<br>2x = 8<br>x = 4</div>`,
                    questionData: [
                        { type: "fillblank", instruction: "L√∂se die Gleichung:", sentence: "x + 7 = 15 ‚Üí x = _____", answer: "8", alternativeAnswers: [], tense: "Einfach" },
                        { type: "fillblank", instruction: "L√∂se die Gleichung:", sentence: "x - 4 = 9 ‚Üí x = _____", answer: "13", alternativeAnswers: [], tense: "Einfach" },
                        { type: "fillblank", instruction: "L√∂se die Gleichung:", sentence: "3x = 21 ‚Üí x = _____", answer: "7", alternativeAnswers: [], tense: "Einfach" },
                        { type: "fillblank", instruction: "L√∂se die Gleichung:", sentence: "x/5 = 4 ‚Üí x = _____", answer: "20", alternativeAnswers: [], tense: "Einfach" },
                        { type: "fillblank", instruction: "L√∂se die Gleichung:", sentence: "2x + 5 = 17 ‚Üí x = _____", answer: "6", alternativeAnswers: [], tense: "Mittel" },
                        { type: "fillblank", instruction: "L√∂se die Gleichung:", sentence: "4x - 3 = 25 ‚Üí x = _____", answer: "7", alternativeAnswers: [], tense: "Mittel" },
                        { type: "fillblank", instruction: "L√∂se die Gleichung:", sentence: "5x + 8 = 3x + 20 ‚Üí x = _____", answer: "6", alternativeAnswers: [], tense: "Beidseitig" },
                        { type: "fillblank", instruction: "L√∂se die Gleichung:", sentence: "7x - 4 = 4x + 11 ‚Üí x = _____", answer: "5", alternativeAnswers: [], tense: "Beidseitig" },
                        { type: "fillblank", instruction: "L√∂se die Gleichung mit Klammer:", sentence: "2(x + 4) = 18 ‚Üí x = _____", answer: "5", alternativeAnswers: [], tense: "Klammern" },
                        { type: "fillblank", instruction: "L√∂se die Gleichung mit Klammer:", sentence: "3(x - 2) = 15 ‚Üí x = _____", answer: "7", alternativeAnswers: [], tense: "Klammern" },
                        { type: "choice", instruction: "Welcher erste Schritt ist richtig f√ºr: 2x + 8 = 20?", sentence: "", options: ["x 2 teilen", "8 subtrahieren", "20 addieren", "Klammer aufl√∂sen"], correctIndex: 1, tense: "Strategie" },
                        { type: "fillblank", instruction: "L√∂se:", sentence: "4(x + 1) = 2(x + 7) ‚Üí x = _____", answer: "5", alternativeAnswers: [], tense: "Schwer" },
                        { type: "fillblank", instruction: "L√∂se:", sentence: "-2x + 10 = 4 ‚Üí x = _____", answer: "3", alternativeAnswers: [], tense: "Negativ" },
                        { type: "choice", instruction: "Was ist die L√∂sung von 5x = 0?", sentence: "", options: ["x = 5", "x = 0", "x = -5", "Keine L√∂sung"], correctIndex: 1, tense: "Sonderfall" },
                        { type: "fillblank", instruction: "L√∂se:", sentence: "x/2 + 3 = 7 ‚Üí x = _____", answer: "8", alternativeAnswers: [], tense: "Br√ºche" },
                        { type: "fillblank", instruction: "L√∂se:", sentence: "6x - 2 = 4x + 6 ‚Üí x = _____", answer: "4", alternativeAnswers: [], tense: "Beidseitig" },
                        { type: "choice", instruction: "Welche Gleichung hat x = 3 als L√∂sung?", sentence: "", options: ["2x + 1 = 5", "x + 5 = 9", "4x = 12", "x - 3 = 3"], correctIndex: 2, tense: "Probe" },
                        { type: "fillblank", instruction: "L√∂se:", sentence: "5(x - 1) - 2x = 10 ‚Üí x = _____", answer: "5", alternativeAnswers: [], tense: "Schwer" }
                    ]
                },
                {
                    id: "funktionen",
                    name: "Lineare & Quadratische Funktionen",
                    desc: "Geraden, Parabeln, Scheitelpunktform, Verschiebungen",
                    icon: "üìà",
                    questions: 35,
                    hasAudio: false,
                    theory: `<h3>üìà Lineare und Quadratische Funktionen</h3>
                        
                        <h4>1. Lineare Funktionen</h4>
                        <div class="rule-box">
                        <strong>Allgemeine Form:</strong> <code>f(x) = mx + n</code><br><br>
                        ‚Ä¢ <strong>m</strong> = Steigung (wie steil ist die Gerade?)<br>
                        ‚Ä¢ <strong>n</strong> = y-Achsenabschnitt (wo schneidet die Gerade die y-Achse?)<br><br>
                        <strong>Steigung berechnen:</strong> <code>m = Œîy / Œîx</code> (Steigungsdreieck)
                        </div>
                        
                        <div class="example-box">
                        <strong>Beispiel:</strong> f(x) = 2x + 3<br>
                        ‚Ä¢ Steigung m = 2 (Graph steigt)<br>
                        ‚Ä¢ y-Achsenabschnitt n = 3 (schneidet y-Achse bei 3)<br>
                        ‚Ä¢ Nullstelle: 0 = 2x + 3 ‚Üí x = -1,5
                        </div>
                        
                        <h4>2. Die Normalparabel</h4>
                        <div class="rule-box">
                        <strong>Gleichung:</strong> <code>f(x) = x¬≤</code><br><br>
                        <strong>Eigenschaften:</strong><br>
                        ‚Ä¢ Scheitelpunkt S(0|0)<br>
                        ‚Ä¢ Symmetrieachse: y-Achse<br>
                        ‚Ä¢ Nach oben ge√∂ffnet<br>
                        ‚Ä¢ F√ºr x < 0: Graph f√§llt | F√ºr x > 0: Graph steigt<br>
                        ‚Ä¢ Definitionsmenge: D = ‚Ñù | Wertemenge: W = ‚Ñù‚ÇÄ‚Å∫
                        </div>
                        
                        <h4>3. Streckung und Stauchung</h4>
                        <div class="rule-box">
                        <strong>Form:</strong> <code>f(x) = ax¬≤</code><br><br>
                        ‚Ä¢ |a| > 1: Parabel ist <strong>gestreckt</strong> (schmaler)<br>
                        ‚Ä¢ |a| < 1: Parabel ist <strong>gestaucht</strong> (breiter)<br>
                        ‚Ä¢ a < 0: Parabel ist nach <strong>unten ge√∂ffnet</strong> (gespiegelt)
                        </div>
                        
                        <h4>4. Verschiebung</h4>
                        <table><tr><th>Form</th><th>Verschiebung</th><th>Scheitelpunkt</th></tr>
                        <tr><td>f(x) = x¬≤ + c</td><td>c Einheiten in y-Richtung</td><td>S(0|c)</td></tr>
                        <tr><td>f(x) = (x - d)¬≤</td><td>d Einheiten in x-Richtung</td><td>S(d|0)</td></tr>
                        <tr><td>f(x) = (x - d)¬≤ + c</td><td>Beide Richtungen</td><td>S(d|c)</td></tr></table>
                        
                        <h4>5. Scheitelpunktform</h4>
                        <div class="rule-box">
                        <strong>Allgemeine Scheitelpunktform:</strong><br>
                        <code>f(x) = a(x - x‚Çõ)¬≤ + y‚Çõ</code><br><br>
                        Der Scheitelpunkt hat die Koordinaten <strong>S(x‚Çõ|y‚Çõ)</strong>
                        </div>
                        
                        <h4>6. Normalform</h4>
                        <div class="example-box">
                        <strong>Normalform:</strong> <code>f(x) = ax¬≤ + bx + c</code><br><br>
                        Umwandlung Scheitelpunktform ‚Üí Normalform:<br>
                        f(x) = (x - 4)¬≤ + 3<br>
                        = x¬≤ - 8x + 16 + 3<br>
                        = x¬≤ - 8x + 19
                        </div>`,
                    questionData: [
                        // === LINEARE FUNKTIONEN: Grundlagen ===
                        { type: "fillblank", instruction: "Wie lautet die allgemeine Form einer linearen Funktion?", sentence: "f(x) = _____ + n", answer: "mx", alternativeAnswers: ["m¬∑x", "m*x"], tense: "Grundlagen" },
                        { type: "choice", instruction: "Was gibt der Parameter 'm' in f(x) = mx + n an?", sentence: "", options: ["Den y-Achsenabschnitt", "Die Steigung", "Die Nullstelle", "Den Scheitelpunkt"], correctIndex: 1, tense: "Grundlagen" },
                        { type: "choice", instruction: "Was gibt der Parameter 'n' in f(x) = mx + n an?", sentence: "", options: ["Die Steigung", "Die Nullstelle", "Den y-Achsenabschnitt", "Die x-Koordinate"], correctIndex: 2, tense: "Grundlagen" },
                        { type: "fillblank", instruction: "Bei f(x) = 3x + 5: Wie gro√ü ist die Steigung?", sentence: "m = _____", answer: "3", alternativeAnswers: [], tense: "Ablesen" },
                        { type: "fillblank", instruction: "Bei f(x) = 3x + 5: Wie gro√ü ist der y-Achsenabschnitt?", sentence: "n = _____", answer: "5", alternativeAnswers: [], tense: "Ablesen" },
                        { type: "fillblank", instruction: "Bei f(x) = -2x + 4: Wie gro√ü ist die Steigung?", sentence: "m = _____", answer: "-2", alternativeAnswers: [], tense: "Ablesen" },
                        { type: "choice", instruction: "Die Gerade f(x) = -2x + 4...", sentence: "", options: ["steigt", "f√§llt", "ist horizontal", "ist vertikal"], correctIndex: 1, tense: "Interpretation" },
                        
                        // === LINEARE FUNKTIONEN: Steigungsdreieck ===
                        { type: "fillblank", instruction: "Die Steigung berechnet man mit dem Steigungsdreieck:", sentence: "m = Œîy / _____", answer: "Œîx", alternativeAnswers: ["delta x"], tense: "Steigung" },
                        { type: "fillblank", instruction: "Eine Gerade geht durch P(0|2) und Q(2|6). Berechne die Steigung:", sentence: "m = (6-2)/(2-0) = 4/2 = _____", answer: "2", alternativeAnswers: [], tense: "Steigung" },
                        
                        // === LINEARE FUNKTIONEN: Nullstellen ===
                        { type: "choice", instruction: "Was ist eine Nullstelle?", sentence: "", options: ["Wo die Gerade die y-Achse schneidet", "Wo die Gerade die x-Achse schneidet", "Wo die Steigung 0 ist", "Der h√∂chste Punkt"], correctIndex: 1, tense: "Nullstellen" },
                        { type: "fillblank", instruction: "Berechne die Nullstelle von f(x) = 2x + 6:", sentence: "0 = 2x + 6 ‚Üí x = _____", answer: "-3", alternativeAnswers: [], tense: "Nullstellen" },
                        { type: "fillblank", instruction: "Berechne die Nullstelle von f(x) = 3x - 9:", sentence: "0 = 3x - 9 ‚Üí x = _____", answer: "3", alternativeAnswers: [], tense: "Nullstellen" },
                        
                        // === NORMALPARABEL ===
                        { type: "fillblank", instruction: "Die Gleichung der Normalparabel lautet:", sentence: "f(x) = _____", answer: "x¬≤", alternativeAnswers: ["x^2", "x hoch 2"], tense: "Normalparabel" },
                        { type: "fillblank", instruction: "Der Scheitelpunkt der Normalparabel f(x) = x¬≤ ist:", sentence: "S( _____ | _____ )", answer: "0|0", alternativeAnswers: ["0, 0", "0;0"], tense: "Normalparabel" },
                        { type: "choice", instruction: "Die Symmetrieachse der Normalparabel ist...", sentence: "", options: ["die x-Achse", "die y-Achse", "die Gerade y = x", "keine"], correctIndex: 1, tense: "Normalparabel" },
                        { type: "choice", instruction: "Die Normalparabel ist...", sentence: "", options: ["nach unten ge√∂ffnet", "nach oben ge√∂ffnet", "nach links ge√∂ffnet", "nach rechts ge√∂ffnet"], correctIndex: 1, tense: "Normalparabel" },
                        
                        // === STRECKUNG UND STAUCHUNG ===
                        { type: "choice", instruction: "f(x) = 2x¬≤ ist im Vergleich zur Normalparabel...", sentence: "", options: ["gestaucht (breiter)", "gestreckt (schmaler)", "nach unten ge√∂ffnet", "unver√§ndert"], correctIndex: 1, tense: "Streckung" },
                        { type: "choice", instruction: "f(x) = ¬Ωx¬≤ ist im Vergleich zur Normalparabel...", sentence: "", options: ["gestreckt (schmaler)", "gestaucht (breiter)", "nach unten ge√∂ffnet", "unver√§ndert"], correctIndex: 1, tense: "Streckung" },
                        { type: "choice", instruction: "f(x) = -x¬≤ ist im Vergleich zur Normalparabel...", sentence: "", options: ["gestreckt", "gestaucht", "an der x-Achse gespiegelt (nach unten ge√∂ffnet)", "verschoben"], correctIndex: 2, tense: "Spiegelung" },
                        { type: "choice", instruction: "Wenn a < 0, dann ist die Parabel...", sentence: "", options: ["nach oben ge√∂ffnet", "nach unten ge√∂ffnet", "gestreckt", "gestaucht"], correctIndex: 1, tense: "Spiegelung" },
                        { type: "fillblank", instruction: "Bei f(x) = -4x¬≤ + 6: In welche Richtung ist die Parabel ge√∂ffnet?", sentence: "Nach _____", answer: "unten", alternativeAnswers: [], tense: "Spiegelung" },
                        
                        // === VERSCHIEBUNG IN Y-RICHTUNG ===
                        { type: "fillblank", instruction: "f(x) = x¬≤ + 3 ist gegen√ºber der Normalparabel verschoben um:", sentence: "_____ Einheiten nach oben", answer: "3", alternativeAnswers: [], tense: "Verschiebung" },
                        { type: "fillblank", instruction: "f(x) = x¬≤ - 5 hat den Scheitelpunkt:", sentence: "S(0| _____ )", answer: "-5", alternativeAnswers: [], tense: "Verschiebung" },
                        { type: "fillblank", instruction: "f(x) = x¬≤ + 4 hat den Scheitelpunkt:", sentence: "S( _____ | _____ )", answer: "0|4", alternativeAnswers: ["0, 4", "0;4"], tense: "Verschiebung" },
                        
                        // === VERSCHIEBUNG IN X-RICHTUNG ===
                        { type: "fillblank", instruction: "f(x) = (x - 3)¬≤ hat den Scheitelpunkt:", sentence: "S( _____ |0)", answer: "3", alternativeAnswers: [], tense: "Verschiebung" },
                        { type: "fillblank", instruction: "f(x) = (x + 2)¬≤ hat den Scheitelpunkt:", sentence: "S( _____ |0)", answer: "-2", alternativeAnswers: [], tense: "Verschiebung" },
                        { type: "choice", instruction: "f(x) = (x - 4)¬≤ ist gegen√ºber f(x) = x¬≤ verschoben um...", sentence: "", options: ["4 nach links", "4 nach rechts", "4 nach oben", "4 nach unten"], correctIndex: 1, tense: "Verschiebung" },
                        { type: "choice", instruction: "f(x) = (x + 6)¬≤ ist gegen√ºber f(x) = x¬≤ verschoben um...", sentence: "", options: ["6 nach rechts", "6 nach links", "6 nach oben", "6 nach unten"], correctIndex: 1, tense: "Verschiebung" },
                        
                        // === SCHEITELPUNKTFORM ===
                        { type: "fillblank", instruction: "Die allgemeine Scheitelpunktform lautet:", sentence: "f(x) = a(x - x‚Çõ)¬≤ + _____", answer: "y‚Çõ", alternativeAnswers: ["ys", "y_s"], tense: "Scheitelpunktform" },
                        { type: "fillblank", instruction: "f(x) = (x - 2)¬≤ + 5 hat den Scheitelpunkt:", sentence: "S( _____ | _____ )", answer: "2|5", alternativeAnswers: ["2, 5", "2;5"], tense: "Scheitelpunktform" },
                        { type: "fillblank", instruction: "f(x) = (x + 3)¬≤ - 4 hat den Scheitelpunkt:", sentence: "S( _____ | _____ )", answer: "-3|-4", alternativeAnswers: ["-3, -4", "-3;-4"], tense: "Scheitelpunktform" },
                        { type: "fillblank", instruction: "f(x) = 2(x - 1)¬≤ + 3 hat den Scheitelpunkt:", sentence: "S( _____ | _____ )", answer: "1|3", alternativeAnswers: ["1, 3", "1;3"], tense: "Scheitelpunktform" },
                        { type: "fillblank", instruction: "Eine Parabel hat den Scheitelpunkt S(4|2). Wie lautet die Scheitelpunktform?", sentence: "f(x) = (x - _____)¬≤ + _____", answer: "4)¬≤ + 2", alternativeAnswers: ["4, 2"], tense: "Scheitelpunktform" },
                        
                        // === NORMALFORM ===
                        { type: "fillblank", instruction: "Wandle um: f(x) = (x - 1)¬≤ = x¬≤ - 2x + _____", sentence: "", answer: "1", alternativeAnswers: [], tense: "Normalform" },
                        { type: "fillblank", instruction: "Wandle um: f(x) = (x + 2)¬≤ = x¬≤ + 4x + _____", sentence: "", answer: "4", alternativeAnswers: [], tense: "Normalform" }
                    ]
                },
                {
                    id: "parabeln-zuordnung",
                    name: "Parabeln: Zuordnung & Analyse",
                    desc: "Streckfaktoren ablesen, Graphen zuordnen, Nullstellen bestimmen",
                    icon: "üìä",
                    questions: 30,
                    hasAudio: false,
                    theory: `<h3>üìä Parabeln analysieren und zuordnen</h3>
                        
                        <h4>1. Streckfaktor a am Graphen ablesen</h4>
                        <div class="rule-box">
                        <strong>Methode:</strong> Gehe vom Scheitelpunkt 1 Einheit nach rechts.<br>
                        Der y-Wert an dieser Stelle ist |a|.<br><br>
                        <strong>Beispiel:</strong> Scheitelpunkt bei (2|3), Punkt (3|5) liegt auf der Parabel.<br>
                        ‚Üí Von x=2 zu x=3: Œîx = 1<br>
                        ‚Üí Œîy = 5 - 3 = 2<br>
                        ‚Üí Also: a = 2
                        </div>
                        
                        <div class="example-box">
                        <strong>Streckfaktor erkennen:</strong><br>
                        ‚Ä¢ Normalparabel: Bei x=1 ist y=1 (a=1)<br>
                        ‚Ä¢ f(x) = 2x¬≤: Bei x=1 ist y=2 (a=2) ‚Üí gestreckt<br>
                        ‚Ä¢ f(x) = 0,5x¬≤: Bei x=1 ist y=0,5 (a=0,5) ‚Üí gestaucht
                        </div>
                        
                        <h4>2. √ñffnung erkennen</h4>
                        <div class="rule-box">
                        ‚Ä¢ a > 0: Parabel nach <strong>oben</strong> ge√∂ffnet (Scheitelpunkt = Minimum)<br>
                        ‚Ä¢ a < 0: Parabel nach <strong>unten</strong> ge√∂ffnet (Scheitelpunkt = Maximum)
                        </div>
                        
                        <h4>3. Scheitelpunkt ablesen</h4>
                        <div class="example-box">
                        Der Scheitelpunkt ist der tiefste (a>0) oder h√∂chste (a<0) Punkt der Parabel.<br><br>
                        <strong>Aus der Gleichung:</strong><br>
                        ‚Ä¢ f(x) = (x - 3)¬≤ + 2 ‚Üí S(3|2)<br>
                        ‚Ä¢ f(x) = (x + 1)¬≤ - 4 ‚Üí S(-1|-4)<br>
                        ‚Ä¢ f(x) = x¬≤ + 5 ‚Üí S(0|5)
                        </div>
                        
                        <h4>4. Nullstellen bestimmen</h4>
                        <div class="rule-box">
                        <strong>Nullstellen:</strong> Die x-Werte, wo die Parabel die x-Achse schneidet.<br><br>
                        <strong>M√∂glichkeiten:</strong><br>
                        ‚Ä¢ 2 Nullstellen: Parabel schneidet x-Achse zweimal<br>
                        ‚Ä¢ 1 Nullstelle: Scheitelpunkt liegt auf der x-Achse<br>
                        ‚Ä¢ 0 Nullstellen: Parabel ber√ºhrt x-Achse nicht
                        </div>
                        
                        <h4>5. Von Gleichung zu Graph</h4>
                        <table><tr><th>Gleichung</th><th>Erkennungsmerkmal</th></tr>
                        <tr><td>f(x) = x¬≤ + c</td><td>Verschiebung nur in y-Richtung</td></tr>
                        <tr><td>f(x) = (x - d)¬≤</td><td>Verschiebung nur in x-Richtung</td></tr>
                        <tr><td>f(x) = ax¬≤</td><td>Streckung/Stauchung, S bleibt bei (0|0)</td></tr>
                        <tr><td>f(x) = -x¬≤</td><td>Nach unten ge√∂ffnet</td></tr>
                        <tr><td>f(x) = a(x-d)¬≤ + c</td><td>Alles kombiniert: S(d|c)</td></tr></table>`,
                    questionData: [
                        // === STRECKFAKTOR ABLESEN ===
                        { type: "choice", instruction: "Eine Parabel hat den Scheitelpunkt S(0|0). Bei x=1 ist y=3. Wie gro√ü ist der Streckfaktor a?", sentence: "", options: ["a = 1", "a = 2", "a = 3", "a = 0,5"], correctIndex: 2, tense: "Streckfaktor" },
                        { type: "choice", instruction: "Eine Parabel hat den Scheitelpunkt S(0|0). Bei x=1 ist y=0,5. Wie gro√ü ist der Streckfaktor a?", sentence: "", options: ["a = 2", "a = 1", "a = 0,5", "a = 0,25"], correctIndex: 2, tense: "Streckfaktor" },
                        { type: "choice", instruction: "Eine Parabel hat den Scheitelpunkt S(2|1). Bei x=3 ist y=5. Wie gro√ü ist |a|?", sentence: "", options: ["a = 1", "a = 2", "a = 4", "a = 3"], correctIndex: 2, tense: "Streckfaktor" },
                        { type: "fillblank", instruction: "Bei f(x) = 4x¬≤ ist der y-Wert an der Stelle x = 1:", sentence: "f(1) = _____", answer: "4", alternativeAnswers: [], tense: "Streckfaktor" },
                        { type: "fillblank", instruction: "Bei f(x) = 0,25x¬≤ ist der y-Wert an der Stelle x = 2:", sentence: "f(2) = 0,25 ¬∑ 4 = _____", answer: "1", alternativeAnswers: [], tense: "Streckfaktor" },
                        
                        // === STRECKFAKTOR RECHNERISCH ===
                        { type: "fillblank", instruction: "Der Punkt P(2|12) liegt auf einer Parabel f(x) = ax¬≤ mit S(0|0). Berechne a:", sentence: "12 = a ¬∑ 4 ‚Üí a = _____", answer: "3", alternativeAnswers: [], tense: "Streckfaktor rechnerisch" },
                        { type: "fillblank", instruction: "Der Punkt P(3|18) liegt auf f(x) = ax¬≤. Berechne a:", sentence: "18 = a ¬∑ 9 ‚Üí a = _____", answer: "2", alternativeAnswers: [], tense: "Streckfaktor rechnerisch" },
                        { type: "fillblank", instruction: "Der Punkt P(4|8) liegt auf f(x) = ax¬≤. Berechne a:", sentence: "8 = a ¬∑ 16 ‚Üí a = _____", answer: "0,5", alternativeAnswers: ["1/2", "0.5"], tense: "Streckfaktor rechnerisch" },
                        
                        // === GESTRECKT ODER GESTAUCHT? ===
                        { type: "choice", instruction: "f(x) = 3x¬≤ ist gegen√ºber der Normalparabel...", sentence: "", options: ["gestaucht (breiter)", "gestreckt (schmaler)", "unver√§ndert", "gespiegelt"], correctIndex: 1, tense: "Streckung beschreiben" },
                        { type: "choice", instruction: "f(x) = 0,2x¬≤ ist gegen√ºber der Normalparabel...", sentence: "", options: ["gestreckt (schmaler)", "gestaucht (breiter)", "unver√§ndert", "gespiegelt"], correctIndex: 1, tense: "Streckung beschreiben" },
                        { type: "choice", instruction: "f(x) = -2x¬≤ ist gegen√ºber der Normalparabel...", sentence: "", options: ["nur gestreckt", "nur gespiegelt", "gestreckt und nach unten ge√∂ffnet", "gestaucht und nach unten ge√∂ffnet"], correctIndex: 2, tense: "Streckung beschreiben" },
                        { type: "fillblank", instruction: "Die Parabel f(x) = 5x¬≤ ist gegen√ºber f(x) = x¬≤:", sentence: "_____ (schmaler/breiter)", answer: "schmaler", alternativeAnswers: ["gestreckt"], tense: "Streckung beschreiben" },
                        
                        // === VERSCHIEBUNG IN Y-RICHTUNG ===
                        { type: "fillblank", instruction: "f(x) = x¬≤ + 7: Der Scheitelpunkt liegt bei:", sentence: "S(0| _____ )", answer: "7", alternativeAnswers: [], tense: "y-Verschiebung" },
                        { type: "fillblank", instruction: "f(x) = x¬≤ - 3: Um wie viele Einheiten ist die Parabel verschoben?", sentence: "_____ Einheiten nach unten", answer: "3", alternativeAnswers: [], tense: "y-Verschiebung" },
                        { type: "fillblank", instruction: "Eine Parabel hat S(0|4). Gib die Gleichung an:", sentence: "f(x) = x¬≤ + _____", answer: "4", alternativeAnswers: [], tense: "y-Verschiebung" },
                        
                        // === VERSCHIEBUNG IN X-RICHTUNG ===
                        { type: "fillblank", instruction: "f(x) = (x - 5)¬≤: Der Scheitelpunkt liegt bei:", sentence: "S( _____ |0)", answer: "5", alternativeAnswers: [], tense: "x-Verschiebung" },
                        { type: "fillblank", instruction: "f(x) = (x + 4)¬≤: Der Scheitelpunkt liegt bei:", sentence: "S( _____ |0)", answer: "-4", alternativeAnswers: [], tense: "x-Verschiebung" },
                        { type: "choice", instruction: "f(x) = (x - 2)¬≤ ist gegen√ºber f(x) = x¬≤ verschoben um:", sentence: "", options: ["2 nach links", "2 nach rechts", "2 nach oben", "2 nach unten"], correctIndex: 1, tense: "x-Verschiebung" },
                        { type: "fillblank", instruction: "Eine Parabel hat S(6|0). Gib die Gleichung an:", sentence: "f(x) = (x - _____ )¬≤", answer: "6", alternativeAnswers: [], tense: "x-Verschiebung" },
                        
                        // === SCHEITELPUNKT AUS SCHEITELPUNKTFORM ===
                        { type: "fillblank", instruction: "f(x) = (x - 3)¬≤ + 2 hat den Scheitelpunkt:", sentence: "S( _____ | _____ )", answer: "3|2", alternativeAnswers: ["3, 2", "3;2"], tense: "Scheitelpunkt" },
                        { type: "fillblank", instruction: "f(x) = (x + 1)¬≤ - 5 hat den Scheitelpunkt:", sentence: "S( _____ | _____ )", answer: "-1|-5", alternativeAnswers: ["-1, -5", "-1;-5"], tense: "Scheitelpunkt" },
                        { type: "fillblank", instruction: "f(x) = 2(x - 4)¬≤ + 1 hat den Scheitelpunkt:", sentence: "S( _____ | _____ )", answer: "4|1", alternativeAnswers: ["4, 1", "4;1"], tense: "Scheitelpunkt" },
                        { type: "fillblank", instruction: "f(x) = -3(x + 2)¬≤ - 3 hat den Scheitelpunkt:", sentence: "S( _____ | _____ )", answer: "-2|-3", alternativeAnswers: ["-2, -3", "-2;-3"], tense: "Scheitelpunkt" },
                        
                        // === NULLSTELLEN ERKENNEN ===
                        { type: "choice", instruction: "f(x) = x¬≤ - 4 hat wie viele Nullstellen?", sentence: "", options: ["0", "1", "2", "unendlich viele"], correctIndex: 2, tense: "Nullstellen" },
                        { type: "choice", instruction: "f(x) = x¬≤ + 1 hat wie viele Nullstellen?", sentence: "", options: ["0", "1", "2", "unendlich viele"], correctIndex: 0, tense: "Nullstellen" },
                        { type: "choice", instruction: "f(x) = x¬≤ hat wie viele Nullstellen?", sentence: "", options: ["0", "1", "2", "unendlich viele"], correctIndex: 1, tense: "Nullstellen" },
                        { type: "fillblank", instruction: "f(x) = x¬≤ - 9: Die Nullstellen liegen bei x = ¬±___", sentence: "", answer: "3", alternativeAnswers: [], tense: "Nullstellen" },
                        
                        // === GLEICHUNG ZU GRAPH ZUORDNEN ===
                        { type: "choice", instruction: "Eine Parabel hat S(0|3) und ist nach oben ge√∂ffnet. Welche Gleichung passt?", sentence: "", options: ["f(x) = x¬≤ - 3", "f(x) = x¬≤ + 3", "f(x) = (x - 3)¬≤", "f(x) = -x¬≤ + 3"], correctIndex: 1, tense: "Zuordnung" },
                        { type: "choice", instruction: "Eine Parabel hat S(2|0) und ist nach oben ge√∂ffnet. Welche Gleichung passt?", sentence: "", options: ["f(x) = x¬≤ + 2", "f(x) = x¬≤ - 2", "f(x) = (x - 2)¬≤", "f(x) = (x + 2)¬≤"], correctIndex: 2, tense: "Zuordnung" },
                        { type: "choice", instruction: "Eine Parabel hat S(1|-2), ist gestreckt (a=2) und nach oben ge√∂ffnet. Welche Gleichung passt?", sentence: "", options: ["f(x) = (x - 1)¬≤ - 2", "f(x) = 2(x - 1)¬≤ - 2", "f(x) = 2(x + 1)¬≤ - 2", "f(x) = -2(x - 1)¬≤ - 2"], correctIndex: 1, tense: "Zuordnung" }
                    ]
                },
                {
                    id: "parabeln-umwandlung",
                    name: "Parabeln: Formumwandlung",
                    desc: "Normalform ‚Üî Scheitelpunktform umwandeln",
                    icon: "üîÑ",
                    questions: 35,
                    hasAudio: false,
                    theory: `<h3>üîÑ Umwandlung: Normalform ‚Üî Scheitelpunktform</h3>
                        
                        <h4>Die zwei Formen</h4>
                        <div class="rule-box">
                        <strong>Normalform (allgemeine Form):</strong><br>
                        <code>f(x) = ax¬≤ + bx + c</code><br><br>
                        <strong>Scheitelpunktform:</strong><br>
                        <code>f(x) = a(x - x‚Çõ)¬≤ + y‚Çõ</code><br>
                        mit Scheitelpunkt S(x‚Çõ | y‚Çõ)
                        </div>
                        
                        <h4>Scheitelpunktform ‚Üí Normalform</h4>
                        <div class="example-box">
                        <strong>Methode:</strong> Binomische Formel anwenden und ausmultiplizieren<br><br>
                        <strong>Beispiel:</strong> f(x) = 2(x - 3)¬≤ + 1<br>
                        = 2(x¬≤ - 6x + 9) + 1<br>
                        = 2x¬≤ - 12x + 18 + 1<br>
                        = <strong>2x¬≤ - 12x + 19</strong>
                        </div>
                        
                        <h4>Normalform ‚Üí Scheitelpunktform</h4>
                        <div class="rule-box">
                        <strong>Methode 1: Quadratische Erg√§nzung</strong><br><br>
                        f(x) = x¬≤ + 6x + 5<br>
                        = x¬≤ + 6x + <strong>9</strong> - 9 + 5 &nbsp;&nbsp;(die H√§lfte von 6 ist 3, und 3¬≤ = 9)<br>
                        = (x + 3)¬≤ - 4<br>
                        ‚Üí S(-3 | -4)
                        </div>
                        
                        <div class="rule-box">
                        <strong>Methode 2: Scheitelformel</strong><br><br>
                        <code>x‚Çõ = -b / (2a)</code><br>
                        <code>y‚Çõ = f(x‚Çõ)</code> oder <code>y‚Çõ = c - b¬≤/(4a)</code>
                        </div>
                        
                        <h4>Quadratische Erg√§nzung ‚Äì Schritt f√ºr Schritt</h4>
                        <div class="example-box">
                        f(x) = x¬≤ - 8x + 10<br><br>
                        1. H√§lfte von b: -8 √∑ 2 = <strong>-4</strong><br>
                        2. Quadrieren: (-4)¬≤ = <strong>16</strong><br>
                        3. Erg√§nzen und subtrahieren: x¬≤ - 8x + <strong>16</strong> - 16 + 10<br>
                        4. Binomische Formel: (x - 4)¬≤ - 6<br><br>
                        ‚Üí <strong>f(x) = (x - 4)¬≤ - 6</strong> mit S(4 | -6)
                        </div>
                        
                        <h4>Mit Streckfaktor a ‚â† 1</h4>
                        <div class="example-box">
                        f(x) = 2x¬≤ + 8x + 6<br><br>
                        1. a ausklammern: 2(x¬≤ + 4x) + 6<br>
                        2. Quadratische Erg√§nzung: 2(x¬≤ + 4x + 4 - 4) + 6<br>
                        3. Umformen: 2(x + 2)¬≤ - 8 + 6<br>
                        4. Zusammenfassen: <strong>2(x + 2)¬≤ - 2</strong><br><br>
                        ‚Üí S(-2 | -2)
                        </div>
                        
                        <h4>Binomische Formeln (Wiederholung)</h4>
                        <table><tr><th>Formel</th><th>Beispiel</th></tr>
                        <tr><td>(a + b)¬≤ = a¬≤ + 2ab + b¬≤</td><td>(x + 3)¬≤ = x¬≤ + 6x + 9</td></tr>
                        <tr><td>(a - b)¬≤ = a¬≤ - 2ab + b¬≤</td><td>(x - 5)¬≤ = x¬≤ - 10x + 25</td></tr></table>`,
                    questionData: [
                        // === SCHEITELPUNKTFORM ‚Üí NORMALFORM (einfach) ===
                        { type: "fillblank", instruction: "Wandle in die Normalform um: f(x) = (x + 1)¬≤", sentence: "f(x) = x¬≤ + 2x + _____", answer: "1", alternativeAnswers: [], tense: "SPF‚ÜíNF einfach" },
                        { type: "fillblank", instruction: "Wandle in die Normalform um: f(x) = (x - 2)¬≤", sentence: "f(x) = x¬≤ - 4x + _____", answer: "4", alternativeAnswers: [], tense: "SPF‚ÜíNF einfach" },
                        { type: "fillblank", instruction: "Wandle in die Normalform um: f(x) = (x + 3)¬≤", sentence: "f(x) = x¬≤ + 6x + _____", answer: "9", alternativeAnswers: [], tense: "SPF‚ÜíNF einfach" },
                        { type: "fillblank", instruction: "Wandle in die Normalform um: f(x) = (x - 4)¬≤", sentence: "f(x) = x¬≤ - ___x + 16", answer: "8", alternativeAnswers: [], tense: "SPF‚ÜíNF einfach" },
                        { type: "fillblank", instruction: "Wandle in die Normalform um: f(x) = (x + 5)¬≤", sentence: "f(x) = x¬≤ + ___x + 25", answer: "10", alternativeAnswers: [], tense: "SPF‚ÜíNF einfach" },
                        
                        // === SCHEITELPUNKTFORM ‚Üí NORMALFORM (mit Verschiebung) ===
                        { type: "fillblank", instruction: "Wandle um: f(x) = (x - 1)¬≤ + 3", sentence: "f(x) = x¬≤ - 2x + 1 + 3 = x¬≤ - 2x + _____", answer: "4", alternativeAnswers: [], tense: "SPF‚ÜíNF" },
                        { type: "fillblank", instruction: "Wandle um: f(x) = (x + 2)¬≤ - 5", sentence: "f(x) = x¬≤ + 4x + 4 - 5 = x¬≤ + 4x - _____", answer: "1", alternativeAnswers: [], tense: "SPF‚ÜíNF" },
                        { type: "fillblank", instruction: "Wandle um: f(x) = (x - 3)¬≤ + 2", sentence: "f(x) = x¬≤ - 6x + _____", answer: "11", alternativeAnswers: [], tense: "SPF‚ÜíNF" },
                        { type: "fillblank", instruction: "Wandle um: f(x) = (x + 1)¬≤ - 4", sentence: "f(x) = x¬≤ + 2x - _____", answer: "3", alternativeAnswers: [], tense: "SPF‚ÜíNF" },
                        
                        // === SCHEITELPUNKTFORM ‚Üí NORMALFORM (mit Streckfaktor) ===
                        { type: "fillblank", instruction: "Wandle um: f(x) = 2(x - 1)¬≤", sentence: "= 2(x¬≤ - 2x + 1) = 2x¬≤ - 4x + _____", answer: "2", alternativeAnswers: [], tense: "SPF‚ÜíNF mit a" },
                        { type: "fillblank", instruction: "Wandle um: f(x) = 3(x + 2)¬≤", sentence: "= 3(x¬≤ + 4x + 4) = 3x¬≤ + 12x + _____", answer: "12", alternativeAnswers: [], tense: "SPF‚ÜíNF mit a" },
                        { type: "fillblank", instruction: "Wandle um: f(x) = 2(x - 3)¬≤ + 1", sentence: "= 2(x¬≤ - 6x + 9) + 1 = 2x¬≤ - 12x + _____", answer: "19", alternativeAnswers: [], tense: "SPF‚ÜíNF mit a" },
                        { type: "fillblank", instruction: "Wandle um: f(x) = -1(x - 2)¬≤", sentence: "= -(x¬≤ - 4x + 4) = -x¬≤ + 4x - _____", answer: "4", alternativeAnswers: [], tense: "SPF‚ÜíNF mit a" },
                        
                        // === NORMALFORM ‚Üí SCHEITELPUNKTFORM (Quadratische Erg√§nzung) ===
                        { type: "fillblank", instruction: "Bei f(x) = x¬≤ + 4x: Welche Zahl muss erg√§nzt werden?", sentence: "Die H√§lfte von 4 ist 2, also erg√§nze _____", answer: "4", alternativeAnswers: [], tense: "Quadr. Erg√§nzung" },
                        { type: "fillblank", instruction: "Bei f(x) = x¬≤ - 6x: Welche Zahl muss erg√§nzt werden?", sentence: "Die H√§lfte von 6 ist 3, also erg√§nze _____", answer: "9", alternativeAnswers: [], tense: "Quadr. Erg√§nzung" },
                        { type: "fillblank", instruction: "Bei f(x) = x¬≤ + 8x: Welche Zahl muss erg√§nzt werden?", sentence: "Die H√§lfte von 8 ist 4, also erg√§nze _____", answer: "16", alternativeAnswers: [], tense: "Quadr. Erg√§nzung" },
                        { type: "fillblank", instruction: "Bei f(x) = x¬≤ - 10x: Welche Zahl muss erg√§nzt werden?", sentence: "Die H√§lfte von 10 ist 5, also erg√§nze _____", answer: "25", alternativeAnswers: [], tense: "Quadr. Erg√§nzung" },
                        { type: "fillblank", instruction: "Bei f(x) = x¬≤ + 2x: Welche Zahl muss erg√§nzt werden?", sentence: "Die H√§lfte von 2 ist 1, also erg√§nze _____", answer: "1", alternativeAnswers: [], tense: "Quadr. Erg√§nzung" },
                        
                        // === NORMALFORM ‚Üí SCHEITELPUNKTFORM (komplett) ===
                        { type: "fillblank", instruction: "Wandle um: f(x) = x¬≤ + 4x + 3", sentence: "= (x + 2)¬≤ - 4 + 3 = (x + 2)¬≤ - _____", answer: "1", alternativeAnswers: [], tense: "NF‚ÜíSPF" },
                        { type: "fillblank", instruction: "Wandle um: f(x) = x¬≤ - 6x + 5", sentence: "= (x - 3)¬≤ - 9 + 5 = (x - 3)¬≤ - _____", answer: "4", alternativeAnswers: [], tense: "NF‚ÜíSPF" },
                        { type: "fillblank", instruction: "Wandle um: f(x) = x¬≤ + 2x - 3", sentence: "= (x + 1)¬≤ - 1 - 3 = (x + 1)¬≤ - _____", answer: "4", alternativeAnswers: [], tense: "NF‚ÜíSPF" },
                        { type: "fillblank", instruction: "Wandle um: f(x) = x¬≤ - 4x + 7", sentence: "= (x - 2)¬≤ - 4 + 7 = (x - 2)¬≤ + _____", answer: "3", alternativeAnswers: [], tense: "NF‚ÜíSPF" },
                        { type: "fillblank", instruction: "Wandle um: f(x) = x¬≤ + 8x + 12", sentence: "= (x + 4)¬≤ - 16 + 12 = (x + 4)¬≤ - _____", answer: "4", alternativeAnswers: [], tense: "NF‚ÜíSPF" },
                        
                        // === SCHEITELPUNKT AUS NORMALFORM BESTIMMEN ===
                        { type: "fillblank", instruction: "f(x) = x¬≤ - 4x + 3: Bestimme den Scheitelpunkt.", sentence: "x‚Çõ = -b/(2a) = 4/2 = 2, y‚Çõ = f(2) = 4-8+3 = -1 ‚Üí S(2|_____)", answer: "-1", alternativeAnswers: [], tense: "Scheitelpunkt" },
                        { type: "fillblank", instruction: "f(x) = x¬≤ + 6x + 5: Bestimme x‚Çõ.", sentence: "x‚Çõ = -b/(2a) = -6/2 = _____", answer: "-3", alternativeAnswers: [], tense: "Scheitelpunkt" },
                        { type: "fillblank", instruction: "f(x) = x¬≤ - 2x - 3: Bestimme den Scheitelpunkt.", sentence: "x‚Çõ = 1, y‚Çõ = 1-2-3 = _____ ‚Üí S(1|_____)", answer: "-4", alternativeAnswers: [], tense: "Scheitelpunkt" },
                        { type: "choice", instruction: "f(x) = x¬≤ + 4x + 1: Welcher Scheitelpunkt ist korrekt?", sentence: "", options: ["S(2|3)", "S(-2|-3)", "S(2|-3)", "S(-2|3)"], correctIndex: 1, tense: "Scheitelpunkt" },
                        { type: "choice", instruction: "f(x) = x¬≤ - 8x + 15: Welcher Scheitelpunkt ist korrekt?", sentence: "", options: ["S(4|-1)", "S(-4|-1)", "S(4|1)", "S(-4|1)"], correctIndex: 0, tense: "Scheitelpunkt" },
                        
                        // === BINOMISCHE FORMELN ===
                        { type: "choice", instruction: "Welche binomische Formel passt zu (x + 4)¬≤?", sentence: "", options: ["x¬≤ - 8x + 16", "x¬≤ + 8x + 16", "x¬≤ + 4x + 16", "x¬≤ + 8x + 4"], correctIndex: 1, tense: "Binomisch" },
                        { type: "choice", instruction: "Welche binomische Formel passt zu (x - 7)¬≤?", sentence: "", options: ["x¬≤ - 14x + 49", "x¬≤ + 14x + 49", "x¬≤ - 7x + 49", "x¬≤ - 14x + 14"], correctIndex: 0, tense: "Binomisch" },
                        { type: "fillblank", instruction: "(x - 6)¬≤ = x¬≤ - 12x + _____", sentence: "", answer: "36", alternativeAnswers: [], tense: "Binomisch" },
                        { type: "fillblank", instruction: "(x + 9)¬≤ = x¬≤ + ___x + 81", sentence: "", answer: "18", alternativeAnswers: [], tense: "Binomisch" },
                        
                        // === GEMISCHTE AUFGABEN ===
                        { type: "choice", instruction: "Welche Scheitelpunktform entspricht f(x) = x¬≤ - 2x - 8?", sentence: "", options: ["(x - 1)¬≤ - 9", "(x + 1)¬≤ - 9", "(x - 1)¬≤ + 9", "(x - 2)¬≤ - 8"], correctIndex: 0, tense: "Gemischt" },
                        { type: "choice", instruction: "Welche Normalform entspricht f(x) = (x + 3)¬≤ - 4?", sentence: "", options: ["x¬≤ + 6x + 5", "x¬≤ - 6x + 5", "x¬≤ + 6x + 13", "x¬≤ + 3x - 4"], correctIndex: 0, tense: "Gemischt" }
                    ]
                }
            ],
                {
                    id: "avoir-etre",
                    name: "Avoir et √ätre",
                    desc: "Die wichtigsten Hilfsverben und ihre Verwendung",
                    icon: "üá´üá∑",
                    questions: 18,
                    hasAudio: true,
                    audioLang: "fr-FR",
                    theory: `<h3>üìö Avoir et √ätre</h3>
                        <h4>Avoir (haben)</h4>
                        <table><tr><th>Person</th><th>Form</th></tr>
                        <tr><td>j'</td><td>ai</td></tr>
                        <tr><td>tu</td><td>as</td></tr>
                        <tr><td>il/elle/on</td><td>a</td></tr>
                        <tr><td>nous</td><td>avons</td></tr>
                        <tr><td>vous</td><td>avez</td></tr>
                        <tr><td>ils/elles</td><td>ont</td></tr></table>
                        <h4>√ätre (sein)</h4>
                        <table><tr><th>Person</th><th>Form</th></tr>
                        <tr><td>je</td><td>suis</td></tr>
                        <tr><td>tu</td><td>es</td></tr>
                        <tr><td>il/elle/on</td><td>est</td></tr>
                        <tr><td>nous</td><td>sommes</td></tr>
                        <tr><td>vous</td><td>√™tes</td></tr>
                        <tr><td>ils/elles</td><td>sont</td></tr></table>
                        <h4>Pass√© Compos√©</h4>
                        <div class="rule-box"><strong>Mit √™tre:</strong> Bewegungsverben (aller, venir, arriver, partir...) und reflexive Verben<br>
                        <strong>Mit avoir:</strong> Die meisten anderen Verben</div>
                        <div class="example-box">J'ai mang√© (ich habe gegessen)<br>Je suis all√©(e) (ich bin gegangen)</div>`,
                    questionData: [
                        { type: "fillblank", instruction: "Konjugiere 'avoir':", sentence: "J'_____ un chien.", answer: "ai", alternativeAnswers: [], tense: "Pr√©sent" },
                        { type: "fillblank", instruction: "Konjugiere 'avoir':", sentence: "Tu _____ 15 ans.", answer: "as", alternativeAnswers: [], tense: "Pr√©sent" },
                        { type: "fillblank", instruction: "Konjugiere 'avoir':", sentence: "Elle _____ faim.", answer: "a", alternativeAnswers: [], tense: "Pr√©sent" },
                        { type: "fillblank", instruction: "Konjugiere 'avoir':", sentence: "Nous _____ une voiture.", answer: "avons", alternativeAnswers: [], tense: "Pr√©sent" },
                        { type: "fillblank", instruction: "Konjugiere 'avoir':", sentence: "Ils _____ trois enfants.", answer: "ont", alternativeAnswers: [], tense: "Pr√©sent" },
                        { type: "fillblank", instruction: "Konjugiere '√™tre':", sentence: "Je _____ fran√ßais.", answer: "suis", alternativeAnswers: [], tense: "Pr√©sent" },
                        { type: "fillblank", instruction: "Konjugiere '√™tre':", sentence: "Tu _____ fatigu√©.", answer: "es", alternativeAnswers: [], tense: "Pr√©sent" },
                        { type: "fillblank", instruction: "Konjugiere '√™tre':", sentence: "Il _____ grand.", answer: "est", alternativeAnswers: [], tense: "Pr√©sent" },
                        { type: "fillblank", instruction: "Konjugiere '√™tre':", sentence: "Nous _____ contents.", answer: "sommes", alternativeAnswers: [], tense: "Pr√©sent" },
                        { type: "fillblank", instruction: "Konjugiere '√™tre':", sentence: "Vous _____ allemands.", answer: "√™tes", alternativeAnswers: [], tense: "Pr√©sent" },
                        { type: "fillblank", instruction: "Konjugiere '√™tre':", sentence: "Elles _____ belles.", answer: "sont", alternativeAnswers: [], tense: "Pr√©sent" },
                        { type: "choice", instruction: "Pass√© compos√©: Welches Hilfsverb f√ºr 'manger'?", sentence: "", options: ["√™tre", "avoir", "aller", "faire"], correctIndex: 1, tense: "Pass√© Compos√©" },
                        { type: "choice", instruction: "Pass√© compos√©: Welches Hilfsverb f√ºr 'aller'?", sentence: "", options: ["avoir", "√™tre", "venir", "faire"], correctIndex: 1, tense: "Pass√© Compos√©" },
                        { type: "fillblank", instruction: "Bilde das Pass√© compos√©:", sentence: "J'_____ mang√© une pizza. (avoir)", answer: "ai", alternativeAnswers: [], tense: "Pass√© Compos√©" },
                        { type: "fillblank", instruction: "Bilde das Pass√© compos√©:", sentence: "Elle _____ all√©e √† Paris. (√™tre)", answer: "est", alternativeAnswers: [], tense: "Pass√© Compos√©" },
                        { type: "choice", instruction: "Welcher Satz ist korrekt?", sentence: "", options: ["J'ai all√©", "Je suis all√©", "J'avoir all√©", "Je √™tre all√©"], correctIndex: 1, tense: "Pass√© Compos√©" },
                        { type: "fillblank", instruction: "√úbersetze:", sentence: "Ich habe = J'_____", answer: "ai", alternativeAnswers: [], tense: "√úbersetzung" },
                        { type: "fillblank", instruction: "√úbersetze:", sentence: "Ich bin = Je _____", answer: "suis", alternativeAnswers: [], tense: "√úbersetzung" }
                    ]
                }
            ],
            "9-biologie": [
                {
                    id: "blut-herz",
                    name: "Blut und Herz",
                    desc: "Blutkreislauf, Blutbestandteile und Herzfunktion",
                    icon: "‚ù§Ô∏è",
                    questions: 18,
                    hasAudio: false,
                    theory: `<h3>ü´Ä Blut und Herz</h3>
                        <h4>Blutbestandteile</h4>
                        <table><tr><th>Bestandteil</th><th>Funktion</th></tr>
                        <tr><td>Rote Blutk√∂rperchen (Erythrozyten)</td><td>Sauerstofftransport</td></tr>
                        <tr><td>Wei√üe Blutk√∂rperchen (Leukozyten)</td><td>Immunabwehr</td></tr>
                        <tr><td>Blutpl√§ttchen (Thrombozyten)</td><td>Blutgerinnung</td></tr>
                        <tr><td>Blutplasma</td><td>Transportmedium</td></tr></table>
                        <h4>Das Herz</h4>
                        <div class="rule-box">Das Herz hat <strong>4 Kammern</strong>: 2 Vorh√∂fe (Atrien) und 2 Herzkammern (Ventrikel)</div>
                        <h4>Blutkreislauf</h4>
                        <div class="example-box"><strong>Lungenkreislauf:</strong> Rechte Herzkammer ‚Üí Lunge ‚Üí Linker Vorhof<br>
                        <strong>K√∂rperkreislauf:</strong> Linke Herzkammer ‚Üí K√∂rper ‚Üí Rechter Vorhof</div>
                        <h4>Blutgruppen</h4>
                        <p>A, B, AB, 0 - unterschieden durch Antigene auf den roten Blutk√∂rperchen</p>`,
                    questionData: [
                        { type: "choice", instruction: "Welche Zellen transportieren Sauerstoff?", sentence: "", options: ["Wei√üe Blutk√∂rperchen", "Rote Blutk√∂rperchen", "Blutpl√§ttchen", "Blutplasma"], correctIndex: 1, tense: "Blut" },
                        { type: "fillblank", instruction: "Erg√§nze:", sentence: "Rote Blutk√∂rperchen hei√üen auch _____.", answer: "Erythrozyten", alternativeAnswers: [], tense: "Fachbegriff" },
                        { type: "choice", instruction: "Welche Zellen sind f√ºr die Immunabwehr zust√§ndig?", sentence: "", options: ["Erythrozyten", "Leukozyten", "Thrombozyten", "Plasma"], correctIndex: 1, tense: "Blut" },
                        { type: "fillblank", instruction: "Erg√§nze:", sentence: "F√ºr die Blutgerinnung sind die _____ verantwortlich.", answer: "Blutpl√§ttchen", alternativeAnswers: ["Thrombozyten"], tense: "Blut" },
                        { type: "choice", instruction: "Wie viele Kammern hat das Herz?", sentence: "", options: ["2", "3", "4", "5"], correctIndex: 2, tense: "Herz" },
                        { type: "fillblank", instruction: "Erg√§nze:", sentence: "Das Herz hat 2 Vorh√∂fe und 2 _____.", answer: "Herzkammern", alternativeAnswers: ["Ventrikel", "Kammern"], tense: "Herz" },
                        { type: "choice", instruction: "Wohin pumpt die rechte Herzkammer das Blut?", sentence: "", options: ["In den K√∂rper", "In die Lunge", "In den Kopf", "In die Beine"], correctIndex: 1, tense: "Kreislauf" },
                        { type: "choice", instruction: "Wohin pumpt die linke Herzkammer das Blut?", sentence: "", options: ["In die Lunge", "In den K√∂rper", "Ins Gehirn", "Ins Herz"], correctIndex: 1, tense: "Kreislauf" },
                        { type: "fillblank", instruction: "Erg√§nze:", sentence: "Der fl√ºssige Teil des Blutes hei√üt _____.", answer: "Blutplasma", alternativeAnswers: ["Plasma"], tense: "Blut" },
                        { type: "choice", instruction: "Welche Blutgruppen gibt es im AB0-System?", sentence: "", options: ["A, B, C, D", "A, B, AB, 0", "1, 2, 3, 4", "Rot, Wei√ü, Blau"], correctIndex: 1, tense: "Blutgruppen" },
                        { type: "fillblank", instruction: "Erg√§nze:", sentence: "Der Farbstoff in roten Blutk√∂rperchen hei√üt _____.", answer: "H√§moglobin", alternativeAnswers: [], tense: "Fachbegriff" },
                        { type: "choice", instruction: "Was transportiert das Blut NICHT?", sentence: "", options: ["Sauerstoff", "N√§hrstoffe", "Gedanken", "Hormone"], correctIndex: 2, tense: "Funktion" },
                        { type: "fillblank", instruction: "Erg√§nze:", sentence: "Die Vorh√∂fe des Herzens hei√üen auch _____.", answer: "Atrien", alternativeAnswers: [], tense: "Fachbegriff" },
                        { type: "choice", instruction: "Wie oft schl√§gt das Herz etwa pro Minute (Erwachsener, Ruhe)?", sentence: "", options: ["30-40 mal", "60-80 mal", "100-120 mal", "150-180 mal"], correctIndex: 1, tense: "Fakten" },
                        { type: "fillblank", instruction: "Erg√§nze:", sentence: "Im _____ wird das Blut mit Sauerstoff angereichert.", answer: "Lungenkreislauf", alternativeAnswers: ["kleinen Kreislauf"], tense: "Kreislauf" },
                        { type: "choice", instruction: "Welches Blutgef√§√ü f√ºhrt Blut zum Herzen?", sentence: "", options: ["Arterie", "Vene", "Kapillare", "Aorta"], correctIndex: 1, tense: "Gef√§√üe" },
                        { type: "fillblank", instruction: "Erg√§nze:", sentence: "Die gr√∂√üte Arterie des K√∂rpers ist die _____.", answer: "Aorta", alternativeAnswers: ["Hauptschlagader"], tense: "Gef√§√üe" },
                        { type: "choice", instruction: "Was ist der Unterschied zwischen Arterien und Venen?", sentence: "", options: ["Farbe des Blutes", "Arterien f√ºhren vom Herzen weg", "Venen sind dicker", "Kein Unterschied"], correctIndex: 1, tense: "Gef√§√üe" }
                    ]
                }
            ],
            "9-deutsch": [{ id: "coming-soon", name: "In Arbeit...", desc: "Neue Themen werden bald hinzugef√ºgt", icon: "üöß", questions: 0, comingSoon: true }],
            "9-geschichte": [{ id: "coming-soon", name: "In Arbeit...", desc: "Neue Themen werden bald hinzugef√ºgt", icon: "üöß", questions: 0, comingSoon: true }],
            "9-physik": [
                {
                    id: "bewegung-beschleunigung",
                    name: "Bewegung & Beschleunigung",
                    desc: "Gleichf√∂rmige und beschleunigte Bewegung, freier Fall, Anhalteweg",
                    icon: "üöó",
                    questions: 28,
                    hasAudio: false,
                    theory: `<h3>üöó Bewegung und Beschleunigung</h3>
                        
                        <h4>1. Gleichf√∂rmige Bewegung</h4>
                        <div class="rule-box">
                        <strong>Merkmal:</strong> Geschwindigkeit v ist konstant<br><br>
                        <strong>Weg-Zeit-Gesetz:</strong> <code>s = v ¬∑ t</code><br>
                        <strong>Geschwindigkeit:</strong> <code>v = s / t</code>
                        </div>
                        
                        <h4>2. Gleichm√§√üig beschleunigte Bewegung</h4>
                        <div class="rule-box">
                        <strong>Merkmal:</strong> Beschleunigung a ist konstant<br><br>
                        <strong>Formeln:</strong><br>
                        ‚Ä¢ <code>v = a ¬∑ t</code> (Geschwindigkeit nach Zeit t)<br>
                        ‚Ä¢ <code>s = ¬Ω ¬∑ a ¬∑ t¬≤</code> (Weg nach Zeit t)<br>
                        ‚Ä¢ <code>a = Œîv / Œît</code> (Beschleunigung = Geschwindigkeits√§nderung pro Zeit)
                        </div>
                        
                        <h4>3. Der freie Fall</h4>
                        <div class="example-box">
                        <strong>Fallbeschleunigung g:</strong><br>
                        ‚Ä¢ Erde: <code>g = 9,81 m/s¬≤</code> (‚âà 10 m/s¬≤)<br>
                        ‚Ä¢ Mond: <code>g = 1,62 m/s¬≤</code><br><br>
                        <strong>Formeln:</strong><br>
                        ‚Ä¢ <code>s = ¬Ω ¬∑ g ¬∑ t¬≤</code><br>
                        ‚Ä¢ <code>v = g ¬∑ t</code><br>
                        ‚Ä¢ <code>t = ‚àö(2s/g)</code><br><br>
                        <strong>Wichtig:</strong> Im Vakuum fallen alle K√∂rper gleich schnell ‚Äì unabh√§ngig von ihrer Masse!
                        </div>
                        
                        <h4>4. Anhalteweg</h4>
                        <div class="rule-box">
                        <strong>Anhalteweg = Reaktionsweg + Bremsweg</strong><br><br>
                        ‚Ä¢ <strong>Reaktionsweg:</strong> Strecke w√§hrend der Reaktionszeit (ca. 0,6-1,2 s)<br>
                        ‚Ä¢ <strong>Bremsweg:</strong> Strecke vom Bremsbeginn bis zum Stillstand<br><br>
                        <strong>Faustregel (F√ºhrerschein):</strong><br>
                        <code>Anhalteweg (m) = (v/10) ¬∑ 3 + (v/10)¬≤</code><br>
                        (v in km/h)
                        </div>
                        
                        <h4>5. Diagramme</h4>
                        <table><tr><th>Bewegung</th><th>v-t-Diagramm</th><th>s-t-Diagramm</th></tr>
                        <tr><td>Gleichf√∂rmig</td><td>Horizontale Linie</td><td>Gerade (linear)</td></tr>
                        <tr><td>Beschleunigt</td><td>Steigende Gerade</td><td>Parabel (gekr√ºmmt)</td></tr>
                        <tr><td>Verz√∂gert (Bremsen)</td><td>Fallende Gerade</td><td>Abflachende Kurve</td></tr></table>`,
                    questionData: [
                        // === GRUNDLAGEN: Formeln ===
                        { type: "fillblank", instruction: "Erg√§nze die Formel f√ºr die gleichf√∂rmige Bewegung:", sentence: "s = v ¬∑ _____", answer: "t", alternativeAnswers: [], tense: "Formeln" },
                        { type: "fillblank", instruction: "Erg√§nze die Formel f√ºr die beschleunigte Bewegung:", sentence: "s = ¬Ω ¬∑ a ¬∑ _____", answer: "t¬≤", alternativeAnswers: ["t^2", "t hoch 2"], tense: "Formeln" },
                        { type: "fillblank", instruction: "Erg√§nze die Formel:", sentence: "v = a ¬∑ _____", answer: "t", alternativeAnswers: [], tense: "Formeln" },
                        { type: "fillblank", instruction: "Die Beschleunigung berechnet man mit:", sentence: "a = Œîv / _____", answer: "Œît", alternativeAnswers: ["t", "delta t"], tense: "Formeln" },
                        { type: "choice", instruction: "Welche Formel gilt f√ºr den freien Fall?", sentence: "", options: ["s = v ¬∑ t", "s = ¬Ω ¬∑ g ¬∑ t¬≤", "s = a + t", "s = g / t"], correctIndex: 1, tense: "Formeln" },
                        
                        // === FALLBESCHLEUNIGUNG ===
                        { type: "fillblank", instruction: "Die Fallbeschleunigung auf der Erde betr√§gt:", sentence: "g ‚âà _____ m/s¬≤", answer: "9,81", alternativeAnswers: ["9.81", "10", "9,8"], tense: "Freier Fall" },
                        { type: "fillblank", instruction: "Die Fallbeschleunigung auf dem Mond betr√§gt:", sentence: "g ‚âà _____ m/s¬≤", answer: "1,62", alternativeAnswers: ["1.62", "1,6"], tense: "Freier Fall" },
                        { type: "choice", instruction: "Was passiert mit zwei Kugeln unterschiedlicher Masse im Vakuum?", sentence: "", options: ["Die schwere f√§llt schneller", "Die leichte f√§llt schneller", "Beide fallen gleich schnell", "Keine f√§llt"], correctIndex: 2, tense: "Freier Fall" },
                        { type: "choice", instruction: "Warum f√§llt eine Feder in Luft langsamer als eine Kugel?", sentence: "", options: ["Weil sie leichter ist", "Wegen des Luftwiderstands", "Weil g f√ºr Federn kleiner ist", "Weil sie gr√∂√üer ist"], correctIndex: 1, tense: "Freier Fall" },
                        { type: "choice", instruction: "Der freie Fall ist eine...", sentence: "", options: ["gleichf√∂rmige Bewegung", "gleichm√§√üig beschleunigte Bewegung", "verz√∂gerte Bewegung", "kreisf√∂rmige Bewegung"], correctIndex: 1, tense: "Freier Fall" },
                        
                        // === BERECHNUNGEN: Freier Fall ===
                        { type: "fillblank", instruction: "Ein Stein f√§llt 2 Sekunden. Wie weit f√§llt er? (g = 10 m/s¬≤)", sentence: "s = ¬Ω ¬∑ 10 ¬∑ 2¬≤ = _____ m", answer: "20", alternativeAnswers: [], tense: "Rechnen" },
                        { type: "fillblank", instruction: "Ein Stein f√§llt 3 Sekunden. Welche Geschwindigkeit hat er? (g = 10 m/s¬≤)", sentence: "v = g ¬∑ t = 10 ¬∑ 3 = _____ m/s", answer: "30", alternativeAnswers: [], tense: "Rechnen" },
                        { type: "fillblank", instruction: "Wie lange f√§llt ein Gegenstand aus 80 m H√∂he? (g = 10 m/s¬≤)", sentence: "t = ‚àö(2¬∑80/10) = ‚àö16 = _____ s", answer: "4", alternativeAnswers: [], tense: "Rechnen" },
                        
                        // === ANHALTEWEG ===
                        { type: "fillblank", instruction: "Der Anhalteweg setzt sich zusammen aus:", sentence: "Anhalteweg = Reaktionsweg + _____", answer: "Bremsweg", alternativeAnswers: [], tense: "Anhalteweg" },
                        { type: "choice", instruction: "Was verl√§ngert den REAKTIONSWEG?", sentence: "", options: ["Nasse Stra√üe", "Ablenkung/M√ºdigkeit", "Abgefahrene Reifen", "Bergab fahren"], correctIndex: 1, tense: "Anhalteweg" },
                        { type: "choice", instruction: "Was verl√§ngert den BREMSWEG?", sentence: "", options: ["H√∂here Reaktionszeit", "Nasse/glatte Stra√üe", "Unaufmerksamkeit", "L√§ngere Reaktionszeit"], correctIndex: 1, tense: "Anhalteweg" },
                        { type: "fillblank", instruction: "Faustregel Reaktionsweg bei 50 km/h:", sentence: "Reaktionsweg ‚âà (50/10) ¬∑ 3 = _____ m", answer: "15", alternativeAnswers: [], tense: "Anhalteweg" },
                        { type: "fillblank", instruction: "Faustregel Bremsweg bei 50 km/h:", sentence: "Bremsweg ‚âà (50/10)¬≤ = _____ m", answer: "25", alternativeAnswers: [], tense: "Anhalteweg" },
                        { type: "fillblank", instruction: "Anhalteweg bei 50 km/h (Faustregel):", sentence: "Anhalteweg = 15 + 25 = _____ m", answer: "40", alternativeAnswers: [], tense: "Anhalteweg" },
                        
                        // === DIAGRAMME ===
                        { type: "choice", instruction: "Wie sieht das v-t-Diagramm einer GLEICHF√ñRMIGEN Bewegung aus?", sentence: "", options: ["Steigende Gerade", "Horizontale Linie", "Parabel", "Fallende Gerade"], correctIndex: 1, tense: "Diagramme" },
                        { type: "choice", instruction: "Wie sieht das s-t-Diagramm einer BESCHLEUNIGTEN Bewegung aus?", sentence: "", options: ["Horizontale Linie", "Gerade Linie", "Parabel (Kurve)", "Senkrechte Linie"], correctIndex: 2, tense: "Diagramme" },
                        { type: "choice", instruction: "Im v-t-Diagramm zeigt eine FALLENDE Gerade...", sentence: "", options: ["Beschleunigung", "Gleichf√∂rmige Bewegung", "Verz√∂gerung (Bremsen)", "Stillstand"], correctIndex: 2, tense: "Diagramme" },
                        { type: "choice", instruction: "Was kann man aus der STEIGUNG im v-t-Diagramm ablesen?", sentence: "", options: ["Die Geschwindigkeit", "Den Weg", "Die Beschleunigung", "Die Zeit"], correctIndex: 2, tense: "Diagramme" },
                        
                        // === BESCHLEUNIGUNG BERECHNEN ===
                        { type: "fillblank", instruction: "Ein Auto beschleunigt in 4 s von 0 auf 40 m/s. Berechne a:", sentence: "a = 40 / 4 = _____ m/s¬≤", answer: "10", alternativeAnswers: [], tense: "Rechnen" },
                        { type: "fillblank", instruction: "Ein Auto beschleunigt mit a = 5 m/s¬≤. Welche Strecke legt es in 6 s zur√ºck?", sentence: "s = ¬Ω ¬∑ 5 ¬∑ 36 = _____ m", answer: "90", alternativeAnswers: [], tense: "Rechnen" },
                        { type: "choice", instruction: "Ein Fahrzeug im v-t-Diagramm zeigt eine horizontale Linie bei v = 40 m/s. Was bedeutet das?", sentence: "", options: ["Es beschleunigt", "Es bremst", "Es f√§hrt mit konstanter Geschwindigkeit", "Es steht still"], correctIndex: 2, tense: "Diagramme" },
                        
                        // === BEWEGUNGSARTEN UNTERSCHEIDEN ===
                        { type: "choice", instruction: "Bei welcher Bewegung ist v konstant?", sentence: "", options: ["Freier Fall", "Gleichf√∂rmige Bewegung", "Beschleunigte Bewegung", "Bremsvorgang"], correctIndex: 1, tense: "Unterscheidung" },
                        { type: "choice", instruction: "Bei welcher Bewegung ist a konstant (aber nicht null)?", sentence: "", options: ["Gleichf√∂rmige Bewegung", "Ruhe", "Gleichm√§√üig beschleunigte Bewegung", "Kreisbewegung"], correctIndex: 2, tense: "Unterscheidung" }
                    ]
                }
            ],
            "9-chemie": [{ id: "coming-soon", name: "In Arbeit...", desc: "Neue Themen werden bald hinzugef√ºgt", icon: "üöß", questions: 0, comingSoon: true }],

            // Default
            "default": [{ id: "coming-soon", name: "In Arbeit...", desc: "Neue Themen werden bald hinzugef√ºgt", icon: "üöß", questions: 0, comingSoon: true }]
        };

        // =====================================================
        // SPEECH API
        // =====================================================
        const synth = window.speechSynthesis;
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        let recognition = null;
        let isListening = false;
        let finalTranscript = '';
        let currentAudioLang = 'en-GB';

        if (SpeechRecognition) {
            recognition = new SpeechRecognition();
            recognition.continuous = false;
            recognition.interimResults = true;
        }

        function speak(text, lang = currentAudioLang) {
            if (!synth) return;
            synth.cancel();
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = lang;
            utterance.rate = 0.9;
            const voices = synth.getVoices();
            const voice = voices.find(v => v.lang === lang) || voices.find(v => v.lang.startsWith(lang.split('-')[0]));
            if (voice) utterance.voice = voice;
            utterance.onend = () => document.getElementById('speakBtn')?.classList.remove('speaking');
            document.getElementById('speakBtn')?.classList.add('speaking');
            synth.speak(utterance);
        }

        if (synth) synth.onvoiceschanged = () => synth.getVoices();

        function startListening() {
            if (!recognition || isListening) return;
            recognition.lang = currentAudioLang;
            finalTranscript = '';
            document.getElementById('recognizedContent').textContent = '';
            document.getElementById('recognizedText').classList.add('show');
            document.getElementById('voiceVisualizer').classList.add('active');
            document.getElementById('listenBtn').classList.add('listening');
            document.getElementById('listenBtn').innerHTML = '‚èπÔ∏è Stopp';
            isListening = true;
            recognition.start();
        }

        function stopListening() {
            if (!recognition || !isListening) return;
            recognition.stop();
        }

        if (recognition) {
            recognition.onresult = (event) => {
                let interim = '';
                for (let i = event.resultIndex; i < event.results.length; i++) {
                    if (event.results[i].isFinal) finalTranscript += event.results[i][0].transcript;
                    else interim += event.results[i][0].transcript;
                }
                document.getElementById('recognizedContent').textContent = finalTranscript + interim;
                const input = document.getElementById('answerInput');
                if (input) input.value = finalTranscript + interim;
            };
            recognition.onend = () => {
                isListening = false;
                document.getElementById('voiceVisualizer').classList.remove('active');
                document.getElementById('listenBtn').classList.remove('listening');
                document.getElementById('listenBtn').innerHTML = 'üé§ Sprechen';
            };
            recognition.onerror = () => {
                isListening = false;
                document.getElementById('voiceVisualizer').classList.remove('active');
                document.getElementById('listenBtn').classList.remove('listening');
                document.getElementById('listenBtn').innerHTML = 'üé§ Sprechen';
            };
        }

        // =====================================================
        // APP STATE
        // =====================================================
        let state = {
            loggedIn: false,
            selectedGrade: null,
            selectedSubject: null,
            selectedTopic: null,
            audioMode: false,
            questions: [],
            currentIndex: 0,
            correct: 0,
            wrong: 0,
            answered: false,
            completedModules: [],
            customModules: {}
        };

        function loadProgress() {
            const saved = localStorage.getItem('lerntrainer_progress');
            if (saved) {
                const data = JSON.parse(saved);
                state.completedModules = data.completedModules || [];
            }
        }

        function saveProgress() {
            localStorage.setItem('lerntrainer_progress', JSON.stringify({ completedModules: state.completedModules }));
        }

        // =====================================================
        // UI FUNCTIONS
        // =====================================================
        function showLogin() {
            document.getElementById('loginScreen').style.display = 'flex';
            document.getElementById('appContainer').classList.remove('show');
        }

        function showApp() {
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('appContainer').classList.add('show');
            showGradeSelection();
            updateProgressBar();
        }

        function showGradeSelection() {
            document.getElementById('gradeSelection').style.display = 'block';
            document.getElementById('subjectSelection').style.display = 'none';
            document.getElementById('topicSelection').style.display = 'none';
            document.getElementById('generatorSection').style.display = 'none';
            document.getElementById('quizContainer').classList.remove('show');
            document.getElementById('progressSection').style.display = 'block';
            state.selectedGrade = null;
            state.selectedSubject = null;
            updateBreadcrumb();
        }

        function showSubjectSelection() {
            document.getElementById('gradeSelection').style.display = 'none';
            document.getElementById('subjectSelection').style.display = 'block';
            document.getElementById('topicSelection').style.display = 'none';
            document.getElementById('generatorSection').style.display = 'none';
            document.getElementById('quizContainer').classList.remove('show');
            state.selectedSubject = null;
            updateBreadcrumb();
        }

        function showTopicSelection() {
            document.getElementById('gradeSelection').style.display = 'none';
            document.getElementById('subjectSelection').style.display = 'none';
            document.getElementById('topicSelection').style.display = 'block';
            document.getElementById('generatorSection').style.display = 'block';
            document.getElementById('quizContainer').classList.remove('show');
            // Pre-select grade and subject in generator
            document.getElementById('genGrade').value = state.selectedGrade;
            document.getElementById('genSubject').value = state.selectedSubject;
            renderTopics();
            updateBreadcrumb();
        }

        function showQuiz() {
            document.getElementById('gradeSelection').style.display = 'none';
            document.getElementById('subjectSelection').style.display = 'none';
            document.getElementById('topicSelection').style.display = 'none';
            document.getElementById('generatorSection').style.display = 'none';
            document.getElementById('progressSection').style.display = 'none';
            document.getElementById('quizContainer').classList.add('show');
            document.getElementById('questionArea').style.display = 'block';
            document.getElementById('resultScreen').classList.remove('show');
            document.getElementById('breadcrumb').innerHTML = '';
            startQuiz();
        }

        function updateBreadcrumb() {
            const bc = document.getElementById('breadcrumb');
            let html = `<div class="breadcrumb-item clickable" onclick="showGradeSelection()">üè† Start</div>`;
            if (state.selectedGrade) {
                html += `<span class="breadcrumb-arrow">‚Üí</span>`;
                html += `<div class="breadcrumb-item ${state.selectedSubject ? 'clickable' : ''}" ${state.selectedSubject ? 'onclick="showSubjectSelection()"' : ''}>Klasse ${state.selectedGrade}</div>`;
            }
            if (state.selectedSubject) {
                const subject = SUBJECTS.find(s => s.id === state.selectedSubject);
                html += `<span class="breadcrumb-arrow">‚Üí</span>`;
                html += `<div class="breadcrumb-item">${subject.icon} ${subject.name}</div>`;
            }
            bc.innerHTML = html;
        }

        function updateProgressBar() {
            const totalModules = Object.values(TOPICS).flat().filter(t => !t.comingSoon && t.questions > 0).length;
            const completed = state.completedModules.length;
            const percent = totalModules > 0 ? Math.round((completed / totalModules) * 100) : 0;
            document.getElementById('progressFill').style.width = percent + '%';
            document.getElementById('progressStats').textContent = `${completed} von ${totalModules} Modulen abgeschlossen`;
        }

        // =====================================================
        // RENDER
        // =====================================================
        function renderGrades() {
            document.getElementById('gradeGrid').innerHTML = GRADES.map(g => `
                <button class="selection-btn" data-grade="${g.id}">
                    <span class="icon">${g.icon}</span>
                    <span class="label">${g.name}</span>
                </button>
            `).join('');
        }

        function renderSubjects() {
            document.getElementById('subjectGrid').innerHTML = SUBJECTS.map(s => `
                <button class="selection-btn" data-subject="${s.id}">
                    <span class="icon">${s.icon}</span>
                    <span class="label">${s.name}</span>
                </button>
            `).join('');
        }

        function renderTopics() {
            const grid = document.getElementById('topicGrid');
            const key = `${state.selectedGrade}-${state.selectedSubject}`;
            const builtInTopics = TOPICS[key] || TOPICS['default'];
            const customTopics = getCustomModules(state.selectedGrade, state.selectedSubject);
            
            // Combine built-in and custom topics
            const allTopics = [...builtInTopics, ...customTopics];
            
            grid.innerHTML = allTopics.map(t => {
                const moduleId = `${key}-${t.id}`;
                const isCompleted = state.completedModules.includes(moduleId);
                const isCustom = t.isCustom || false;
                return `
                    <button class="topic-card ${t.comingSoon ? 'coming-soon' : ''}" data-topic="${t.id}" data-custom="${isCustom}" ${t.comingSoon ? 'disabled' : ''}>
                        <div class="topic-icon">${t.icon}</div>
                        <div class="topic-name">${t.name}</div>
                        <div class="topic-desc">${t.desc}</div>
                        <div class="topic-meta">
                            ${t.questions > 0 ? `<span class="topic-tag questions">${t.questions} Fragen</span>` : ''}
                            ${t.hasAudio ? '<span class="topic-tag audio">üé§ Audio</span>' : ''}
                            ${isCustom ? '<span class="topic-tag" style="background:#faf5ff;color:#805ad5;">ü§ñ KI</span>' : ''}
                            ${isCompleted ? '<span class="topic-tag completed">‚úì Abgeschlossen</span>' : ''}
                        </div>
                    </button>
                `;
            }).join('');
        }

        // =====================================================
        // AI QUIZ GENERATOR
        // =====================================================
        let generatedQuestions = [];

        function setupGenerator() {
            // Check for saved API key
            const savedKey = localStorage.getItem('lerntrainer_api_key');
            if (savedKey) {
                showApiKeyConnected();
            }

            // API Key handlers
            document.getElementById('saveApiKeyBtn').addEventListener('click', saveApiKey);
            document.getElementById('removeApiKeyBtn').addEventListener('click', removeApiKey);
            document.getElementById('apiKeyInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') saveApiKey();
            });

            // Form handlers
            document.getElementById('genMaterial').addEventListener('input', (e) => {
                document.getElementById('charCount').textContent = e.target.value.length;
                updateGenerateButton();
            });

            document.getElementById('genTitle').addEventListener('input', updateGenerateButton);
            document.getElementById('generateBtn').addEventListener('click', generateQuiz);
            document.getElementById('saveModuleBtn').addEventListener('click', saveGeneratedModule);
        }

        function saveApiKey() {
            const key = document.getElementById('apiKeyInput').value.trim();
            if (!key.startsWith('sk-ant-')) {
                alert('Bitte gib einen g√ºltigen Anthropic API-Key ein (beginnt mit sk-ant-)');
                return;
            }
            localStorage.setItem('lerntrainer_api_key', key);
            showApiKeyConnected();
        }

        function removeApiKey() {
            localStorage.removeItem('lerntrainer_api_key');
            showApiKeyDisconnected();
        }

        function showApiKeyConnected() {
            document.getElementById('apiKeyStatus').textContent = '‚úì Verbunden';
            document.getElementById('apiKeyStatus').className = 'api-key-status connected';
            document.getElementById('apiKeyInputRow').style.display = 'none';
            document.getElementById('apiKeyConnectedRow').style.display = 'flex';
            updateGenerateButton();
        }

        function showApiKeyDisconnected() {
            document.getElementById('apiKeyStatus').textContent = 'Nicht verbunden';
            document.getElementById('apiKeyStatus').className = 'api-key-status missing';
            document.getElementById('apiKeyInputRow').style.display = 'flex';
            document.getElementById('apiKeyConnectedRow').style.display = 'none';
            document.getElementById('apiKeyInput').value = '';
            updateGenerateButton();
        }

        function updateGenerateButton() {
            const hasKey = localStorage.getItem('lerntrainer_api_key');
            const hasTitle = document.getElementById('genTitle').value.trim().length > 0;
            const hasMaterial = document.getElementById('genMaterial').value.trim().length > 50;
            document.getElementById('generateBtn').disabled = !(hasKey && hasTitle && hasMaterial);
        }

        async function generateQuiz() {
            const apiKey = localStorage.getItem('lerntrainer_api_key');
            if (!apiKey) return;

            const subject = document.getElementById('genSubject').value;
            const grade = document.getElementById('genGrade').value;
            const title = document.getElementById('genTitle').value.trim();
            const material = document.getElementById('genMaterial').value.trim();
            const count = document.getElementById('genCount').value;
            const types = document.getElementById('genTypes').value;

            const subjectNames = { englisch: 'Englisch', deutsch: 'Deutsch', mathe: 'Mathematik', franzoesisch: 'Franz√∂sisch', geschichte: 'Geschichte', biologie: 'Biologie', physik: 'Physik', chemie: 'Chemie' };
            const subjectName = subjectNames[subject];

            // Show loading
            const status = document.getElementById('generatorStatus');
            const btn = document.getElementById('generateBtn');
            status.className = 'generator-status show loading';
            document.getElementById('statusSpinner').style.display = 'block';
            document.getElementById('statusTitle').textContent = 'Generiere Fragen...';
            document.getElementById('statusText').textContent = `Claude analysiert dein Material zu "${title}" und erstellt ${count} √úbungsaufgaben.`;
            btn.disabled = true;
            btn.classList.add('loading');
            document.getElementById('generatedPreview').style.display = 'none';

            const typeInstructions = {
                mixed: 'Verwende eine gute Mischung aus fillblank (L√ºckentext), choice (Multiple Choice mit 4 Optionen), und transform (Umwandlungsaufgaben).',
                fillblank: 'Verwende NUR fillblank (L√ºckentext) Aufgaben.',
                choice: 'Verwende NUR choice (Multiple Choice mit genau 4 Optionen) Aufgaben.',
                transform: 'Verwende NUR transform (Umwandlungsaufgaben) Aufgaben.'
            };

            const prompt = `Du bist ein Experte f√ºr die Erstellung von Lernmaterial. Erstelle genau ${count} √úbungsaufgaben f√ºr das Fach ${subjectName}, Klassenstufe ${grade}, zum Thema "${title}".

MATERIAL:
${material}

AUFGABENFORMAT:
${typeInstructions[types]}

Antworte NUR mit einem JSON-Array im folgenden Format (keine Erkl√§rungen, kein Markdown, nur das Array):

[
  {
    "type": "fillblank",
    "instruction": "Anweisung auf Deutsch",
    "sentence": "Satz mit _____ als L√ºcke",
    "answer": "richtige Antwort",
    "alternativeAnswers": ["alternative1", "alternative2"],
    "tense": "Themenkategorie"
  },
  {
    "type": "choice",
    "instruction": "Frage auf Deutsch",
    "sentence": "Optionaler Kontext",
    "options": ["Option A", "Option B", "Option C", "Option D"],
    "correctIndex": 0,
    "tense": "Themenkategorie"
  },
  {
    "type": "transform",
    "instruction": "Wandle um / Forme um",
    "sentence": "Ausgangssatz",
    "answer": "Zielsatz",
    "alternativeAnswers": [],
    "tense": "Themenkategorie"
  }
]

Wichtig:
- Bei choice IMMER genau 4 Optionen und correctIndex 0-3
- Bei fillblank die L√ºcke mit _____ markieren
- Alle Texte auf ${subject === 'englisch' || subject === 'franzoesisch' ? 'der Zielsprache, Anweisungen auf Deutsch' : 'Deutsch'}
- Fragen sollen zum Niveau Klasse ${grade} passen
- tense = thematische Kategorie der Frage`;

            try {
                const response = await fetch('https://api.anthropic.com/v1/messages', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'x-api-key': apiKey,
                        'anthropic-version': '2023-06-01',
                        'anthropic-dangerous-direct-browser-access': 'true'
                    },
                    body: JSON.stringify({
                        model: 'claude-sonnet-4-20250514',
                        max_tokens: 4000,
                        messages: [{ role: 'user', content: prompt }]
                    })
                });

                if (!response.ok) {
                    const error = await response.json();
                    throw new Error(error.error?.message || 'API-Fehler');
                }

                const data = await response.json();
                const content = data.content[0].text;

                // Parse JSON from response
                let questions;
                try {
                    // Try to extract JSON array from response
                    const jsonMatch = content.match(/\[[\s\S]*\]/);
                    if (jsonMatch) {
                        questions = JSON.parse(jsonMatch[0]);
                    } else {
                        throw new Error('Keine Fragen im Antwortformat gefunden');
                    }
                } catch (parseError) {
                    throw new Error('Konnte die generierten Fragen nicht verarbeiten: ' + parseError.message);
                }

                // Validate and store questions
                generatedQuestions = questions.filter(q => {
                    if (q.type === 'choice') return q.options?.length === 4 && typeof q.correctIndex === 'number';
                    if (q.type === 'fillblank' || q.type === 'transform') return q.answer;
                    return false;
                });

                if (generatedQuestions.length === 0) {
                    throw new Error('Keine g√ºltigen Fragen generiert');
                }

                // Show success
                status.className = 'generator-status show success';
                document.getElementById('statusSpinner').style.display = 'none';
                document.getElementById('statusTitle').textContent = '‚úÖ Erfolgreich generiert!';
                document.getElementById('statusText').textContent = `${generatedQuestions.length} Fragen wurden erstellt.`;

                // Show preview
                document.getElementById('previewCount').textContent = generatedQuestions.length;
                document.getElementById('previewList').innerHTML = generatedQuestions.slice(0, 5).map((q, i) => `
                    <div class="preview-question">
                        <span class="q-type">${q.type}</span>
                        ${q.instruction} ${q.sentence ? '- ' + q.sentence.substring(0, 50) + '...' : ''}
                    </div>
                `).join('') + (generatedQuestions.length > 5 ? `<div class="preview-question">... und ${generatedQuestions.length - 5} weitere</div>` : '');
                document.getElementById('generatedPreview').style.display = 'block';

            } catch (error) {
                status.className = 'generator-status show error';
                document.getElementById('statusSpinner').style.display = 'none';
                document.getElementById('statusTitle').textContent = '‚ùå Fehler';
                document.getElementById('statusText').textContent = error.message;
            }

            btn.disabled = false;
            btn.classList.remove('loading');
        }

        function saveGeneratedModule() {
            if (generatedQuestions.length === 0) return;

            const subject = document.getElementById('genSubject').value;
            const grade = document.getElementById('genGrade').value;
            const title = document.getElementById('genTitle').value.trim();

            // Create module object
            const moduleId = 'custom-' + Date.now();
            const newModule = {
                id: moduleId,
                name: title,
                desc: `${generatedQuestions.length} KI-generierte √úbungsaufgaben`,
                icon: 'ü§ñ',
                questions: generatedQuestions.length,
                hasAudio: subject === 'englisch' || subject === 'franzoesisch',
                audioLang: subject === 'englisch' ? 'en-GB' : subject === 'franzoesisch' ? 'fr-FR' : 'de-DE',
                theory: '',
                questionData: generatedQuestions,
                isCustom: true,
                createdAt: new Date().toISOString()
            };

            // Load existing custom modules
            let customModules = JSON.parse(localStorage.getItem('lerntrainer_custom_modules') || '{}');
            const key = `${grade}-${subject}`;
            if (!customModules[key]) customModules[key] = [];
            customModules[key].push(newModule);
            localStorage.setItem('lerntrainer_custom_modules', JSON.stringify(customModules));

            // Reset form
            document.getElementById('genTitle').value = '';
            document.getElementById('genMaterial').value = '';
            document.getElementById('charCount').textContent = '0';
            document.getElementById('generatorStatus').className = 'generator-status';
            document.getElementById('generatedPreview').style.display = 'none';
            generatedQuestions = [];
            updateGenerateButton();

            // Show success and refresh topics
            alert(`‚úÖ Modul "${title}" wurde gespeichert!\n\nDu findest es jetzt unter Klasse ${grade} ‚Üí ${document.getElementById('genSubject').options[document.getElementById('genSubject').selectedIndex].text}`);
            
            // If we're on the topic selection for this grade/subject, refresh it
            if (state.selectedGrade == grade && state.selectedSubject === subject) {
                renderTopics();
            }
        }

        function getCustomModules(grade, subject) {
            const customModules = JSON.parse(localStorage.getItem('lerntrainer_custom_modules') || '{}');
            return customModules[`${grade}-${subject}`] || [];
        }

        function deleteCustomModule(grade, subject, moduleId) {
            let customModules = JSON.parse(localStorage.getItem('lerntrainer_custom_modules') || '{}');
            const key = `${grade}-${subject}`;
            if (customModules[key]) {
                customModules[key] = customModules[key].filter(m => m.id !== moduleId);
                localStorage.setItem('lerntrainer_custom_modules', JSON.stringify(customModules));
            }
        }

        // =====================================================
        // QUIZ
        // =====================================================
        function startQuiz() {
            const key = `${state.selectedGrade}-${state.selectedSubject}`;
            const builtInTopics = TOPICS[key] || TOPICS['default'];
            const customTopics = getCustomModules(state.selectedGrade, state.selectedSubject);
            const allTopics = [...builtInTopics, ...customTopics];
            const topic = allTopics.find(t => t.id === state.selectedTopic);
            
            if (!topic || !topic.questionData) return;
            
            // Set audio language
            currentAudioLang = topic.audioLang || 'de-DE';
            
            state.questions = shuffleArray([...topic.questionData]).slice(0, CONFIG.questionsPerQuiz);
            state.currentIndex = 0;
            state.correct = 0;
            state.wrong = 0;
            state.answered = false;
            
            document.getElementById('theorySection').innerHTML = topic.theory || '<p style="color: var(--text-light);">Keine Theorie verf√ºgbar f√ºr dieses Modul.</p>';
            document.getElementById('theorySection').classList.remove('show');
            document.getElementById('modeToggle').style.display = topic.hasAudio ? 'flex' : 'none';
            document.getElementById('audioControls').style.display = state.audioMode && topic.hasAudio ? 'flex' : 'none';
            
            updateQuizStats();
            showQuestion();
        }

        function showQuestion() {
            const q = state.questions[state.currentIndex];
            state.answered = false;
            
            document.getElementById('recognizedText').classList.remove('show');
            document.getElementById('voiceVisualizer').classList.remove('active');
            
            document.getElementById('questionNumber').textContent = `Frage ${state.currentIndex + 1}/${state.questions.length}`;
            document.getElementById('questionType').textContent = {
                'fillblank': 'L√ºckentext', 'transform': 'Umwandeln', 'choice': 'Multiple Choice'
            }[q.type] || q.type;
            document.getElementById('questionTense').textContent = q.tense || '';
            
            let html = `<p>${q.instruction}</p>`;
            if (q.sentence) html += `<div class="sentence-box">${q.sentence}</div>`;
            document.getElementById('questionText').innerHTML = html;
            
            const area = document.getElementById('answerArea');
            if (q.type === 'choice') {
                area.innerHTML = `<div class="options-grid">${q.options.map((opt, i) => `
                    <button class="option-btn" data-index="${i}">
                        <span class="option-letter">${String.fromCharCode(65 + i)}</span>
                        ${opt}
                    </button>
                `).join('')}</div>`;
            } else {
                area.innerHTML = `<input type="text" class="answer-input" id="answerInput" placeholder="${state.audioMode ? 'Deine Antwort erscheint hier...' : 'Deine Antwort eingeben...'}" autocomplete="off" spellcheck="false">`;
                if (!state.audioMode) setTimeout(() => document.getElementById('answerInput')?.focus(), 100);
            }
            
            if (state.audioMode) {
                setTimeout(() => speak(q.instruction.replace(/<[^>]*>/g, '') + ' ' + (q.sentence || '')), 300);
            }
            
            document.getElementById('checkBtn').style.display = 'inline-flex';
            document.getElementById('nextBtn').style.display = 'none';
            document.getElementById('feedback').classList.remove('show', 'correct', 'incorrect');
        }

        function checkAnswer() {
            const q = state.questions[state.currentIndex];
            let isCorrect = false;
            
            if (q.type === 'choice') {
                const selected = document.querySelector('.option-btn.selected');
                if (!selected) { alert('Bitte w√§hle eine Antwort!'); return; }
                isCorrect = parseInt(selected.dataset.index) === q.correctIndex;
                document.querySelectorAll('.option-btn').forEach((btn, i) => {
                    btn.classList.add('disabled');
                    if (i === q.correctIndex) btn.classList.add('correct');
                    else if (btn.classList.contains('selected') && !isCorrect) btn.classList.add('incorrect');
                });
            } else {
                const input = document.getElementById('answerInput');
                const userAnswer = input.value.trim();
                if (!userAnswer) { alert('Bitte gib eine Antwort ein!'); return; }
                
                const normalize = s => s.toLowerCase().replace(/[.,!?'"¬¥`]/g, '').replace(/\s+/g, ' ').trim();
                isCorrect = normalize(userAnswer) === normalize(q.answer);
                if (!isCorrect && q.alternativeAnswers) {
                    isCorrect = q.alternativeAnswers.some(a => normalize(a) === normalize(userAnswer));
                }
                
                // Flexible number matching
                if (!isCorrect && /^\d+$/.test(userAnswer) && /^\d+$/.test(q.answer)) {
                    isCorrect = parseInt(userAnswer) === parseInt(q.answer);
                }
                
                input.classList.add(isCorrect ? 'correct' : 'incorrect');
                input.disabled = true;
            }
            
            if (isCorrect) state.correct++; else state.wrong++;
            updateQuizStats();
            
            const fb = document.getElementById('feedback');
            fb.className = 'feedback show ' + (isCorrect ? 'correct' : 'incorrect');
            document.getElementById('feedbackTitle').innerHTML = isCorrect ? '‚úÖ Richtig!' : '‚ùå Nicht ganz richtig';
            document.getElementById('feedbackText').innerHTML = isCorrect ? '' : `Die richtige Antwort: <span class="correct-answer">${q.answer}</span>`;
            
            if (state.audioMode) speak(isCorrect ? 'Correct!' : 'The correct answer is: ' + q.answer);
            
            state.answered = true;
            document.getElementById('checkBtn').style.display = 'none';
            document.getElementById('nextBtn').style.display = 'inline-flex';
            document.getElementById('nextBtn').textContent = state.currentIndex < state.questions.length - 1 ? 'N√§chste Frage ‚Üí' : 'Ergebnis ‚Üí';
        }

        function nextQuestion() {
            state.currentIndex++;
            if (state.currentIndex < state.questions.length) showQuestion();
            else showResults();
        }

        function showResults() {
            document.getElementById('questionArea').style.display = 'none';
            document.getElementById('resultScreen').classList.add('show');
            
            const percent = Math.round((state.correct / state.questions.length) * 100);
            let emoji = 'üí™', title = 'Weiter √ºben!';
            if (percent >= 90) { emoji = 'üèÜ'; title = 'Hervorragend!'; }
            else if (percent >= 70) { emoji = 'üéâ'; title = 'Sehr gut!'; }
            else if (percent >= 50) { emoji = 'üëç'; title = 'Gut gemacht!'; }
            
            document.getElementById('resultEmoji').textContent = emoji;
            document.getElementById('resultTitle').textContent = title;
            document.getElementById('resultScore').textContent = percent + '%';
            document.getElementById('resultText').textContent = `Du hast ${state.correct} von ${state.questions.length} Fragen richtig.`;
            
            if (percent >= 70) {
                const moduleId = `${state.selectedGrade}-${state.selectedSubject}-${state.selectedTopic}`;
                if (!state.completedModules.includes(moduleId)) {
                    state.completedModules.push(moduleId);
                    saveProgress();
                }
            }
        }

        function updateQuizStats() {
            document.getElementById('statTotal').textContent = state.questions.length;
            document.getElementById('statCorrect').textContent = state.correct;
            document.getElementById('statWrong').textContent = state.wrong;
            const total = state.correct + state.wrong;
            document.getElementById('statPercent').textContent = (total > 0 ? Math.round((state.correct / total) * 100) : 0) + '%';
        }

        function shuffleArray(arr) {
            const a = [...arr];
            for (let i = a.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [a[i], a[j]] = [a[j], a[i]];
            }
            return a;
        }

        // =====================================================
        // EVENT LISTENERS
        // =====================================================
        document.addEventListener('DOMContentLoaded', () => {
            loadProgress();
            renderGrades();
            renderSubjects();
            setupGenerator();
            
            if (sessionStorage.getItem('lerntrainer_logged_in')) showApp();
            
            document.getElementById('loginBtn').addEventListener('click', handleLogin);
            document.getElementById('passwordInput').addEventListener('keypress', e => { if (e.key === 'Enter') handleLogin(); });
            
            function handleLogin() {
                const pw = document.getElementById('passwordInput').value;
                if (pw === CONFIG.password) {
                    sessionStorage.setItem('lerntrainer_logged_in', 'true');
                    showApp();
                } else {
                    document.getElementById('passwordInput').classList.add('error');
                    document.getElementById('loginError').classList.add('show');
                    setTimeout(() => document.getElementById('passwordInput').classList.remove('error'), 500);
                }
            }
            
            document.getElementById('logoutBtn').addEventListener('click', () => {
                sessionStorage.removeItem('lerntrainer_logged_in');
                showLogin();
            });
            
            document.getElementById('gradeGrid').addEventListener('click', e => {
                const btn = e.target.closest('.selection-btn');
                if (!btn) return;
                document.querySelectorAll('#gradeGrid .selection-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                state.selectedGrade = parseInt(btn.dataset.grade);
                setTimeout(showSubjectSelection, 200);
            });
            
            document.getElementById('subjectGrid').addEventListener('click', e => {
                const btn = e.target.closest('.selection-btn');
                if (!btn) return;
                document.querySelectorAll('#subjectGrid .selection-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                state.selectedSubject = btn.dataset.subject;
                setTimeout(showTopicSelection, 200);
            });
            
            document.getElementById('topicGrid').addEventListener('click', e => {
                const card = e.target.closest('.topic-card');
                if (!card || card.classList.contains('coming-soon')) return;
                state.selectedTopic = card.dataset.topic;
                showQuiz();
            });
            
            document.getElementById('checkBtn').addEventListener('click', checkAnswer);
            document.getElementById('nextBtn').addEventListener('click', nextQuestion);
            document.getElementById('restartBtn').addEventListener('click', () => {
                document.getElementById('questionArea').style.display = 'block';
                document.getElementById('resultScreen').classList.remove('show');
                startQuiz();
            });
            document.getElementById('backToTopics').addEventListener('click', () => {
                if (synth) synth.cancel();
                showTopicSelection();
                document.getElementById('progressSection').style.display = 'block';
                updateProgressBar();
            });
            document.getElementById('backToTopicsResult').addEventListener('click', () => {
                showTopicSelection();
                document.getElementById('progressSection').style.display = 'block';
                updateProgressBar();
            });
            
            document.getElementById('theoryToggle').addEventListener('click', () => {
                document.getElementById('theorySection').classList.toggle('show');
            });
            
            document.getElementById('audioToggle').addEventListener('click', () => {
                state.audioMode = !state.audioMode;
                document.getElementById('audioToggle').classList.toggle('active', state.audioMode);
                document.getElementById('audioControls').style.display = state.audioMode ? 'flex' : 'none';
            });
            
            document.getElementById('speakBtn').addEventListener('click', () => {
                const q = state.questions[state.currentIndex];
                speak(q.instruction.replace(/<[^>]*>/g, '') + ' ' + (q.sentence || ''));
            });
            document.getElementById('listenBtn').addEventListener('click', () => {
                if (isListening) stopListening(); else startListening();
            });
            
            document.getElementById('answerArea').addEventListener('click', e => {
                const btn = e.target.closest('.option-btn');
                if (!btn || state.answered) return;
                document.querySelectorAll('.option-btn').forEach(b => b.classList.remove('selected'));
                btn.classList.add('selected');
            });
            
            document.addEventListener('keydown', e => {
                if (e.key === 'Enter' && document.getElementById('quizContainer').classList.contains('show')) {
                    if (!state.answered) checkAnswer();
                    else nextQuestion();
                }
            });
        });
    </script>
</body>
</html>
